
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://vault.axonshield.com/implementation/ca-architecture/">
      
      
        <link rel="prev" href="../../foundations/what-is-pki/">
      
      
        <link rel="next" href="../../operations/certificate-lifecycle-management/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>CA Architecture - Shield Vault</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ca-architecture" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Shield Vault" class="md-header__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Shield Vault
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CA Architecture
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  PKI Knowledge Base - Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../book/" class="md-tabs__link">
        
  
  
    
  
  Book

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../foundations/certificate-anatomy/" class="md-tabs__link">
          
  
  
  Foundations

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  Implementation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../operations/certificate-lifecycle-management/" class="md-tabs__link">
          
  
  
  Operations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../security/private-key-protection/" class="md-tabs__link">
          
  
  
  Security

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../standards/x509-standard/" class="md-tabs__link">
          
  
  
  Standards

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Shield Vault" class="md-nav__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    Shield Vault
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PKI Knowledge Base - Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../book/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Book
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Foundations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Foundations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/certificate-anatomy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Anatomy
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/what-is-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is PKI?
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Implementation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    CA Architecture
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    CA Architecture
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Key Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ca-hierarchy-models" class="md-nav__link">
    <span class="md-ellipsis">
      CA Hierarchy Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CA Hierarchy Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-tier-flat-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Single-Tier (Flat) Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#two-tier-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Two-Tier Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#three-tier-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Three-Tier Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root-ca-design" class="md-nav__link">
    <span class="md-ellipsis">
      Root CA Design
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Root CA Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#root-ca-security-controls" class="md-nav__link">
    <span class="md-ellipsis">
      Root CA Security Controls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root-ca-operational-model" class="md-nav__link">
    <span class="md-ellipsis">
      Root CA Operational Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intermediate-ca-design" class="md-nav__link">
    <span class="md-ellipsis">
      Intermediate CA Design
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Intermediate CA Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#issuing-ca-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Issuing CA Characteristics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#policy-ca-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Policy CA Characteristics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-chain-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Chain Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Certificate Chain Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chain-building" class="md-nav__link">
    <span class="md-ellipsis">
      Chain Building
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-certification" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Certification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practical Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#designing-your-ca-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Designing Your CA Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Designing Your CA Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-requirements-gathering" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Requirements Gathering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-architecture-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Architecture Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-security-control-design" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Security Control Design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-naming-and-trust-anchor-distribution" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Naming and Trust Anchor Distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-policy-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Policy Documentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation Steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decision-framework" class="md-nav__link">
    <span class="md-ellipsis">
      Decision Framework
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-pitfalls" class="md-nav__link">
    <span class="md-ellipsis">
      Common Pitfalls
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Security Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defense-in-depth" class="md-nav__link">
    <span class="md-ellipsis">
      Defense in Depth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#separation-of-duties" class="md-nav__link">
    <span class="md-ellipsis">
      Separation of Duties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supply-chain-security" class="md-nav__link">
    <span class="md-ellipsis">
      Supply Chain Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Real-World Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-study-diginotar-ca-compromise-2011" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: DigiNotar CA Compromise (2011)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-us-federal-pki" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: U.S. Federal PKI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-lets-encrypt-intermediate-rotation" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: Let's Encrypt Intermediate Rotation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      Further Reading
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Further Reading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#essential-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Essential Resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Topics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-history" class="md-nav__link">
    <span class="md-ellipsis">
      Change History
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/certificate-lifecycle-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Lifecycle Management
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/private-key-protection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Private Key Protection
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Standards
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Standards
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/x509-standard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    X.509 Standard
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Key Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ca-hierarchy-models" class="md-nav__link">
    <span class="md-ellipsis">
      CA Hierarchy Models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CA Hierarchy Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-tier-flat-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Single-Tier (Flat) Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#two-tier-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Two-Tier Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#three-tier-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Three-Tier Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root-ca-design" class="md-nav__link">
    <span class="md-ellipsis">
      Root CA Design
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Root CA Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#root-ca-security-controls" class="md-nav__link">
    <span class="md-ellipsis">
      Root CA Security Controls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root-ca-operational-model" class="md-nav__link">
    <span class="md-ellipsis">
      Root CA Operational Model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intermediate-ca-design" class="md-nav__link">
    <span class="md-ellipsis">
      Intermediate CA Design
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Intermediate CA Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#issuing-ca-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Issuing CA Characteristics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#policy-ca-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Policy CA Characteristics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-chain-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Chain Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Certificate Chain Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chain-building" class="md-nav__link">
    <span class="md-ellipsis">
      Chain Building
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-certification" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Certification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practical Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#designing-your-ca-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Designing Your CA Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Designing Your CA Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-requirements-gathering" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Requirements Gathering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-architecture-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Architecture Selection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-security-control-design" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Security Control Design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-naming-and-trust-anchor-distribution" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Naming and Trust Anchor Distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-policy-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Policy Documentation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation Steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decision-framework" class="md-nav__link">
    <span class="md-ellipsis">
      Decision Framework
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-pitfalls" class="md-nav__link">
    <span class="md-ellipsis">
      Common Pitfalls
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Security Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defense-in-depth" class="md-nav__link">
    <span class="md-ellipsis">
      Defense in Depth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#separation-of-duties" class="md-nav__link">
    <span class="md-ellipsis">
      Separation of Duties
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supply-chain-security" class="md-nav__link">
    <span class="md-ellipsis">
      Supply Chain Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Real-World Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-study-diginotar-ca-compromise-2011" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: DigiNotar CA Compromise (2011)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-us-federal-pki" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: U.S. Federal PKI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-lets-encrypt-intermediate-rotation" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: Let's Encrypt Intermediate Rotation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      Further Reading
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Further Reading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#essential-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Essential Resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Topics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-history" class="md-nav__link">
    <span class="md-ellipsis">
      Change History
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  <!-- Right sidebar with disclaimer above TOC -->
  
    <style>
      @media screen and (min-width: 76.25em) {
        .md-sidebar--secondary {
          order: 1;
        }
        .md-sidebar--secondary::before {
          content: '';
          display: block;
          margin-bottom: 1rem;
        }
      }
    </style>
  
  
  
                  



<h1 id="ca-architecture">CA Architecture</h1>
<blockquote>
<p><strong>TL;DR</strong>: Certificate Authority architecture defines the structure, security boundaries, and operational model for certificate issuance. Proper CA design using offline root CAs, layered intermediate CAs, and appropriate security controls is fundamental to PKI security and operational resilience.</p>
</blockquote>
<h2 id="overview">Overview</h2>
<p>Certificate Authority (CA) architecture is the foundation of PKI security. Poor CA design creates single points of failure, operational bottlenecks, and catastrophic security risks. Conversely, well-designed CA architectures provide operational flexibility, security depth, and business continuity.</p>
<p>The core tension in CA design is between security and operational velocity. Root CAs must be maximally secured (often offline), while issuing CAs must be accessible for day-to-day operations. This leads to hierarchical architectures where highly-secured root CAs delegate authority to intermediate CAs that handle operational certificate issuance.</p>
<p>Understanding CA architecture is essential for: designing private PKI, evaluating commercial PKI solutions, assessing security posture, implementing security controls, and planning for scale and business continuity.</p>
<p><strong>Related Pages</strong>: [[what-is-pki]], [[hsm-integration]], [[certificate-issuance-workflows]], [[security/ca-compromise-scenarios]]</p>
<h2 id="key-concepts">Key Concepts</h2>
<h3 id="ca-hierarchy-models">CA Hierarchy Models</h3>
<h4 id="single-tier-flat-architecture">Single-Tier (Flat) Architecture</h4>
<p>A single CA issues all certificates directly. This is the simplest architecture but has significant drawbacks.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Root CA (Online)
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>├── Server Certificate 1
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>├── Server Certificate 2
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>├── Client Certificate 1
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>└── Device Certificate 1
</code></pre></div>
<p><strong>Use Cases</strong>:
- Small organizations (&lt;100 certificates)
- Development/testing environments
- Proof-of-concept implementations</p>
<p><strong>Limitations</strong>:
- Root CA private key online and exposed to operational risk
- CA compromise requires complete PKI rebuild
- No operational flexibility or delegation
- Single point of failure
- Difficult to implement different issuance policies</p>
<p><strong>NIST Guidance</strong>: Single-tier architectures are explicitly discouraged for production use[^1] due to unacceptable risk if the CA is compromised.</p>
<h4 id="two-tier-architecture">Two-Tier Architecture</h4>
<p>Offline root CA with one or more online intermediate (issuing) CAs. This is the minimum viable architecture for production PKI.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Root CA (Offline)
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>└── Issuing CA (Online)
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    ├── Server Certificate 1
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    ├── Server Certificate 2
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    └── Client Certificate 1
</code></pre></div>
<p><strong>Characteristics</strong>:
- Root CA: Air-gapped, powered on only for intermediate CA issuance and CRL signing
- Issuing CA: Online, handles day-to-day certificate issuance
- Root CA compromise is less likely due to offline status
- Intermediate CA compromise is recoverable: revoke and issue new intermediate</p>
<p><strong>Use Cases</strong>:
- Medium organizations (100-10,000 certificates)
- Single-purpose PKI (e.g., TLS only)
- Organizations with basic security requirements</p>
<p><strong>Operational Model</strong>:
- Root CA ceremony for initial setup and intermediate issuance
- Issuing CA online 24/7 for certificate operations
- Periodic root CA activation for CRL signing and intermediate renewal</p>
<h4 id="three-tier-architecture">Three-Tier Architecture</h4>
<p>Offline root CA, offline or restricted-access policy CAs, and online issuing CAs. This provides maximum security and operational flexibility.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Root CA (Offline)
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>├── Policy CA: TLS (Restricted Access)
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>│   ├── Issuing CA: External TLS (Online)
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>│   └── Issuing CA: Internal TLS (Online)
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>└── Policy CA: Code Signing (Offline)
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    └── Issuing CA: Windows Code Signing (Restricted Access)
</code></pre></div>
<p><strong>Characteristics</strong>:
- Root CA: Maximum security, powered on only for major events
- Policy CAs: Intermediate layer representing different certificate policies/purposes
- Issuing CAs: Day-to-day operational certificate issuance
- Enables different security models for different certificate types
- Provides operational and policy segregation</p>
<p><strong>Use Cases</strong>:
- Large enterprises (&gt;10,000 certificates)
- Organizations with diverse certificate requirements (TLS, code signing, email, authentication)
- Regulated industries requiring strong security controls
- Organizations requiring segregation of duties</p>
<p><strong>Example Policy Segregation</strong>:
- <strong>Public-facing TLS Policy CA</strong>: For internet-exposed services
- <strong>Internal TLS Policy CA</strong>: For internal infrastructure
- <strong>Code Signing Policy CA</strong>: For software release signing (highest security)
- <strong>Email Policy CA</strong>: For S/MIME email certificates
- <strong>Authentication Policy CA</strong>: For user authentication certificates</p>
<h3 id="root-ca-design">Root CA Design</h3>
<p>The root CA is the ultimate trust anchor. Its compromise invalidates the entire PKI and requires rebuilding all trust relationships.</p>
<h4 id="root-ca-security-controls">Root CA Security Controls</h4>
<p><strong>Physical Security</strong>:
- Dedicated secure facility with access controls
- Separate secure storage for CA private key (HSM or encrypted storage)
- Video surveillance and access logging
- Minimal number of personnel with physical access</p>
<p><strong>Logical Security</strong>:
- Dedicated, hardened hardware (never virtualized for high-security environments)
- Minimal OS installation with no unnecessary services
- No network connectivity (air-gapped)
- Full disk encryption
- Strong authentication for administrative access (smartcards, multi-factor)</p>
<p><strong>Operational Security</strong>:
- Multi-person integrity (requires 2+ people for operations)
- Comprehensive audit logging stored externally
- Formal ceremony procedures for all operations
- Regular security assessments
- Backup and recovery procedures tested annually</p>
<p><strong>Key Protection</strong>:
- FIPS 140-2 Level 3 or higher HSM for high-security environments[^2]
- Encrypted backup keys in separate secure location
- Key ceremony with witnesses and documentation
- Dual control and split knowledge for key access</p>
<h4 id="root-ca-operational-model">Root CA Operational Model</h4>
<p>Root CAs should be powered on only for:</p>
<ol>
<li><strong>Initial Setup</strong>: Generating root key, self-signed root certificate</li>
<li><strong>Issuing Intermediate Certificates</strong>: Creating subordinate CA certificates (typically annually or less frequently)</li>
<li><strong>CRL Signing</strong>: Publishing root CRL (can be delegated to online system in some architectures)</li>
<li><strong>Emergency Response</strong>: Revoking compromised intermediate CAs</li>
<li><strong>Decommissioning</strong>: Controlled shutdown and key destruction at end-of-life</li>
</ol>
<p><strong>Activation Frequency</strong>: 
- High security environments: 1-2 times per year
- Medium security: Quarterly
- Lower security: Monthly</p>
<p><strong>Procedure</strong>: Formal "CA ceremony" with multiple authorized personnel, documented procedures, witnessed operations, and signed attestations.</p>
<h3 id="intermediate-ca-design">Intermediate CA Design</h3>
<p>Intermediate CAs balance security and operational requirements. They're online enough for operations but protected against compromise through layered security.</p>
<h4 id="issuing-ca-characteristics">Issuing CA Characteristics</h4>
<p><strong>Purpose</strong>: Handle day-to-day certificate issuance, revocation, and CRL/OCSP operations.</p>
<p><strong>Security Posture</strong>:
- HSM-based private key storage
- Hardened systems with minimal attack surface
- Network segmentation (dedicated PKI VLAN)
- Strong authentication and authorization
- Comprehensive audit logging</p>
<p><strong>High Availability</strong>:
- Redundant issuing CAs for business continuity
- Geographic distribution for disaster recovery
- Automated failover mechanisms
- Load balancing for performance</p>
<p><strong>Operational Accessibility</strong>:
- API endpoints for certificate issuance automation
- Integration with identity systems for validation
- ACME protocol support for automated renewals
- Web enrollment portals (where appropriate)</p>
<h4 id="policy-ca-characteristics">Policy CA Characteristics</h4>
<p>Policy CAs sit between root and issuing CAs, representing different certificate policies or security domains.</p>
<p><strong>Purpose</strong>: Segregate certificate purposes while maintaining single root of trust.</p>
<p><strong>Security Posture</strong>:
- More secure than issuing CAs, less accessible than root
- May be offline or have restricted network access
- HSM key storage required
- Formal procedures for certificate issuance (to issuing CAs)</p>
<p><strong>Operational Model</strong>:
- Activated for issuing CA creation, renewal, and revocation
- May be activated quarterly or annually depending on issuing CA validity periods
- Less formal ceremony than root CA but documented procedures</p>
<h3 id="certificate-chain-structure">Certificate Chain Structure</h3>
<p>Understanding how certificates chain to roots is critical for validation and troubleshooting.</p>
<h4 id="chain-building">Chain Building</h4>
<p>When a relying party (e.g., web browser) encounters a certificate, it must build a trust chain to a trusted root:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>[Server Certificate]
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>  ↓ Issued by
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>[Intermediate CA Certificate]
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>  ↓ Issued by
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>[Root CA Certificate] (in trust store)
</code></pre></div>
<p><strong>Chain Building Process</strong>:
1. Start with presented certificate (leaf)
2. Use Authority Information Access (AIA) extension to locate issuer certificate
3. Fetch and validate issuer certificate
4. Repeat until reaching a certificate in the trust store
5. Validate entire chain (signatures, validity dates, revocation status)</p>
<p><strong>Common Issues</strong>:
- Missing intermediate certificates (server must send full chain)
- Incorrect chain order
- Expired intermediate certificates
- Cross-signed certificates creating multiple valid paths</p>
<h4 id="cross-certification">Cross-Certification</h4>
<p>Cross-certification establishes trust between different PKI hierarchies without requiring all parties to trust the same root.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>Organization A Root CA ←→ Organization B Root CA
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>       ↓                           ↓
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>   Issuing CA A                Issuing CA B
</code></pre></div>
<p><strong>Use Cases</strong>:
- Federal Bridge CA connecting government agencies
- B2B partnerships requiring mutual certificate trust
- PKI migration (old and new root CAs trusted simultaneously)</p>
<p><strong>Complexity</strong>: Cross-certification creates operational overhead in managing multiple trust relationships and longer validation chains.</p>
<h2 id="practical-guidance">Practical Guidance</h2>
<h3 id="designing-your-ca-architecture">Designing Your CA Architecture</h3>
<h4 id="step-1-requirements-gathering">Step 1: Requirements Gathering</h4>
<p><strong>Questions to Answer</strong>:
- How many certificates will be issued? (Current and 5-year projection)
- What certificate types are needed? (TLS, code signing, email, authentication, IoT)
- What are the security requirements? (Regulatory compliance, risk tolerance)
- What operational capabilities exist? (Staff expertise, infrastructure availability)
- What's the organizational structure? (Centralized vs. federated IT)
- What are availability requirements? (RPO/RTO for certificate services)</p>
<h4 id="step-2-architecture-selection">Step 2: Architecture Selection</h4>
<table>
<thead>
<tr>
<th>Factor</th>
<th>Single-Tier</th>
<th>Two-Tier</th>
<th>Three-Tier</th>
</tr>
</thead>
<tbody>
<tr>
<td>Security Requirements</td>
<td>Low</td>
<td>Medium-High</td>
<td>Highest</td>
</tr>
<tr>
<td>Certificate Volume</td>
<td>&lt;100</td>
<td>100-10K</td>
<td>&gt;10K</td>
</tr>
<tr>
<td>Operational Complexity</td>
<td>Minimal</td>
<td>Moderate</td>
<td>High</td>
</tr>
<tr>
<td>Multiple Policies</td>
<td>Not supported</td>
<td>Limited</td>
<td>Excellent</td>
</tr>
<tr>
<td>Recovery from Compromise</td>
<td>Complete rebuild</td>
<td>Revoke intermediate</td>
<td>Granular revocation</td>
</tr>
<tr>
<td><strong>Recommendation</strong></td>
<td>PoC/Dev only</td>
<td>Most organizations</td>
<td>Large enterprises</td>
</tr>
</tbody>
</table>
<h4 id="step-3-security-control-design">Step 3: Security Control Design</h4>
<p><strong>For All CA Tiers</strong>:
- Define access control policies (who can perform what operations)
- Implement audit logging sent to centralized SIEM
- Establish backup and recovery procedures
- Define key management lifecycle (generation, storage, rotation, destruction)
- Plan for compliance auditing (SOC 2, ISO 27001, WebTrust)</p>
<p><strong>Root CA Specific</strong>:
- Physical security requirements and location
- Ceremony procedures and documentation
- Multi-person integrity requirements
- HSM selection and configuration
- Offline storage requirements</p>
<p><strong>Issuing CA Specific</strong>:
- High availability and disaster recovery
- Performance and scalability requirements
- Integration points (APIs, ACME, SCEP)
- Automated monitoring and alerting
- Certificate issuance policies and validation procedures</p>
<h4 id="step-4-naming-and-trust-anchor-distribution">Step 4: Naming and Trust Anchor Distribution</h4>
<p><strong>Root CA Naming</strong>: 
- Choose descriptive, long-lived name (root CAs operate for 20+ years)
- Include organization name and purpose
- Example: "Acme Corporation Root CA 2024"</p>
<p><strong>Certificate Distribution</strong>:
- How will devices/applications receive root certificate?
- Enterprise: Group Policy, MDM, configuration management
- External: Browser trust programs (requires WebTrust audit), certificate pinning
- B2B: Manual trust store import with verification procedures</p>
<h4 id="step-5-policy-documentation">Step 5: Policy Documentation</h4>
<p>Document CA policies in Certificate Policy (CP) and Certificate Practice Statement (CPS):</p>
<p><strong>Certificate Policy (CP)</strong>: High-level policy statements about certificate purpose, validation requirements, and organizational commitments.</p>
<p><strong>Certificate Practice Statement (CPS)</strong>: Detailed procedures for CA operations, security controls, and technical implementation.</p>
<p>These documents are essential for:
- Compliance audits
- External trust establishment
- Operational consistency
- Legal and liability frameworks</p>
<h3 id="implementation-steps">Implementation Steps</h3>
<ol>
<li><strong>Establish Secure Environment</strong></li>
<li>Procure hardware (HSMs, secure servers)</li>
<li>Set up physical security controls</li>
<li>Configure network segmentation</li>
<li>
<p>Implement access controls</p>
</li>
<li>
<p><strong>Root CA Initialization</strong></p>
</li>
<li>Generate root key in HSM</li>
<li>Create self-signed root certificate</li>
<li>Document key ceremony</li>
<li>Securely backup root key material</li>
<li>
<p>Test backup recovery procedures</p>
</li>
<li>
<p><strong>Intermediate CA Deployment</strong></p>
</li>
<li>Generate intermediate CA keys</li>
<li>Create CSRs for intermediate certificates</li>
<li>Issue intermediate certificates from root CA</li>
<li>Install intermediate certificates</li>
<li>
<p>Publish intermediate CA certificates to AIA locations</p>
</li>
<li>
<p><strong>Integration and Testing</strong></p>
</li>
<li>Configure certificate issuance workflows</li>
<li>Implement monitoring and alerting</li>
<li>Issue test certificates</li>
<li>Validate chain building from all clients</li>
<li>Test revocation (CRL/OCSP)</li>
<li>
<p>Conduct failure scenario testing</p>
</li>
<li>
<p><strong>Production Cutover</strong></p>
</li>
<li>Distribute root CA certificate to trust stores</li>
<li>Enable certificate issuance</li>
<li>Monitor operational metrics</li>
<li>Validate production certificate functionality</li>
</ol>
<h3 id="decision-framework">Decision Framework</h3>
<table>
<thead>
<tr>
<th>Requirement</th>
<th>Design Choice</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td>High security, regulatory compliance</td>
<td>Three-tier with offline root and policy CAs</td>
<td>Provides defense in depth and segregation</td>
</tr>
<tr>
<td>Moderate security, single purpose</td>
<td>Two-tier with offline root</td>
<td>Balances security and operational complexity</td>
</tr>
<tr>
<td>Diverse certificate types</td>
<td>Three-tier with policy CAs per type</td>
<td>Enables different security controls per purpose</td>
</tr>
<tr>
<td>High availability critical</td>
<td>Multiple issuing CAs with load balancing</td>
<td>Prevents single point of failure</td>
</tr>
<tr>
<td>Geographic distribution</td>
<td>Issuing CAs in multiple regions</td>
<td>Reduces latency, improves availability</td>
</tr>
</tbody>
</table>
<h2 id="common-pitfalls">Common Pitfalls</h2>
<ul>
<li><strong>Online root CA</strong>: Operating root CA online for convenience</li>
<li><strong>Why it happens</strong>: Perceived operational complexity of offline root; desire for automation</li>
<li><strong>How to avoid</strong>: Accept that root CA operations are infrequent; design for offline from start</li>
<li>
<p><strong>How to fix</strong>: Build new offline root, migrate to new hierarchy, revoke old root</p>
</li>
<li>
<p><strong>Insufficient root CA validity period</strong>: Setting root validity too short (e.g., 5 years)</p>
</li>
<li><strong>Why it happens</strong>: Misunderstanding root CA operational model; copying default settings</li>
<li><strong>How to avoid</strong>: Root CAs typically have 20-25 year validity; plan for long-term operation</li>
<li>
<p><strong>How to fix</strong>: Cannot be fixed; requires new root CA and trust distribution</p>
</li>
<li>
<p><strong>Single issuing CA without redundancy</strong>: No backup CA for business continuity</p>
</li>
<li><strong>Why it happens</strong>: Cost optimization; underestimating availability requirements</li>
<li><strong>How to avoid</strong>: Deploy at least two issuing CAs; test failover regularly</li>
<li>
<p><strong>How to fix</strong>: Deploy additional issuing CA; implement load balancing</p>
</li>
<li>
<p><strong>Inadequate HSM planning</strong>: Not using HSMs or using inappropriate HSM configurations</p>
</li>
<li><strong>Why it happens</strong>: Cost; lack of expertise; availability challenges</li>
<li><strong>How to avoid</strong>: Budget for HSMs from start; cloud HSMs available for lower cost entry</li>
<li>
<p><strong>How to fix</strong>: Migrate keys to HSM; may require re-issuing intermediate certificates</p>
</li>
<li>
<p><strong>Missing AIA and CDP extensions</strong>: Certificates don't include URLs for chain building</p>
</li>
<li><strong>Why it happens</strong>: Incomplete CA configuration; copied settings from examples</li>
<li><strong>How to avoid</strong>: Validate all certificate extensions during CA setup; test chain building</li>
<li><strong>How to fix</strong>: Reconfigure CA; reissue certificates with correct extensions</li>
</ul>
<h2 id="security-considerations">Security Considerations</h2>
<h3 id="defense-in-depth">Defense in Depth</h3>
<p>Layered CA architecture provides security through multiple defensive layers:</p>
<ul>
<li><strong>Root CA compromise</strong>: Attacker must compromise air-gapped system with multi-person controls</li>
<li><strong>Policy CA compromise</strong>: Attacker must compromise restricted-access system</li>
<li><strong>Issuing CA compromise</strong>: Detected through monitoring; revoke and replace intermediate</li>
</ul>
<p>Each layer increases attacker cost and provides detection opportunities.</p>
<h3 id="separation-of-duties">Separation of Duties</h3>
<p>CA operations should require multiple people to prevent insider threats:</p>
<ul>
<li>Root CA ceremonies: Require 2-3 authorized personnel</li>
<li>CA administrator accounts: Separate persons, separate credentials</li>
<li>Audit review: Independent from CA operators</li>
<li>Key backup recovery: Requires multiple key shares</li>
</ul>
<h3 id="supply-chain-security">Supply Chain Security</h3>
<p>CA systems are high-value targets. Secure the supply chain:</p>
<ul>
<li>Purchase HSMs directly from manufacturers</li>
<li>Verify hardware hasn't been tampered with (tamper-evident seals)</li>
<li>Validate firmware signatures before installation</li>
<li>Use trusted OS distributions with verified installation media</li>
<li>Vet all personnel with CA access</li>
</ul>
<h2 id="real-world-examples">Real-World Examples</h2>
<h3 id="case-study-diginotar-ca-compromise-2011">Case Study: DigiNotar CA Compromise (2011)</h3>
<p>DigiNotar operated a single-tier architecture with root CA online and insufficiently secured. Attackers compromised the CA and issued rogue certificates for Google, Mozilla, and intelligence agencies. The compromise was used to spy on Iranian citizens.</p>
<p><strong>Key Takeaway</strong>: Online root CAs are unacceptable for production use. Offline root with intermediate architecture would have limited blast radius to the compromised intermediate, allowing revocation and recovery.</p>
<h3 id="case-study-us-federal-pki">Case Study: U.S. Federal PKI</h3>
<p>The U.S. Federal PKI uses a complex multi-tier architecture with the Federal Bridge CA enabling cross-certification between agencies. This demonstrates three-tier architecture at massive scale (millions of certificates) across diverse security requirements.</p>
<p><strong>Key Takeaway</strong>: Three-tier architectures scale to enterprise and government requirements while maintaining security and operational flexibility.</p>
<h3 id="case-study-lets-encrypt-intermediate-rotation">Case Study: Let's Encrypt Intermediate Rotation</h3>
<p>Let's Encrypt regularly rotates intermediate CAs (typically annually) while keeping root CAs long-lived. This demonstrates operational practice of renewing intermediates to limit exposure window and ensure business continuity procedures work.</p>
<p><strong>Key Takeaway</strong>: Regular intermediate CA rotation is a security best practice that validates recovery procedures and limits compromise exposure.</p>
<h2 id="further-reading">Further Reading</h2>
<h3 id="essential-resources">Essential Resources</h3>
<ul>
<li><a href="https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final">NIST SP 800-57 Part 1 - Key Management Recommendations</a> - Government guidance on PKI key management</li>
<li><a href="https://www.rfc-editor.org/rfc/rfc4210">RFC 4210 - Certificate Management Protocol</a> - Standard for CA interactions</li>
<li><a href="https://cabforum.org/baseline-requirements-documents/">CA/Browser Forum Baseline Requirements</a> - Requirements for publicly-trusted CAs</li>
</ul>
<h3 id="advanced-topics">Advanced Topics</h3>
<ul>
<li>[[hsm-integration]] - Hardware security module implementation</li>
<li>[[security/ca-compromise-scenarios]] - Understanding and preventing CA failures</li>
<li>[[certificate-issuance-workflows]] - Operational certificate issuance</li>
<li>[[trust-models]] - Different approaches to establishing trust</li>
</ul>
<h2 id="references">References</h2>
<p>[^1]: NIST. "Recommendation for Key Management." NIST SP 800-57 Part 1 Rev. 5, May 2020. Section 6.2 on CA Key Management. https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final</p>
<p>[^2]: NIST. "Security Requirements for Cryptographic Modules." FIPS 140-2, May 2001. Defines HSM security levels. https://csrc.nist.gov/publications/detail/fips/140/2/final</p>
<h2 id="change-history">Change History</h2>
<table>
<thead>
<tr>
<th>Date</th>
<th>Version</th>
<th>Changes</th>
<th>Reason</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-11-09</td>
<td>1.0</td>
<td>Initial creation</td>
<td>Foundational CA architecture guidance</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Quality Checks</strong>: 
- [x] All claims cited from authoritative sources
- [x] Cross-references validated
- [x] Practical guidance included
- [x] Examples are current and relevant
- [x] Security considerations addressed</p>







  
  



  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/axonsecurity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var sidebar = document.querySelector('.md-sidebar--secondary .md-sidebar__scrollwrap');
      if (sidebar) {
        var disclaimer = document.createElement('div');
        disclaimer.className = 'md-sidebar-disclaimer';
        disclaimer.innerHTML = `
          <div class="md-typeset">
            <div class="admonition info">
              <p class="admonition-title">📚 Resources</p>
              <p><a href="https://axonshield.com/book"><strong>View our comprehensive guide</strong></a></p>
            </div>
            <div class="admonition warning">
              <p class="admonition-title">⚠️ Disclaimer</p>
              <p><small>This documentation reflects industry standards that we have found often ignore company-specific needs and in many cases don't work for long-term sustainable operations that build infrastructure intelligence.</small></p>
            </div>
          </div>
        `;
        sidebar.insertBefore(disclaimer, sidebar.firstChild);
      }
    });
  </script>
  

  </body>
</html>