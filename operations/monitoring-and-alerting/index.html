
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://vault.axonshield.com/operations/monitoring-and-alerting/">
      
      
        <link rel="prev" href="../inventory-and-discovery/">
      
      
        <link rel="next" href="../renewal-automation/">
      
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Monitoring and Alerting - Shield Vault</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
    
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WJXPDRF2');</script>
  <!-- End Google Tag Manager -->
  
  <!-- Apollo Tracking -->
  <script>
    (function() {
      var apolloScript = document.createElement('script');
      apolloScript.type = 'text/javascript';
      apolloScript.async = true;
      apolloScript.src = 'https://cdn.apollo.io/v1/apollo.js';
      apolloScript.setAttribute('data-apollo-id', '68b8b91c5e883f0021f7f7aa');
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(apolloScript, s);
    })();
  </script>
  <!-- End Apollo Tracking -->

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#monitoring-and-alerting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Shield Vault" class="md-header__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Shield Vault
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Monitoring and Alerting
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Foundations for Infrastructure Intelligence - Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../book/" class="md-tabs__link">
        
  
  
    
  
  Book

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../architecture/case-studies/" class="md-tabs__link">
          
  
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../foundations/certificate-anatomy/" class="md-tabs__link">
          
  
  
  Foundations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../implementation/acme-protocol-implementation/" class="md-tabs__link">
          
  
  
  Implementation

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../certificate-lifecycle-management/" class="md-tabs__link">
          
  
  
  Operations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../patterns/ca-hierarchies/" class="md-tabs__link">
          
  
  
  Patterns

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../security/ca-compromise-scenarios/" class="md-tabs__link">
          
  
  
  Security

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../standards/acme-protocol/" class="md-tabs__link">
          
  
  
  Standards

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../troubleshooting/chain-validation-errors/" class="md-tabs__link">
          
  
  
  Troubleshooting

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../vendors/digicert-certcentral/" class="md-tabs__link">
          
  
  
  Vendors

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Shield Vault" class="md-nav__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    Shield Vault
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Foundations for Infrastructure Intelligence - Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../book/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Book
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/case-studies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Case Studies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/certificate-as-code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate-as-Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/mutual-tls-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mutual TLS Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/service-mesh-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service Mesh Certificates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/zero-trust-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zero-Trust Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Foundations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Foundations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/certificate-anatomy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Anatomy
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/cryptographic-primitives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cryptographic Primitives
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/public-private-key-pairs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Public-Private Key Pairs
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/trust-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trust Models
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/what-is-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is PKI?
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Implementation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/acme-protocol-implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/ca-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Architecture
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/certificate-issuance-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Issuance Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/hsm-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HSM Integration
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/multi-cloud-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Cloud PKI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate-lifecycle-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Lifecycle Management
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate-rotation-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Rotation Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inventory-and-discovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inventory and Discovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Monitoring and Alerting
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Monitoring and Alerting
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-certificate-monitoring-differs-from-traditional-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Why Certificate Monitoring Differs from Traditional Monitoring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Certificate Monitoring Differs from Traditional Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-expiry-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Expiry Problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-complexity-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Complexity Problem
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-to-monitor" class="md-nav__link">
    <span class="md-ellipsis">
      What to Monitor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What to Monitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#certificate-lifecycle-stages" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Lifecycle Stages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infrastructure-health" class="md-nav__link">
    <span class="md-ellipsis">
      Infrastructure Health
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-signals" class="md-nav__link">
    <span class="md-ellipsis">
      Security Signals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#business-impact-signals" class="md-nav__link">
    <span class="md-ellipsis">
      Business Impact Signals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alerting-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Alerting Strategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alerting Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alert-design-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Alert Design Principles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alert-categories" class="md-nav__link">
    <span class="md-ellipsis">
      Alert Categories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alert-enrichment" class="md-nav__link">
    <span class="md-ellipsis">
      Alert Enrichment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alert-routing-and-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Alert Routing and Escalation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring Infrastructure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Monitoring Infrastructure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Data Collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synthetic-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Synthetic Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dashboards-and-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Dashboards and Visualization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-monitoring-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Monitoring Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Monitoring Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anomaly-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Anomaly Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predictive-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Predictive Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlation-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Correlation Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dos" class="md-nav__link">
    <span class="md-ellipsis">
      Do's
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#donts" class="md-nav__link">
    <span class="md-ellipsis">
      Don'ts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-with-incident-response" class="md-nav__link">
    <span class="md-ellipsis">
      Integration with Incident Response
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integration with Incident Response">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automated-remediation" class="md-nav__link">
    <span class="md-ellipsis">
      Automated remediation**:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standards-and-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Standards and Specifications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-tools-and-platforms" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring Tools and Platforms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-specific-monitoring-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate-Specific Monitoring Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloud-provider-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Cloud Provider Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alerting-and-incident-management" class="md-nav__link">
    <span class="md-ellipsis">
      Alerting and Incident Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synthetic-monitoring-and-active-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Synthetic Monitoring and Active Checks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observability-and-apm-platforms" class="md-nav__link">
    <span class="md-ellipsis">
      Observability and APM Platforms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-aggregation-and-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Log Aggregation and Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-monitoring-and-protocol-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Network Monitoring and Protocol Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-information-and-event-management-siem" class="md-nav__link">
    <span class="md-ellipsis">
      Security Information and Event Management (SIEM)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-and-integration-tools" class="md-nav__link">
    <span class="md-ellipsis">
      API and Integration Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-and-audit-frameworks" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance and Audit Frameworks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-series-databases" class="md-nav__link">
    <span class="md-ellipsis">
      Time-Series Databases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-world-incident-case-studies" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Incident Case Studies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operational-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#academic-research" class="md-nav__link">
    <span class="md-ellipsis">
      Academic Research
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machine-learning-and-anomaly-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Machine Learning and Anomaly Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#books-and-comprehensive-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Books and Comprehensive Resources
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../renewal-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Renewal Automation
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Patterns
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/ca-hierarchies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Hierarchies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/cloud-vs-on-premises/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud vs On-Premises
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/high-availability-disaster-recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    High Availability and Disaster Recovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/multi-tenancy-considerations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Tenancy Considerations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/ca-compromise-scenarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Compromise Scenarios
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/certificate-pinning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Pinning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/common-vulnerabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Vulnerabilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/compliance-and-audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compliance and Audit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/incident-response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Incident Response
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/key-management-best-practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Key Management Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/private-key-protection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Private Key Protection
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/threat-models-and-attack-vectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threat Models and Attack Vectors
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Standards
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Standards
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/acme-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/ocsp-and-crl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OCSP and CRL
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/pkcs-standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PKCS Standards
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/tls-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TLS Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/x509-standard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    X.509 Standard
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Troubleshooting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/chain-validation-errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chain Validation Errors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/common-misconfigurations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Misconfigurations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/expired-certificate-outages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Expired Certificate Outages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/performance-bottlenecks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Bottlenecks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Vendors
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Vendors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/digicert-certcentral/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DigiCert CertCentral
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/hashicorp-vault-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HashiCorp Vault PKI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/keyfactor-command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Keyfactor Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/venafi-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Venafi Platform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/vendor-comparison-matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vendor Comparison Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-certificate-monitoring-differs-from-traditional-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Why Certificate Monitoring Differs from Traditional Monitoring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Certificate Monitoring Differs from Traditional Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-expiry-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Expiry Problem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-complexity-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Complexity Problem
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-to-monitor" class="md-nav__link">
    <span class="md-ellipsis">
      What to Monitor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What to Monitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#certificate-lifecycle-stages" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Lifecycle Stages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#infrastructure-health" class="md-nav__link">
    <span class="md-ellipsis">
      Infrastructure Health
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-signals" class="md-nav__link">
    <span class="md-ellipsis">
      Security Signals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#business-impact-signals" class="md-nav__link">
    <span class="md-ellipsis">
      Business Impact Signals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alerting-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Alerting Strategy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alerting Strategy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alert-design-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Alert Design Principles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alert-categories" class="md-nav__link">
    <span class="md-ellipsis">
      Alert Categories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alert-enrichment" class="md-nav__link">
    <span class="md-ellipsis">
      Alert Enrichment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alert-routing-and-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Alert Routing and Escalation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring Infrastructure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Monitoring Infrastructure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Data Collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synthetic-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Synthetic Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dashboards-and-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Dashboards and Visualization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-monitoring-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Monitoring Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Monitoring Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anomaly-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Anomaly Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#predictive-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Predictive Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlation-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Correlation Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dos" class="md-nav__link">
    <span class="md-ellipsis">
      Do's
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#donts" class="md-nav__link">
    <span class="md-ellipsis">
      Don'ts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-with-incident-response" class="md-nav__link">
    <span class="md-ellipsis">
      Integration with Incident Response
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integration with Incident Response">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automated-remediation" class="md-nav__link">
    <span class="md-ellipsis">
      Automated remediation**:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standards-and-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Standards and Specifications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-tools-and-platforms" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring Tools and Platforms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-specific-monitoring-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate-Specific Monitoring Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloud-provider-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Cloud Provider Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alerting-and-incident-management" class="md-nav__link">
    <span class="md-ellipsis">
      Alerting and Incident Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#synthetic-monitoring-and-active-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Synthetic Monitoring and Active Checks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observability-and-apm-platforms" class="md-nav__link">
    <span class="md-ellipsis">
      Observability and APM Platforms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-aggregation-and-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Log Aggregation and Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-monitoring-and-protocol-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Network Monitoring and Protocol Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-information-and-event-management-siem" class="md-nav__link">
    <span class="md-ellipsis">
      Security Information and Event Management (SIEM)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-and-integration-tools" class="md-nav__link">
    <span class="md-ellipsis">
      API and Integration Tools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-and-audit-frameworks" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance and Audit Frameworks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-series-databases" class="md-nav__link">
    <span class="md-ellipsis">
      Time-Series Databases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-world-incident-case-studies" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Incident Case Studies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operational-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#academic-research" class="md-nav__link">
    <span class="md-ellipsis">
      Academic Research
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machine-learning-and-anomaly-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Machine Learning and Anomaly Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#books-and-comprehensive-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Books and Comprehensive Resources
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WJXPDRF2"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
  <!-- Right sidebar with disclaimer above TOC -->
  
    <style>
      @media screen and (min-width: 76.25em) {
        .md-sidebar--secondary {
          order: 1;
        }
        .md-sidebar--secondary::before {
          content: '';
          display: block;
          margin-bottom: 1rem;
        }
      }
    </style>
  
  
  
                  



<h1 id="monitoring-and-alerting">Monitoring and Alerting</h1>
<h2 id="overview">Overview</h2>
<p>PKI monitoring transforms certificate management from reactive firefighting to proactive infrastructure intelligence. While certificate inventory tells you what exists, monitoring tells you what's happening and what's about to go wrong. Effective monitoring prevents outages, accelerates incident response, and provides visibility into certificate health across the entire estate.</p>
<p><strong>The fundamental principle</strong>: Monitor not just for expiry, but for the complete certificate lifecycle and health.</p>
<h2 id="why-certificate-monitoring-differs-from-traditional-monitoring">Why Certificate Monitoring Differs from Traditional Monitoring</h2>
<h3 id="the-expiry-problem">The Expiry Problem</h3>
<p>Unlike most infrastructure components that fail suddenly, certificates fail predictably. Every certificate has a known expiry date set at issuance. Yet certificate expiry remains one of the most common causes of production outages:</p>
<ul>
<li><strong>LinkedIn (2023)</strong>: Certificate expiry caused global outage</li>
<li><strong>Microsoft Teams (2023)</strong>: Expired certificate disrupted service for hours</li>
<li><strong>Spotify (2022)</strong>: Certificate expiry caused widespread service disruption</li>
<li><strong>Equifax (2017)</strong>: Expired certificate on internal server contributed to delayed breach detection</li>
</ul>
<p>Why does this keep happening? Because monitoring expiry alone is insufficient.</p>
<h3 id="the-complexity-problem">The Complexity Problem</h3>
<p>Modern PKI monitoring must account for:</p>
<ul>
<li><strong>Distributed deployment</strong>: Certificates across cloud, on-prem, edge</li>
<li><strong>Dynamic infrastructure</strong>: Containers, auto-scaling, ephemeral workloads</li>
<li><strong>Trust chain dependencies</strong>: CA certificates, intermediate certificates, root certificates</li>
<li><strong>Protocol variations</strong>: TLS 1.2 vs 1.3, mutual TLS, client certificates</li>
<li><strong>Cryptographic agility</strong>: Algorithm deprecation, key length requirements</li>
<li><strong>Compliance requirements</strong>: Policy violations, audit requirements</li>
</ul>
<h2 id="what-to-monitor">What to Monitor</h2>
<h3 id="certificate-lifecycle-stages">Certificate Lifecycle Stages</h3>
<p><strong>Issuance monitoring</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">IssuanceMetrics</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Track certificate issuance patterns and health</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="c1"># Volume metrics</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">issuance_rate</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s1">&#39;certificates_issued_total&#39;</span><span class="p">,</span> 
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                           <span class="s1">&#39;Total certificates issued&#39;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>                           <span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;profile&#39;</span><span class="p">,</span> <span class="s1">&#39;team&#39;</span><span class="p">])</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="c1"># Latency metrics</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">issuance_duration</span> <span class="o">=</span> <span class="n">Histogram</span><span class="p">(</span><span class="s1">&#39;certificate_issuance_seconds&#39;</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>                                 <span class="s1">&#39;Time to issue certificate&#39;</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>                                 <span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;profile&#39;</span><span class="p">])</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="c1"># Success/failure</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">issuance_failures</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s1">&#39;certificate_issuance_failures_total&#39;</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>                               <span class="s1">&#39;Failed issuance attempts&#39;</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>                               <span class="p">[</span><span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;error_type&#39;</span><span class="p">])</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="c1"># Validation failures</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="n">validation_failures</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s1">&#39;certificate_validation_failures_total&#39;</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>                                 <span class="s1">&#39;Failed validation attempts&#39;</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>                                 <span class="p">[</span><span class="s1">&#39;validation_type&#39;</span><span class="p">,</span> <span class="s1">&#39;reason&#39;</span><span class="p">])</span>
</code></pre></div></p>
<p>Key issuance signals:</p>
<ul>
<li>Issuance request rate (requests per hour/day)</li>
<li>Success vs. failure rate</li>
<li>Time to issue (p50, p95, p99)</li>
<li>Validation failure reasons</li>
<li>Certificate profile usage</li>
<li>Issuing CA distribution</li>
</ul>
<p><strong>Deployment monitoring</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">DeploymentMetrics</span><span class="p">:</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="sd">    Track certificate deployment and installation</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="c1"># Deployment tracking</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="n">deployments</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s1">&#39;certificate_deployments_total&#39;</span><span class="p">,</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>                         <span class="s1">&#39;Total certificate deployments&#39;</span><span class="p">,</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>                         <span class="p">[</span><span class="s1">&#39;environment&#39;</span><span class="p">,</span> <span class="s1">&#39;deployment_method&#39;</span><span class="p">])</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="c1"># Deployment lag</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    <span class="n">deployment_lag</span> <span class="o">=</span> <span class="n">Histogram</span><span class="p">(</span><span class="s1">&#39;certificate_deployment_lag_seconds&#39;</span><span class="p">,</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>                              <span class="s1">&#39;Time from issuance to deployment&#39;</span><span class="p">,</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>                              <span class="p">[</span><span class="s1">&#39;environment&#39;</span><span class="p">])</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    <span class="c1"># Deployment failures</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>    <span class="n">deployment_failures</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s1">&#39;certificate_deployment_failures_total&#39;</span><span class="p">,</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>                                 <span class="s1">&#39;Failed deployment attempts&#39;</span><span class="p">,</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>                                 <span class="p">[</span><span class="s1">&#39;target_type&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">])</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>    <span class="c1"># Rollback events</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>    <span class="n">rollbacks</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s1">&#39;certificate_rollbacks_total&#39;</span><span class="p">,</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>                       <span class="s1">&#39;Certificate deployment rollbacks&#39;</span><span class="p">,</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>                       <span class="p">[</span><span class="s1">&#39;reason&#39;</span><span class="p">])</span>
</code></pre></div></p>
<p>Deployment signals:</p>
<ul>
<li>Time from issuance to active use</li>
<li>Deployment success rate</li>
<li>Staging vs. production deployment patterns</li>
<li>Rollback frequency and causes</li>
<li>Configuration drift detection</li>
</ul>
<p><strong>Operational monitoring</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">OperationalMetrics</span><span class="p">:</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="sd">    Monitor active certificates in production</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="c1"># Certificate health</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    <span class="n">certificates_in_use</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s1">&#39;certificates_active_total&#39;</span><span class="p">,</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>                               <span class="s1">&#39;Active certificates&#39;</span><span class="p">,</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>                               <span class="p">[</span><span class="s1">&#39;environment&#39;</span><span class="p">,</span> <span class="s1">&#39;service_type&#39;</span><span class="p">])</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    <span class="c1"># Trust chain validation</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    <span class="n">chain_validation_status</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s1">&#39;certificate_chain_valid&#39;</span><span class="p">,</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>                                   <span class="s1">&#39;Certificate chain validation status&#39;</span><span class="p">,</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>                                   <span class="p">[</span><span class="s1">&#39;hostname&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">])</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>    <span class="c1"># Protocol support</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    <span class="n">tls_version_usage</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s1">&#39;tls_connections_total&#39;</span><span class="p">,</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>                               <span class="s1">&#39;TLS connections by version&#39;</span><span class="p">,</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>                               <span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;service&#39;</span><span class="p">])</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>    <span class="c1"># Cipher suite usage</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>    <span class="n">cipher_suite_usage</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s1">&#39;tls_cipher_suite_total&#39;</span><span class="p">,</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>                                <span class="s1">&#39;Cipher suite usage&#39;</span><span class="p">,</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>                                <span class="p">[</span><span class="s1">&#39;cipher_suite&#39;</span><span class="p">,</span> <span class="s1">&#39;service&#39;</span><span class="p">])</span>
</code></pre></div></p>
<p>Operational signals:</p>
<ul>
<li>Certificate validation status (valid, expired, revoked)</li>
<li>Trust chain completeness</li>
<li>OCSP/CRL check success rate</li>
<li>TLS handshake success rate</li>
<li>Protocol version distribution</li>
<li>Cipher suite usage patterns</li>
</ul>
<p><strong>Expiry monitoring</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ExpiryMetrics</span><span class="p">:</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="sd">    Track certificate expiry and renewal status</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="c1"># Time until expiry buckets</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">expiry_buckets</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s1">&#39;certificates_expiring&#39;</span><span class="p">,</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>                          <span class="s1">&#39;Certificates expiring in time ranges&#39;</span><span class="p">,</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>                          <span class="p">[</span><span class="s1">&#39;days_range&#39;</span><span class="p">,</span> <span class="s1">&#39;criticality&#39;</span><span class="p">])</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="c1"># Expired certificates</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="n">expired_certificates</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s1">&#39;certificates_expired_total&#39;</span><span class="p">,</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>                                <span class="s1">&#39;Number of expired certificates&#39;</span><span class="p">,</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>                                <span class="p">[</span><span class="s1">&#39;environment&#39;</span><span class="p">,</span> <span class="s1">&#39;owner_team&#39;</span><span class="p">])</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    <span class="c1"># Renewal status</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>    <span class="n">renewal_status</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s1">&#39;certificate_renewal_status&#39;</span><span class="p">,</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>                          <span class="s1">&#39;Certificate renewal workflow status&#39;</span><span class="p">,</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>                          <span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;certificate_id&#39;</span><span class="p">])</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>    <span class="c1"># Time to renewal</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>    <span class="n">days_until_renewal</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s1">&#39;certificate_days_until_renewal&#39;</span><span class="p">,</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>                              <span class="s1">&#39;Days until certificate renewal needed&#39;</span><span class="p">,</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>                              <span class="p">[</span><span class="s1">&#39;certificate_id&#39;</span><span class="p">,</span> <span class="s1">&#39;hostname&#39;</span><span class="p">])</span>
</code></pre></div></p>
<p>Expiry signals:</p>
<ul>
<li>Certificates expiring in 7/14/30/60/90 days</li>
<li>Already expired certificates</li>
<li>Renewal workflow status (pending, in-progress, failed)</li>
<li>Historical renewal success rate</li>
<li>Average time-to-renewal</li>
</ul>
<h3 id="infrastructure-health">Infrastructure Health</h3>
<p><strong>CA availability</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">monitor_ca_health</span><span class="p">(</span><span class="n">ca_endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HealthStatus</span><span class="p">:</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="sd">    Monitor certificate authority availability and performance</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="n">health</span> <span class="o">=</span> <span class="n">HealthStatus</span><span class="p">()</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="c1"># Endpoint reachability</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ca_endpoint</span><span class="si">}</span><span class="s2">/health&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>        <span class="n">health</span><span class="o">.</span><span class="n">reachable</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>        <span class="n">health</span><span class="o">.</span><span class="n">response_time</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">elapsed</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>        <span class="n">health</span><span class="o">.</span><span class="n">reachable</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>        <span class="n">health</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>    <span class="c1"># OCSP responder</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>        <span class="n">ocsp_response</span> <span class="o">=</span> <span class="n">check_ocsp_responder</span><span class="p">(</span><span class="n">ca_endpoint</span><span class="p">)</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>        <span class="n">health</span><span class="o">.</span><span class="n">ocsp_available</span> <span class="o">=</span> <span class="n">ocsp_response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;good&#39;</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>        <span class="n">health</span><span class="o">.</span><span class="n">ocsp_response_time</span> <span class="o">=</span> <span class="n">ocsp_response</span><span class="o">.</span><span class="n">duration</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>        <span class="n">health</span><span class="o">.</span><span class="n">ocsp_available</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>        <span class="n">health</span><span class="o">.</span><span class="n">ocsp_error</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>    <span class="c1"># CRL availability</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>        <span class="n">crl</span> <span class="o">=</span> <span class="n">fetch_crl</span><span class="p">(</span><span class="n">ca_endpoint</span><span class="p">)</span>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>        <span class="n">health</span><span class="o">.</span><span class="n">crl_available</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>        <span class="n">health</span><span class="o">.</span><span class="n">crl_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">crl</span><span class="o">.</span><span class="n">revoked_certificates</span><span class="p">)</span>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>        <span class="n">health</span><span class="o">.</span><span class="n">crl_next_update</span> <span class="o">=</span> <span class="n">crl</span><span class="o">.</span><span class="n">next_update</span>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>        <span class="n">health</span><span class="o">.</span><span class="n">crl_available</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>        <span class="n">health</span><span class="o">.</span><span class="n">crl_error</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a>
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a>    <span class="k">return</span> <span class="n">health</span>
</code></pre></div></p>
<p>CA health signals:</p>
<ul>
<li>Endpoint availability (uptime percentage)</li>
<li>Response time (p50, p95, p99)</li>
<li>Error rate</li>
<li>OCSP responder availability</li>
<li>CRL availability and freshness</li>
<li>Rate limiting violations</li>
<li>Certificate queue depth</li>
</ul>
<p><strong>Validation infrastructure</strong>:</p>
<ul>
<li>OCSP responder availability per CA</li>
<li>OCSP response time</li>
<li>CRL download success rate</li>
<li>CRL size and update frequency</li>
<li>CT log availability</li>
<li>DNS CAA record validation</li>
</ul>
<h3 id="security-signals">Security Signals</h3>
<p><strong>Cryptographic strength</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">assess_cryptographic_strength</span><span class="p">(</span><span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SecurityAssessment</span><span class="p">:</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="sd">    Evaluate certificate cryptographic properties</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="n">assessment</span> <span class="o">=</span> <span class="n">SecurityAssessment</span><span class="p">()</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    <span class="c1"># Key strength</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_algorithm</span> <span class="o">==</span> <span class="s1">&#39;RSA&#39;</span><span class="p">:</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>        <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_size</span> <span class="o">&lt;</span> <span class="mi">2048</span><span class="p">:</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>            <span class="n">assessment</span><span class="o">.</span><span class="n">add_finding</span><span class="p">(</span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">,</span> <span class="s1">&#39;RSA key size below 2048 bits&#39;</span><span class="p">)</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>        <span class="k">elif</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_size</span> <span class="o">&lt;</span> <span class="mi">3072</span><span class="p">:</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>            <span class="n">assessment</span><span class="o">.</span><span class="n">add_finding</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="s1">&#39;RSA key size below recommended 3072 bits&#39;</span><span class="p">)</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>    <span class="k">elif</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_algorithm</span> <span class="o">==</span> <span class="s1">&#39;ECDSA&#39;</span><span class="p">:</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>        <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_size</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">:</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>            <span class="n">assessment</span><span class="o">.</span><span class="n">add_finding</span><span class="p">(</span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">,</span> <span class="s1">&#39;ECDSA key size below 256 bits&#39;</span><span class="p">)</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>    <span class="c1"># Signature algorithm</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>    <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">signature_algorithm</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sha1&#39;</span><span class="p">,</span> <span class="s1">&#39;md5&#39;</span><span class="p">]:</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>        <span class="n">assessment</span><span class="o">.</span><span class="n">add_finding</span><span class="p">(</span><span class="s1">&#39;CRITICAL&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Weak signature algorithm: </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">signature_algorithm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>    <span class="c1"># Validity period</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>    <span class="n">validity_days</span> <span class="o">=</span> <span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">not_after</span> <span class="o">-</span> <span class="n">cert</span><span class="o">.</span><span class="n">not_before</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>    <span class="k">if</span> <span class="n">validity_days</span> <span class="o">&gt;</span> <span class="mi">398</span><span class="p">:</span>  <span class="c1"># Current CA/B Forum limit</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>        <span class="n">assessment</span><span class="o">.</span><span class="n">add_finding</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Validity period exceeds 398 days: </span><span class="si">{</span><span class="n">validity_days</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>    <span class="c1"># Common name in SAN</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>    <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">common_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cert</span><span class="o">.</span><span class="n">subject_alternative_names</span><span class="p">:</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>        <span class="n">assessment</span><span class="o">.</span><span class="n">add_finding</span><span class="p">(</span><span class="s1">&#39;WARNING&#39;</span><span class="p">,</span> <span class="s1">&#39;Common name not in SANs&#39;</span><span class="p">)</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>    <span class="k">return</span> <span class="n">assessment</span>
</code></pre></div></p>
<p>Security monitoring signals:</p>
<ul>
<li>Weak key algorithms in use</li>
<li>Deprecated signature algorithms</li>
<li>Certificate policy violations</li>
<li>Unauthorized CA usage</li>
<li>Self-signed certificates in production</li>
<li>Certificate key compromise indicators</li>
<li>Anomalous certificate usage patterns</li>
</ul>
<p><strong>Trust chain validation</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">monitor_trust_chain</span><span class="p">(</span><span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">,</span> 
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>                       <span class="n">trusted_roots</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Certificate</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">TrustStatus</span><span class="p">:</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="sd">    Continuously validate certificate trust chains</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="n">status</span> <span class="o">=</span> <span class="n">TrustStatus</span><span class="p">()</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    <span class="c1"># Build chain</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>        <span class="n">chain</span> <span class="o">=</span> <span class="n">build_certificate_chain</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>        <span class="n">status</span><span class="o">.</span><span class="n">chain_complete</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>        <span class="n">status</span><span class="o">.</span><span class="n">chain_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="k">except</span> <span class="n">ChainBuildError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>        <span class="n">status</span><span class="o">.</span><span class="n">chain_complete</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>        <span class="n">status</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>        <span class="k">return</span> <span class="n">status</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>    <span class="c1"># Validate to trusted root</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>    <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">trusted_roots</span><span class="p">:</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>        <span class="k">if</span> <span class="n">chain</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fingerprint</span> <span class="o">==</span> <span class="n">root</span><span class="o">.</span><span class="n">fingerprint</span><span class="p">:</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>            <span class="n">status</span><span class="o">.</span><span class="n">trusted</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>            <span class="n">status</span><span class="o">.</span><span class="n">trust_anchor</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">subject_dn</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>            <span class="k">break</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="o">.</span><span class="n">trusted</span><span class="p">:</span>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>        <span class="n">status</span><span class="o">.</span><span class="n">trusted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>        <span class="n">status</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Chain does not terminate in trusted root&quot;</span>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>    <span class="c1"># Check for revocation</span>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>    <span class="k">for</span> <span class="n">cert_in_chain</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">:</span>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>        <span class="n">revocation_status</span> <span class="o">=</span> <span class="n">check_revocation</span><span class="p">(</span><span class="n">cert_in_chain</span><span class="p">)</span>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>        <span class="k">if</span> <span class="n">revocation_status</span> <span class="o">==</span> <span class="s1">&#39;revoked&#39;</span><span class="p">:</span>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>            <span class="n">status</span><span class="o">.</span><span class="n">trusted</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>            <span class="n">status</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Certificate in chain is revoked: </span><span class="si">{</span><span class="n">cert_in_chain</span><span class="o">.</span><span class="n">subject_dn</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>    <span class="k">return</span> <span class="n">status</span>
</code></pre></div></p>
<p>Trust signals:</p>
<ul>
<li>Incomplete certificate chains</li>
<li>Untrusted root certificates</li>
<li>Revoked certificates in chains</li>
<li>Expired intermediate certificates</li>
<li>Cross-signed certificate usage</li>
</ul>
<h3 id="compliance-monitoring">Compliance Monitoring</h3>
<p><strong>Policy violations</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ComplianceMonitor</span><span class="p">:</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">CertificatePolicy</span><span class="p">):</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">policy</span> <span class="o">=</span> <span class="n">policy</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_compliance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ComplianceResult</span><span class="p">:</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="sd">        Evaluate certificate against organizational policy</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">ComplianceResult</span><span class="p">()</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>        <span class="c1"># Key length requirements</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>        <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">min_key_size</span><span class="p">:</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>            <span class="n">result</span><span class="o">.</span><span class="n">add_violation</span><span class="p">(</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>                <span class="s1">&#39;KEY_LENGTH&#39;</span><span class="p">,</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>                <span class="sa">f</span><span class="s1">&#39;Key size </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">key_size</span><span class="si">}</span><span class="s1"> below minimum </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">min_key_size</span><span class="si">}</span><span class="s1">&#39;</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>            <span class="p">)</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>        <span class="c1"># Approved CAs</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>        <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">issuer_cn</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">approved_cas</span><span class="p">:</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>            <span class="n">result</span><span class="o">.</span><span class="n">add_violation</span><span class="p">(</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>                <span class="s1">&#39;UNAUTHORIZED_CA&#39;</span><span class="p">,</span>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>                <span class="sa">f</span><span class="s1">&#39;Certificate issued by unauthorized CA: </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">issuer_cn</span><span class="si">}</span><span class="s1">&#39;</span>
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>            <span class="p">)</span>
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>        <span class="c1"># Maximum validity</span>
<a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>        <span class="n">validity_days</span> <span class="o">=</span> <span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">not_after</span> <span class="o">-</span> <span class="n">cert</span><span class="o">.</span><span class="n">not_before</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
<a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>        <span class="k">if</span> <span class="n">validity_days</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">max_validity_days</span><span class="p">:</span>
<a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>            <span class="n">result</span><span class="o">.</span><span class="n">add_violation</span><span class="p">(</span>
<a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a>                <span class="s1">&#39;VALIDITY_PERIOD&#39;</span><span class="p">,</span>
<a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>                <span class="sa">f</span><span class="s1">&#39;Validity </span><span class="si">{</span><span class="n">validity_days</span><span class="si">}</span><span class="s1"> days exceeds maximum </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">max_validity_days</span><span class="si">}</span><span class="s1">&#39;</span>
<a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>            <span class="p">)</span>
<a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a>
<a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a>        <span class="c1"># Required extensions</span>
<a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a>        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">required_extensions</span><span class="p">:</span>
<a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a>            <span class="k">if</span> <span class="n">ext</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cert</span><span class="o">.</span><span class="n">extensions</span><span class="p">:</span>
<a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>                <span class="n">result</span><span class="o">.</span><span class="n">add_violation</span><span class="p">(</span>
<a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a>                    <span class="s1">&#39;MISSING_EXTENSION&#39;</span><span class="p">,</span>
<a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a>                    <span class="sa">f</span><span class="s1">&#39;Required extension missing: </span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s1">&#39;</span>
<a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a>                <span class="p">)</span>
<a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a>
<a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a>        <span class="c1"># Naming conventions</span>
<a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">naming_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">subject_cn</span><span class="p">):</span>
<a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a>            <span class="n">result</span><span class="o">.</span><span class="n">add_violation</span><span class="p">(</span>
<a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a>                <span class="s1">&#39;NAMING_VIOLATION&#39;</span><span class="p">,</span>
<a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a>                <span class="sa">f</span><span class="s1">&#39;Subject CN does not match required pattern&#39;</span>
<a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a>            <span class="p">)</span>
<a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a>
<a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a>        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></p>
<p>Compliance signals:</p>
<ul>
<li>Policy violation count by type</li>
<li>Non-compliant certificates by team</li>
<li>Time to remediation for violations</li>
<li>Compliance score trends</li>
<li>Audit-ready certificate percentage</li>
</ul>
<h3 id="business-impact-signals">Business Impact Signals</h3>
<p><strong>Service dependencies</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nd">@dataclass</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">ServiceImpactAssessment</span><span class="p">:</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="sd">    Assess business impact of certificate issues</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>    <span class="n">service_name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>    <span class="n">certificate</span><span class="p">:</span> <span class="n">Certificate</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>    <span class="n">user_impact</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &#39;none&#39;, &#39;degraded&#39;, &#39;down&#39;</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>    <span class="n">affected_users</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>    <span class="n">revenue_impact</span><span class="p">:</span> <span class="nb">float</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>    <span class="n">sla_breach</span><span class="p">:</span> <span class="nb">bool</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_priority</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="sd">        Calculate incident priority based on impact</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_impact</span> <span class="o">==</span> <span class="s1">&#39;down&#39;</span><span class="p">:</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_users</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>                <span class="k">return</span> <span class="s1">&#39;P0&#39;</span>  <span class="c1"># Critical</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_users</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>                <span class="k">return</span> <span class="s1">&#39;P1&#39;</span>  <span class="c1"># High</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>                <span class="k">return</span> <span class="s1">&#39;P2&#39;</span>  <span class="c1"># Medium</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_impact</span> <span class="o">==</span> <span class="s1">&#39;degraded&#39;</span><span class="p">:</span>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>            <span class="k">return</span> <span class="s1">&#39;P2&#39;</span>  <span class="c1"># Medium</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>            <span class="k">return</span> <span class="s1">&#39;P3&#39;</span>  <span class="c1"># Low</span>
</code></pre></div></p>
<p>Business signals:</p>
<ul>
<li>Services at risk from certificate expiry</li>
<li>User-facing vs. internal service certificates</li>
<li>Revenue-critical certificate health</li>
<li>SLA compliance impact</li>
<li>Customer-reported certificate errors</li>
</ul>
<h2 id="alerting-strategy">Alerting Strategy</h2>
<h3 id="alert-design-principles">Alert Design Principles</h3>
<p><strong>Actionability</strong>: Every alert must have a clear action. No "FYI" alerts.</p>
<p><strong>Severity levels</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AlertSeverity</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="n">CRITICAL</span> <span class="o">=</span> <span class="s2">&quot;P0&quot;</span>  <span class="c1"># Immediate action required, user impact</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="n">HIGH</span> <span class="o">=</span> <span class="s2">&quot;P1&quot;</span>      <span class="c1"># Urgent action required, imminent impact</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>    <span class="n">MEDIUM</span> <span class="o">=</span> <span class="s2">&quot;P2&quot;</span>    <span class="c1"># Action required, no immediate impact</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>    <span class="n">LOW</span> <span class="o">=</span> <span class="s2">&quot;P3&quot;</span>       <span class="c1"># Informational, action at convenience</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>    <span class="n">INFO</span> <span class="o">=</span> <span class="s2">&quot;P4&quot;</span>      <span class="c1"># Notification only, no action needed</span>
</code></pre></div></p>
<p><strong>Alert definition structure</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nd">@dataclass</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">AlertDefinition</span><span class="p">:</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="n">severity</span><span class="p">:</span> <span class="n">AlertSeverity</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>    <span class="c1"># Trigger condition</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    <span class="n">condition</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>    <span class="n">threshold</span><span class="p">:</span> <span class="n">Any</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>    <span class="n">evaluation_interval</span><span class="p">:</span> <span class="n">timedelta</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>    <span class="c1"># Context</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>    <span class="n">runbook_url</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>    <span class="n">owner_team</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>    <span class="n">escalation_policy</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>    <span class="c1"># Notification</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>    <span class="n">channels</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1"># [&#39;email&#39;, &#39;slack&#39;, &#39;pagerduty&#39;]</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>    <span class="c1"># Deduplication</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>    <span class="n">dedup_window</span><span class="p">:</span> <span class="n">timedelta</span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>    <span class="c1"># Auto-remediation</span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>    <span class="n">auto_remediate</span><span class="p">:</span> <span class="nb">bool</span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>    <span class="n">remediation_action</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span>
</code></pre></div></p>
<h3 id="alert-categories">Alert Categories</h3>
<p><strong>Expiry alerts</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Critical: Certificate expires within 7 days (production)</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">AlertDefinition</span><span class="p">(</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;certificate_expiring_critical&quot;</span><span class="p">,</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Production certificate expiring within 7 days&quot;</span><span class="p">,</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">AlertSeverity</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">,</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;days_until_expiry &lt;= 7 AND environment == &#39;production&#39;&quot;</span><span class="p">,</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    <span class="n">threshold</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    <span class="n">evaluation_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>    <span class="n">runbook_url</span><span class="o">=</span><span class="s2">&quot;https://wiki/runbooks/cert-expiry&quot;</span><span class="p">,</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>    <span class="n">owner_team</span><span class="o">=</span><span class="s2">&quot;platform&quot;</span><span class="p">,</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>    <span class="n">escalation_policy</span><span class="o">=</span><span class="s2">&quot;cert_team_escalation&quot;</span><span class="p">,</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pagerduty&#39;</span><span class="p">,</span> <span class="s1">&#39;slack&#39;</span><span class="p">],</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>    <span class="n">dedup_window</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="p">)</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="c1"># High: Certificate expires within 30 days (production)</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="n">AlertDefinition</span><span class="p">(</span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;certificate_expiring_soon&quot;</span><span class="p">,</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Production certificate expiring within 30 days&quot;</span><span class="p">,</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">AlertSeverity</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;days_until_expiry &lt;= 30 AND environment == &#39;production&#39;&quot;</span><span class="p">,</span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a>    <span class="n">threshold</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a>    <span class="n">evaluation_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a>    <span class="n">runbook_url</span><span class="o">=</span><span class="s2">&quot;https://wiki/runbooks/cert-renewal&quot;</span><span class="p">,</span>
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>    <span class="n">owner_team</span><span class="o">=</span><span class="s2">&quot;cert_owners&quot;</span><span class="p">,</span>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>    <span class="n">escalation_policy</span><span class="o">=</span><span class="s2">&quot;email_only&quot;</span><span class="p">,</span>
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;slack&#39;</span><span class="p">],</span>
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>    <span class="n">dedup_window</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a><span class="p">)</span>
<a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a>
<a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a><span class="c1"># Medium: Certificate expires within 60 days</span>
<a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="n">AlertDefinition</span><span class="p">(</span>
<a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;certificate_renewal_reminder&quot;</span><span class="p">,</span>
<a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Certificate expiring within 60 days&quot;</span><span class="p">,</span>
<a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">AlertSeverity</span><span class="o">.</span><span class="n">MEDIUM</span><span class="p">,</span>
<a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;days_until_expiry &lt;= 60&quot;</span><span class="p">,</span>
<a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a>    <span class="n">threshold</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
<a id="__codelineno-11-38" name="__codelineno-11-38" href="#__codelineno-11-38"></a>    <span class="n">evaluation_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-11-39" name="__codelineno-11-39" href="#__codelineno-11-39"></a>    <span class="n">runbook_url</span><span class="o">=</span><span class="s2">&quot;https://wiki/runbooks/cert-renewal&quot;</span><span class="p">,</span>
<a id="__codelineno-11-40" name="__codelineno-11-40" href="#__codelineno-11-40"></a>    <span class="n">owner_team</span><span class="o">=</span><span class="s2">&quot;cert_owners&quot;</span><span class="p">,</span>
<a id="__codelineno-11-41" name="__codelineno-11-41" href="#__codelineno-11-41"></a>    <span class="n">escalation_policy</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
<a id="__codelineno-11-42" name="__codelineno-11-42" href="#__codelineno-11-42"></a>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">],</span>
<a id="__codelineno-11-43" name="__codelineno-11-43" href="#__codelineno-11-43"></a>    <span class="n">dedup_window</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-11-44" name="__codelineno-11-44" href="#__codelineno-11-44"></a><span class="p">)</span>
</code></pre></div></p>
<p><strong>Validation alerts</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># Critical: Certificate validation failures</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">AlertDefinition</span><span class="p">(</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;certificate_validation_failure&quot;</span><span class="p">,</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Certificate failing validation checks&quot;</span><span class="p">,</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">AlertSeverity</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">,</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;validation_status == &#39;failed&#39;&quot;</span><span class="p">,</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>    <span class="n">evaluation_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>    <span class="n">runbook_url</span><span class="o">=</span><span class="s2">&quot;https://wiki/runbooks/cert-validation&quot;</span><span class="p">,</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pagerduty&#39;</span><span class="p">,</span> <span class="s1">&#39;slack&#39;</span><span class="p">]</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="p">)</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="c1"># Critical: Trust chain incomplete</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="n">AlertDefinition</span><span class="p">(</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;incomplete_certificate_chain&quot;</span><span class="p">,</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Certificate chain cannot be validated to trusted root&quot;</span><span class="p">,</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">AlertSeverity</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">,</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;chain_status == &#39;incomplete&#39; OR chain_status == &#39;untrusted&#39;&quot;</span><span class="p">,</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>    <span class="n">evaluation_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>    <span class="n">runbook_url</span><span class="o">=</span><span class="s2">&quot;https://wiki/runbooks/trust-chain&quot;</span><span class="p">,</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pagerduty&#39;</span><span class="p">]</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="p">)</span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="c1"># High: OCSP/CRL check failures</span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="n">AlertDefinition</span><span class="p">(</span>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;revocation_check_failure&quot;</span><span class="p">,</span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Unable to check certificate revocation status&quot;</span><span class="p">,</span>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">AlertSeverity</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;revocation_check_failures &gt; 3 in 30 minutes&quot;</span><span class="p">,</span>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a>    <span class="n">evaluation_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a>    <span class="n">runbook_url</span><span class="o">=</span><span class="s2">&quot;https://wiki/runbooks/revocation&quot;</span><span class="p">,</span>
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slack&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">]</span>
<a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a><span class="p">)</span>
</code></pre></div></p>
<p><strong>Security alerts</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Critical: Weak cryptography detected</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">AlertDefinition</span><span class="p">(</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;weak_cryptography_detected&quot;</span><span class="p">,</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Certificate using deprecated cryptographic algorithms&quot;</span><span class="p">,</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">AlertSeverity</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">,</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;key_size &lt; 2048 OR signature_algorithm in [&#39;sha1&#39;, &#39;md5&#39;]&quot;</span><span class="p">,</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>    <span class="n">evaluation_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>    <span class="n">runbook_url</span><span class="o">=</span><span class="s2">&quot;https://wiki/runbooks/crypto-migration&quot;</span><span class="p">,</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;security-team&#39;</span><span class="p">,</span> <span class="s1">&#39;slack&#39;</span><span class="p">]</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="p">)</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="c1"># High: Unauthorized CA usage</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="n">AlertDefinition</span><span class="p">(</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;unauthorized_ca_detected&quot;</span><span class="p">,</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Certificate issued by unauthorized CA&quot;</span><span class="p">,</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">AlertSeverity</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;issuer_ca NOT IN approved_ca_list&quot;</span><span class="p">,</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>    <span class="n">evaluation_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>    <span class="n">runbook_url</span><span class="o">=</span><span class="s2">&quot;https://wiki/runbooks/unauthorized-ca&quot;</span><span class="p">,</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;security-team&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">]</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="p">)</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="c1"># High: Self-signed certificate in production</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="n">AlertDefinition</span><span class="p">(</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;self_signed_production&quot;</span><span class="p">,</span>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Self-signed certificate detected in production&quot;</span><span class="p">,</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">AlertSeverity</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;is_self_signed == true AND environment == &#39;production&#39;&quot;</span><span class="p">,</span>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a>    <span class="n">evaluation_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
<a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a>    <span class="n">runbook_url</span><span class="o">=</span><span class="s2">&quot;https://wiki/runbooks/self-signed&quot;</span><span class="p">,</span>
<a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;security-team&#39;</span><span class="p">,</span> <span class="s1">&#39;slack&#39;</span><span class="p">]</span>
<a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="p">)</span>
</code></pre></div></p>
<p><strong>Compliance alerts</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Medium: Policy violation</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">AlertDefinition</span><span class="p">(</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;certificate_policy_violation&quot;</span><span class="p">,</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Certificate violates organizational policy&quot;</span><span class="p">,</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">AlertSeverity</span><span class="o">.</span><span class="n">MEDIUM</span><span class="p">,</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;compliance_violations &gt; 0&quot;</span><span class="p">,</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>    <span class="n">evaluation_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>    <span class="n">runbook_url</span><span class="o">=</span><span class="s2">&quot;https://wiki/runbooks/compliance&quot;</span><span class="p">,</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;compliance-team&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">]</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="p">)</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="c1"># Medium: Long validity period</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="n">AlertDefinition</span><span class="p">(</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;excessive_validity_period&quot;</span><span class="p">,</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Certificate validity exceeds policy maximum&quot;</span><span class="p">,</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>    <span class="n">severity</span><span class="o">=</span><span class="n">AlertSeverity</span><span class="o">.</span><span class="n">MEDIUM</span><span class="p">,</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;validity_days &gt; max_allowed_validity&quot;</span><span class="p">,</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>    <span class="n">evaluation_interval</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>    <span class="n">runbook_url</span><span class="o">=</span><span class="s2">&quot;https://wiki/runbooks/validity&quot;</span><span class="p">,</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="p">)</span>
</code></pre></div></p>
<h3 id="alert-enrichment">Alert Enrichment</h3>
<p><strong>Contextual information</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">enrich_alert</span><span class="p">(</span><span class="n">alert</span><span class="p">:</span> <span class="n">Alert</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EnrichedAlert</span><span class="p">:</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="sd">    Add context to alerts for faster response</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    <span class="n">enriched</span> <span class="o">=</span> <span class="n">EnrichedAlert</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>    <span class="c1"># Certificate details</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">certificate_subject</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">subject_cn</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">certificate_san</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">subject_alternative_names</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">issuer</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">issuer_cn</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">serial_number</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">serial_number</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>    <span class="c1"># Location and usage</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">hostnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">loc</span><span class="o">.</span><span class="n">hostname</span> <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">locations</span><span class="p">]</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">services</span> <span class="o">=</span> <span class="p">[</span><span class="n">loc</span><span class="o">.</span><span class="n">application</span> <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">locations</span><span class="p">]</span>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">environments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">environment</span> <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">locations</span><span class="p">))</span>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a>
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a>    <span class="c1"># Ownership</span>
<a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">owner_team</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">owner_team</span>
<a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">on_call</span> <span class="o">=</span> <span class="n">get_on_call_engineer</span><span class="p">(</span><span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">owner_team</span><span class="p">)</span>
<a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a>
<a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a>    <span class="c1"># Business impact</span>
<a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">criticality</span> <span class="o">=</span> <span class="n">assess_service_criticality</span><span class="p">(</span><span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="p">)</span>
<a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">user_impact</span> <span class="o">=</span> <span class="n">estimate_user_impact</span><span class="p">(</span><span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="p">)</span>
<a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">revenue_impact</span> <span class="o">=</span> <span class="n">estimate_revenue_impact</span><span class="p">(</span><span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="p">)</span>
<a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a>
<a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a>    <span class="c1"># Remediation</span>
<a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">suggested_actions</span> <span class="o">=</span> <span class="n">generate_remediation_steps</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
<a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">runbook_link</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">definition</span><span class="o">.</span><span class="n">runbook_url</span>
<a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">similar_past_incidents</span> <span class="o">=</span> <span class="n">find_similar_incidents</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
<a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a>
<a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a>    <span class="c1"># Dependencies</span>
<a id="__codelineno-15-33" name="__codelineno-15-33" href="#__codelineno-15-33"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">dependent_services</span> <span class="o">=</span> <span class="n">find_dependent_services</span><span class="p">(</span><span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="p">)</span>
<a id="__codelineno-15-34" name="__codelineno-15-34" href="#__codelineno-15-34"></a>    <span class="n">enriched</span><span class="o">.</span><span class="n">trust_chain</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">chain</span>
<a id="__codelineno-15-35" name="__codelineno-15-35" href="#__codelineno-15-35"></a>
<a id="__codelineno-15-36" name="__codelineno-15-36" href="#__codelineno-15-36"></a>    <span class="k">return</span> <span class="n">enriched</span>
</code></pre></div></p>
<p><strong>Alert message template</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a> CRITICAL: Certificate Expiring in 7 Days
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>Certificate: *.api.example.com
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>Serial: 1A:2B:3C:4D:5E:6F:7G:8H
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>Expires: 2025-11-16 14:23:00 UTC (7 days)
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>Impact:
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>   Services: payment-api, user-api, merchant-api
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>   Environment: production
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>   Criticality: HIGH
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>   Estimated users affected: 2.5M
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>Owner: @platform-team
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>On-call: @jane-smith
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>Actions Required:
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>  1. Initiate certificate renewal immediately
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>  2. Follow runbook: https://wiki/runbooks/cert-expiry
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>  3. Update tracking ticket: CERT-12345
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>Renewal Status: Not Started 
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>Last Renewal: 2024-08-15 (90 days ago)
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>Similar Incidents:
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>   CERT-11234 (3 months ago) - Resolved in 4 hours
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>   CERT-10123 (6 months ago) - Resolved in 2 hours
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>
<a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>Dependencies:
<a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>   Load balancer: lb-prod-01.example.com
<a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>   Ingress controllers: 5 Kubernetes clusters
<a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>   CDN: CloudFront distribution d1234567
<a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>
<a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a> View in Dashboard: https://cert-dashboard/cert/1A2B3C4D
<a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a> Runbook: https://wiki/runbooks/cert-expiry
</code></pre></div></p>
<h3 id="alert-routing-and-escalation">Alert Routing and Escalation</h3>
<p><strong>Routing logic</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AlertRouter</span><span class="p">:</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">route_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="p">:</span> <span class="n">EnrichedAlert</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">NotificationChannel</span><span class="p">]:</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="sd">        Determine where to send alert based on severity and context</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>        <span class="n">channels</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>        <span class="c1"># Critical alerts</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>        <span class="k">if</span> <span class="n">alert</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="n">AlertSeverity</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">:</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>            <span class="c1"># Page on-call</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>            <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PagerDutyChannel</span><span class="p">(</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>                <span class="n">service</span><span class="o">=</span><span class="n">alert</span><span class="o">.</span><span class="n">owner_team</span><span class="p">,</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>                <span class="n">escalation_policy</span><span class="o">=</span><span class="s1">&#39;immediate&#39;</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>            <span class="p">))</span>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>            <span class="c1"># Slack critical channel</span>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>            <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SlackChannel</span><span class="p">(</span>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>                <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;#certificates-critical&#39;</span><span class="p">,</span>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>                <span class="n">mention</span><span class="o">=</span><span class="s1">&#39;@here&#39;</span>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>            <span class="p">))</span>
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>            <span class="c1"># If high business impact, page leadership</span>
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>            <span class="k">if</span> <span class="n">alert</span><span class="o">.</span><span class="n">user_impact</span> <span class="o">==</span> <span class="s1">&#39;high&#39;</span><span class="p">:</span>
<a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a>                <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PagerDutyChannel</span><span class="p">(</span>
<a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a>                    <span class="n">service</span><span class="o">=</span><span class="s1">&#39;leadership&#39;</span><span class="p">,</span>
<a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a>                    <span class="n">escalation_policy</span><span class="o">=</span><span class="s1">&#39;executive&#39;</span>
<a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a>                <span class="p">))</span>
<a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a>
<a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a>        <span class="c1"># High severity</span>
<a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a>        <span class="k">elif</span> <span class="n">alert</span><span class="o">.</span><span class="n">severity</span> <span class="o">==</span> <span class="n">AlertSeverity</span><span class="o">.</span><span class="n">HIGH</span><span class="p">:</span>
<a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a>            <span class="c1"># Slack team channel</span>
<a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a>            <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SlackChannel</span><span class="p">(</span>
<a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a>                <span class="n">channel</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;#</span><span class="si">{</span><span class="n">alert</span><span class="o">.</span><span class="n">owner_team</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<a id="__codelineno-17-34" name="__codelineno-17-34" href="#__codelineno-17-34"></a>                <span class="n">mention</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;@</span><span class="si">{</span><span class="n">alert</span><span class="o">.</span><span class="n">on_call</span><span class="si">}</span><span class="s1">&#39;</span>
<a id="__codelineno-17-35" name="__codelineno-17-35" href="#__codelineno-17-35"></a>            <span class="p">))</span>
<a id="__codelineno-17-36" name="__codelineno-17-36" href="#__codelineno-17-36"></a>
<a id="__codelineno-17-37" name="__codelineno-17-37" href="#__codelineno-17-37"></a>            <span class="c1"># Email to team</span>
<a id="__codelineno-17-38" name="__codelineno-17-38" href="#__codelineno-17-38"></a>            <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EmailChannel</span><span class="p">(</span>
<a id="__codelineno-17-39" name="__codelineno-17-39" href="#__codelineno-17-39"></a>                <span class="n">recipients</span><span class="o">=</span><span class="n">get_team_emails</span><span class="p">(</span><span class="n">alert</span><span class="o">.</span><span class="n">owner_team</span><span class="p">)</span>
<a id="__codelineno-17-40" name="__codelineno-17-40" href="#__codelineno-17-40"></a>            <span class="p">))</span>
<a id="__codelineno-17-41" name="__codelineno-17-41" href="#__codelineno-17-41"></a>
<a id="__codelineno-17-42" name="__codelineno-17-42" href="#__codelineno-17-42"></a>        <span class="c1"># Medium/Low severity</span>
<a id="__codelineno-17-43" name="__codelineno-17-43" href="#__codelineno-17-43"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-17-44" name="__codelineno-17-44" href="#__codelineno-17-44"></a>            <span class="c1"># Email only</span>
<a id="__codelineno-17-45" name="__codelineno-17-45" href="#__codelineno-17-45"></a>            <span class="n">channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EmailChannel</span><span class="p">(</span>
<a id="__codelineno-17-46" name="__codelineno-17-46" href="#__codelineno-17-46"></a>                <span class="n">recipients</span><span class="o">=</span><span class="n">get_team_emails</span><span class="p">(</span><span class="n">alert</span><span class="o">.</span><span class="n">owner_team</span><span class="p">)</span>
<a id="__codelineno-17-47" name="__codelineno-17-47" href="#__codelineno-17-47"></a>            <span class="p">))</span>
<a id="__codelineno-17-48" name="__codelineno-17-48" href="#__codelineno-17-48"></a>
<a id="__codelineno-17-49" name="__codelineno-17-49" href="#__codelineno-17-49"></a>        <span class="k">return</span> <span class="n">channels</span>
</code></pre></div></p>
<p><strong>Escalation policies</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nd">@dataclass</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">EscalationPolicy</span><span class="p">:</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    <span class="n">levels</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">EscalationLevel</span><span class="p">]</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="nd">@dataclass</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">EscalationLevel</span><span class="p">:</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    <span class="n">delay</span><span class="p">:</span> <span class="n">timedelta</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>    <span class="n">targets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>    <span class="n">notification_channels</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="c1"># Example escalation for critical certificate issues</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="n">critical_cert_escalation</span> <span class="o">=</span> <span class="n">EscalationPolicy</span><span class="p">(</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Critical Certificate&quot;</span><span class="p">,</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>    <span class="n">levels</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>        <span class="n">EscalationLevel</span><span class="p">(</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>            <span class="n">delay</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>            <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;primary_on_call&#39;</span><span class="p">],</span>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>            <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pagerduty&#39;</span><span class="p">,</span> <span class="s1">&#39;slack&#39;</span><span class="p">]</span>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>        <span class="p">),</span>
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>        <span class="n">EscalationLevel</span><span class="p">(</span>
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a>            <span class="n">delay</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a>            <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;secondary_on_call&#39;</span><span class="p">,</span> <span class="s1">&#39;team_lead&#39;</span><span class="p">],</span>
<a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a>            <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pagerduty&#39;</span><span class="p">,</span> <span class="s1">&#39;phone&#39;</span><span class="p">]</span>
<a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a>        <span class="p">),</span>
<a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a>        <span class="n">EscalationLevel</span><span class="p">(</span>
<a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a>            <span class="n">delay</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">30</span><span class="p">),</span>
<a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a>            <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;director_infrastructure&#39;</span><span class="p">],</span>
<a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a>            <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pagerduty&#39;</span><span class="p">,</span> <span class="s1">&#39;phone&#39;</span><span class="p">,</span> <span class="s1">&#39;sms&#39;</span><span class="p">]</span>
<a id="__codelineno-18-30" name="__codelineno-18-30" href="#__codelineno-18-30"></a>        <span class="p">),</span>
<a id="__codelineno-18-31" name="__codelineno-18-31" href="#__codelineno-18-31"></a>        <span class="n">EscalationLevel</span><span class="p">(</span>
<a id="__codelineno-18-32" name="__codelineno-18-32" href="#__codelineno-18-32"></a>            <span class="n">delay</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-18-33" name="__codelineno-18-33" href="#__codelineno-18-33"></a>            <span class="n">targets</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vp_engineering&#39;</span><span class="p">,</span> <span class="s1">&#39;ciso&#39;</span><span class="p">],</span>
<a id="__codelineno-18-34" name="__codelineno-18-34" href="#__codelineno-18-34"></a>            <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;phone&#39;</span><span class="p">,</span> <span class="s1">&#39;sms&#39;</span><span class="p">]</span>
<a id="__codelineno-18-35" name="__codelineno-18-35" href="#__codelineno-18-35"></a>        <span class="p">)</span>
<a id="__codelineno-18-36" name="__codelineno-18-36" href="#__codelineno-18-36"></a>    <span class="p">]</span>
<a id="__codelineno-18-37" name="__codelineno-18-37" href="#__codelineno-18-37"></a><span class="p">)</span>
</code></pre></div></p>
<h2 id="monitoring-infrastructure">Monitoring Infrastructure</h2>
<h3 id="data-collection">Data Collection</h3>
<p><strong>Agent architecture</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>           Monitoring Backend                     
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>                                                  
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>          
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    Prometheus          Time-Series DB      
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    /Metrics      (InfluxDB/          
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>                         TimescaleDB)       
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>          
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>                                               
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>                                               
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>                                  
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>                                  
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>         
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>                                          
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>                                          
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>          
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a> Agent      Agent   Agent        Scrapers 
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a> Web-01     App-01  DB-01        API Poll 
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>          
</code></pre></div></p>
<p><strong>Agent capabilities</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CertificateMonitoringAgent</span><span class="p">:</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">AgentConfig</span><span class="p">):</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">metrics_endpoint</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">metrics_endpoint</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">collect_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="sd">        Collect certificate metrics from local system</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>        <span class="n">metrics</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>        <span class="c1"># Discover certificates</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>        <span class="n">certificates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">discover_local_certificates</span><span class="p">()</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>        <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">certificates</span><span class="p">:</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>            <span class="c1"># Basic metrics</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>            <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>                <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="s1">&#39;certificate_info&#39;</span><span class="p">,</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>                <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>                    <span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">subject_cn</span><span class="p">,</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>                    <span class="s1">&#39;issuer&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">issuer_cn</span><span class="p">,</span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>                    <span class="s1">&#39;serial&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">serial_number</span><span class="p">,</span>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>                <span class="p">},</span>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a>                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a>            <span class="p">})</span>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a>            <span class="c1"># Expiry metrics</span>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a>            <span class="n">days_until_expiry</span> <span class="o">=</span> <span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">not_after</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span><span class="o">.</span><span class="n">days</span>
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a>            <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
<a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a>                <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="s1">&#39;certificate_expiry_days&#39;</span><span class="p">,</span>
<a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a>                <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a>                    <span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">subject_cn</span><span class="p">,</span>
<a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a>                    <span class="s1">&#39;hostname&#39;</span><span class="p">:</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>
<a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a>                <span class="p">},</span>
<a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a>                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">days_until_expiry</span>
<a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a>            <span class="p">})</span>
<a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a>
<a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a>            <span class="c1"># Validation status</span>
<a id="__codelineno-20-39" name="__codelineno-20-39" href="#__codelineno-20-39"></a>            <span class="n">validation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_certificate</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-20-40" name="__codelineno-20-40" href="#__codelineno-20-40"></a>            <span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
<a id="__codelineno-20-41" name="__codelineno-20-41" href="#__codelineno-20-41"></a>                <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="s1">&#39;certificate_valid&#39;</span><span class="p">,</span>
<a id="__codelineno-20-42" name="__codelineno-20-42" href="#__codelineno-20-42"></a>                <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">subject_cn</span><span class="p">},</span>
<a id="__codelineno-20-43" name="__codelineno-20-43" href="#__codelineno-20-43"></a>                <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">validation</span><span class="o">.</span><span class="n">valid</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-20-44" name="__codelineno-20-44" href="#__codelineno-20-44"></a>            <span class="p">})</span>
<a id="__codelineno-20-45" name="__codelineno-20-45" href="#__codelineno-20-45"></a>
<a id="__codelineno-20-46" name="__codelineno-20-46" href="#__codelineno-20-46"></a>        <span class="c1"># Push to metrics endpoint</span>
<a id="__codelineno-20-47" name="__codelineno-20-47" href="#__codelineno-20-47"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">push_metrics</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>Push vs. pull models</strong>:</p>
<p>Pull model (Prometheus):
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">prometheus_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">start_http_server</span><span class="p">,</span> <span class="n">Gauge</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c1"># Expose metrics on HTTP endpoint</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="n">expiry_gauge</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span><span class="s1">&#39;certificate_days_until_expiry&#39;</span><span class="p">,</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>                    <span class="s1">&#39;Days until certificate expires&#39;</span><span class="p">,</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>                    <span class="p">[</span><span class="s1">&#39;hostname&#39;</span><span class="p">,</span> <span class="s1">&#39;subject&#39;</span><span class="p">])</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_metrics</span><span class="p">():</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="sd">    Update metrics that Prometheus will scrape</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>    <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">get_all_certificates</span><span class="p">():</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>        <span class="n">days</span> <span class="o">=</span> <span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">not_after</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span><span class="o">.</span><span class="n">days</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>        <span class="n">expiry_gauge</span><span class="o">.</span><span class="n">labels</span><span class="p">(</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>            <span class="n">hostname</span><span class="o">=</span><span class="n">cert</span><span class="o">.</span><span class="n">hostname</span><span class="p">,</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>            <span class="n">subject</span><span class="o">=</span><span class="n">cert</span><span class="o">.</span><span class="n">subject_cn</span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>        <span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="c1"># Start metrics server</span>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="n">start_http_server</span><span class="p">(</span><span class="mi">8000</span><span class="p">)</span>
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="c1"># Update periodically</span>
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a>    <span class="n">update_metrics</span><span class="p">()</span>
<a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</code></pre></div></p>
<p>Push model (InfluxDB):
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">influxdb_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">InfluxDBClient</span><span class="p">,</span> <span class="n">Point</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">push_metrics</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">InfluxDBClient</span><span class="p">):</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="sd">    Push metrics to time-series database</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>    <span class="n">write_api</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">write_api</span><span class="p">()</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>    <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">get_all_certificates</span><span class="p">():</span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>        <span class="n">point</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s2">&quot;certificate_expiry&quot;</span><span class="p">)</span> \
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>            <span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="s2">&quot;hostname&quot;</span><span class="p">,</span> <span class="n">cert</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span> \
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>            <span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="n">cert</span><span class="o">.</span><span class="n">subject_cn</span><span class="p">)</span> \
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>            <span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;days_until_expiry&quot;</span><span class="p">,</span> <span class="n">cert</span><span class="o">.</span><span class="n">days_until_expiry</span><span class="p">())</span> \
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>            <span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s2">&quot;is_expired&quot;</span><span class="p">,</span> <span class="n">cert</span><span class="o">.</span><span class="n">is_expired</span><span class="p">())</span> \
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a>            <span class="o">.</span><span class="n">time</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">())</span>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>        <span class="n">write_api</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bucket</span><span class="o">=</span><span class="s2">&quot;certificates&quot;</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="n">point</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="synthetic-monitoring">Synthetic Monitoring</h3>
<p><strong>Active TLS checks</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">synthetic_tls_check</span><span class="p">(</span><span class="n">endpoint</span><span class="p">:</span> <span class="n">Endpoint</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CheckResult</span><span class="p">:</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="sd">    Perform synthetic TLS connection and validation</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">CheckResult</span><span class="p">()</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>        <span class="c1"># Create TLS connection</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>        <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>        <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">((</span><span class="n">endpoint</span><span class="o">.</span><span class="n">hostname</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">.</span><span class="n">port</span><span class="p">),</span> 
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>            <span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> 
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>                                    <span class="n">server_hostname</span><span class="o">=</span><span class="n">endpoint</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>                <span class="c1"># Measure handshake time</span>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>                <span class="n">result</span><span class="o">.</span><span class="n">handshake_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>                <span class="c1"># Get certificate</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>                <span class="n">cert_der</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">(</span><span class="n">binary_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a>                <span class="n">cert</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">load_der_x509_certificate</span><span class="p">(</span><span class="n">cert_der</span><span class="p">)</span>
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a>                <span class="c1"># Validate certificate</span>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a>                <span class="n">result</span><span class="o">.</span><span class="n">certificate_valid</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>                <span class="n">result</span><span class="o">.</span><span class="n">expiry_days</span> <span class="o">=</span> <span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">not_valid_after</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span><span class="o">.</span><span class="n">days</span>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a>                <span class="n">result</span><span class="o">.</span><span class="n">subject</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">rfc4514_string</span><span class="p">()</span>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>                <span class="n">result</span><span class="o">.</span><span class="n">issuer</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">issuer</span><span class="o">.</span><span class="n">rfc4514_string</span><span class="p">()</span>
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a>                <span class="c1"># Check protocol version</span>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a>                <span class="n">result</span><span class="o">.</span><span class="n">tls_version</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">version</span><span class="p">()</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a>                <span class="c1"># Check cipher suite</span>
<a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a>                <span class="n">result</span><span class="o">.</span><span class="n">cipher_suite</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">cipher</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a>
<a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a>    <span class="k">except</span> <span class="n">ssl</span><span class="o">.</span><span class="n">SSLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a>        <span class="n">result</span><span class="o">.</span><span class="n">certificate_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a>        <span class="n">result</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SSL Error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a>    <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
<a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a>        <span class="n">result</span><span class="o">.</span><span class="n">certificate_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a>        <span class="n">result</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Connection timeout&quot;</span>
<a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a>        <span class="n">result</span><span class="o">.</span><span class="n">certificate_valid</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-23-42" name="__codelineno-23-42" href="#__codelineno-23-42"></a>        <span class="n">result</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-23-43" name="__codelineno-23-43" href="#__codelineno-23-43"></a>
<a id="__codelineno-23-44" name="__codelineno-23-44" href="#__codelineno-23-44"></a>    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></p>
<p><strong>Certificate validation tests</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CertificateValidationTests</span><span class="p">:</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="sd">    Comprehensive certificate validation test suite</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_expiry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TestResult</span><span class="p">:</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify certificate is not expired or expiring soon&quot;&quot;&quot;</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>        <span class="n">days</span> <span class="o">=</span> <span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">not_after</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span><span class="o">.</span><span class="n">days</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>        <span class="k">if</span> <span class="n">days</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>            <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>                            <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Certificate expired </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">days</span><span class="p">)</span><span class="si">}</span><span class="s2"> days ago&quot;</span><span class="p">)</span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>        <span class="k">elif</span> <span class="n">days</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>            <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>                            <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Certificate expires in </span><span class="si">{</span><span class="n">days</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">,</span>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>                            <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;warning&#39;</span><span class="p">)</span>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>            <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>                            <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Certificate valid for </span><span class="si">{</span><span class="n">days</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_trust_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TestResult</span><span class="p">:</span>
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify complete trust chain to known root&quot;&quot;&quot;</span>
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>            <span class="n">chain</span> <span class="o">=</span> <span class="n">build_certificate_chain</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>            <span class="k">if</span> <span class="n">validate_chain_to_roots</span><span class="p">(</span><span class="n">chain</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">trusted_roots</span><span class="p">):</span>
<a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a>                <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
<a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a>                                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Valid trust chain&quot;</span><span class="p">)</span>
<a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a>                <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a>                                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Chain does not terminate in trusted root&quot;</span><span class="p">)</span>
<a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a>            <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a>                            <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Chain validation failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a>
<a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_revocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TestResult</span><span class="p">:</span>
<a id="__codelineno-24-36" name="__codelineno-24-36" href="#__codelineno-24-36"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check certificate revocation status&quot;&quot;&quot;</span>
<a id="__codelineno-24-37" name="__codelineno-24-37" href="#__codelineno-24-37"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-24-38" name="__codelineno-24-38" href="#__codelineno-24-38"></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">check_revocation_status</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-24-39" name="__codelineno-24-39" href="#__codelineno-24-39"></a>            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;good&#39;</span><span class="p">:</span>
<a id="__codelineno-24-40" name="__codelineno-24-40" href="#__codelineno-24-40"></a>                <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
<a id="__codelineno-24-41" name="__codelineno-24-41" href="#__codelineno-24-41"></a>                                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Certificate not revoked&quot;</span><span class="p">)</span>
<a id="__codelineno-24-42" name="__codelineno-24-42" href="#__codelineno-24-42"></a>            <span class="k">elif</span> <span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;revoked&#39;</span><span class="p">:</span>
<a id="__codelineno-24-43" name="__codelineno-24-43" href="#__codelineno-24-43"></a>                <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-24-44" name="__codelineno-24-44" href="#__codelineno-24-44"></a>                                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Certificate is revoked&quot;</span><span class="p">)</span>
<a id="__codelineno-24-45" name="__codelineno-24-45" href="#__codelineno-24-45"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-24-46" name="__codelineno-24-46" href="#__codelineno-24-46"></a>                <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-24-47" name="__codelineno-24-47" href="#__codelineno-24-47"></a>                                <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Revocation check failed: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-24-48" name="__codelineno-24-48" href="#__codelineno-24-48"></a>                                <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;warning&#39;</span><span class="p">)</span>
<a id="__codelineno-24-49" name="__codelineno-24-49" href="#__codelineno-24-49"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-24-50" name="__codelineno-24-50" href="#__codelineno-24-50"></a>            <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-24-51" name="__codelineno-24-51" href="#__codelineno-24-51"></a>                            <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Revocation check error: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-24-52" name="__codelineno-24-52" href="#__codelineno-24-52"></a>                            <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;warning&#39;</span><span class="p">)</span>
<a id="__codelineno-24-53" name="__codelineno-24-53" href="#__codelineno-24-53"></a>
<a id="__codelineno-24-54" name="__codelineno-24-54" href="#__codelineno-24-54"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_hostname_match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">,</span> 
<a id="__codelineno-24-55" name="__codelineno-24-55" href="#__codelineno-24-55"></a>                           <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TestResult</span><span class="p">:</span>
<a id="__codelineno-24-56" name="__codelineno-24-56" href="#__codelineno-24-56"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify certificate matches requested hostname&quot;&quot;&quot;</span>
<a id="__codelineno-24-57" name="__codelineno-24-57" href="#__codelineno-24-57"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hostname_matches_cert</span><span class="p">(</span><span class="n">hostname</span><span class="p">,</span> <span class="n">cert</span><span class="p">):</span>
<a id="__codelineno-24-58" name="__codelineno-24-58" href="#__codelineno-24-58"></a>            <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
<a id="__codelineno-24-59" name="__codelineno-24-59" href="#__codelineno-24-59"></a>                            <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Hostname </span><span class="si">{</span><span class="n">hostname</span><span class="si">}</span><span class="s2"> matches certificate&quot;</span><span class="p">)</span>
<a id="__codelineno-24-60" name="__codelineno-24-60" href="#__codelineno-24-60"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-24-61" name="__codelineno-24-61" href="#__codelineno-24-61"></a>            <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-24-62" name="__codelineno-24-62" href="#__codelineno-24-62"></a>                            <span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Hostname </span><span class="si">{</span><span class="n">hostname</span><span class="si">}</span><span class="s2"> does not match certificate&quot;</span><span class="p">)</span>
<a id="__codelineno-24-63" name="__codelineno-24-63" href="#__codelineno-24-63"></a>
<a id="__codelineno-24-64" name="__codelineno-24-64" href="#__codelineno-24-64"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_cryptographic_strength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TestResult</span><span class="p">:</span>
<a id="__codelineno-24-65" name="__codelineno-24-65" href="#__codelineno-24-65"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify cryptographic parameters meet requirements&quot;&quot;&quot;</span>
<a id="__codelineno-24-66" name="__codelineno-24-66" href="#__codelineno-24-66"></a>        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-24-67" name="__codelineno-24-67" href="#__codelineno-24-67"></a>
<a id="__codelineno-24-68" name="__codelineno-24-68" href="#__codelineno-24-68"></a>        <span class="c1"># Key size</span>
<a id="__codelineno-24-69" name="__codelineno-24-69" href="#__codelineno-24-69"></a>        <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_algorithm</span> <span class="o">==</span> <span class="s1">&#39;RSA&#39;</span> <span class="ow">and</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_size</span> <span class="o">&lt;</span> <span class="mi">2048</span><span class="p">:</span>
<a id="__codelineno-24-70" name="__codelineno-24-70" href="#__codelineno-24-70"></a>            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RSA key size </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">key_size</span><span class="si">}</span><span class="s2"> below minimum 2048&quot;</span><span class="p">)</span>
<a id="__codelineno-24-71" name="__codelineno-24-71" href="#__codelineno-24-71"></a>        <span class="k">elif</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_algorithm</span> <span class="o">==</span> <span class="s1">&#39;ECDSA&#39;</span> <span class="ow">and</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_size</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">:</span>
<a id="__codelineno-24-72" name="__codelineno-24-72" href="#__codelineno-24-72"></a>            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ECDSA key size </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">key_size</span><span class="si">}</span><span class="s2"> below minimum 256&quot;</span><span class="p">)</span>
<a id="__codelineno-24-73" name="__codelineno-24-73" href="#__codelineno-24-73"></a>
<a id="__codelineno-24-74" name="__codelineno-24-74" href="#__codelineno-24-74"></a>        <span class="c1"># Signature algorithm</span>
<a id="__codelineno-24-75" name="__codelineno-24-75" href="#__codelineno-24-75"></a>        <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">signature_algorithm</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sha1&#39;</span><span class="p">,</span> <span class="s1">&#39;md5&#39;</span><span class="p">]:</span>
<a id="__codelineno-24-76" name="__codelineno-24-76" href="#__codelineno-24-76"></a>            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Weak signature algorithm: </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">signature_algorithm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-24-77" name="__codelineno-24-77" href="#__codelineno-24-77"></a>
<a id="__codelineno-24-78" name="__codelineno-24-78" href="#__codelineno-24-78"></a>        <span class="k">if</span> <span class="n">issues</span><span class="p">:</span>
<a id="__codelineno-24-79" name="__codelineno-24-79" href="#__codelineno-24-79"></a>            <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
<a id="__codelineno-24-80" name="__codelineno-24-80" href="#__codelineno-24-80"></a>                            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">issues</span><span class="p">))</span>
<a id="__codelineno-24-81" name="__codelineno-24-81" href="#__codelineno-24-81"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-24-82" name="__codelineno-24-82" href="#__codelineno-24-82"></a>            <span class="k">return</span> <span class="n">TestResult</span><span class="p">(</span><span class="n">passed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
<a id="__codelineno-24-83" name="__codelineno-24-83" href="#__codelineno-24-83"></a>                            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Cryptographic strength adequate&quot;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="dashboards-and-visualization">Dashboards and Visualization</h3>
<p><strong>Executive dashboard</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nt">dashboard</span><span class="p">:</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Certificate</span><span class="nv"> </span><span class="s">Estate</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Executive</span><span class="nv"> </span><span class="s">View&quot;</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">  </span><span class="nt">refresh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5m</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">  </span><span class="nt">panels</span><span class="p">:</span>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Certificate</span><span class="nv"> </span><span class="s">Health</span><span class="nv"> </span><span class="s">Score&quot;</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gauge</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">      </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;certificate_health_score_overall&quot;</span>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="w">      </span><span class="nt">thresholds</span><span class="p">:</span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">90</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="w">          </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">green</span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">75</span>
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="w">          </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yellow</span>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="w">          </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">red</span>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Certificates</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Expiry</span><span class="nv"> </span><span class="s">Timeline&quot;</span>
<a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bar_chart</span>
<a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="w">      </span><span class="nt">queries</span><span class="p">:</span>
<a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Expired&quot;</span>
<a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates{expiry_days</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">0})&quot;</span>
<a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a><span class="w">          </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">red</span>
<a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;</span><span class="nv"> </span><span class="s">7</span><span class="nv"> </span><span class="s">days&quot;</span>
<a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates{expiry_days</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">7</span><span class="nv"> </span><span class="s">AND</span><span class="nv"> </span><span class="s">expiry_days</span><span class="nv"> </span><span class="s">&gt;=</span><span class="nv"> </span><span class="s">0})&quot;</span>
<a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a><span class="w">          </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">red</span>
<a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;7-30</span><span class="nv"> </span><span class="s">days&quot;</span>
<a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates{expiry_days</span><span class="nv"> </span><span class="s">&gt;=</span><span class="nv"> </span><span class="s">7</span><span class="nv"> </span><span class="s">AND</span><span class="nv"> </span><span class="s">expiry_days</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">30})&quot;</span>
<a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a><span class="w">          </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">orange</span>
<a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;30-90</span><span class="nv"> </span><span class="s">days&quot;</span>
<a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates{expiry_days</span><span class="nv"> </span><span class="s">&gt;=</span><span class="nv"> </span><span class="s">30</span><span class="nv"> </span><span class="s">AND</span><span class="nv"> </span><span class="s">expiry_days</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">90})&quot;</span>
<a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a><span class="w">          </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yellow</span>
<a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&gt;</span><span class="nv"> </span><span class="s">90</span><span class="nv"> </span><span class="s">days&quot;</span>
<a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates{expiry_days</span><span class="nv"> </span><span class="s">&gt;=</span><span class="nv"> </span><span class="s">90})&quot;</span>
<a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a><span class="w">          </span><span class="nt">color</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">green</span>
<a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a>
<a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Top</span><span class="nv"> </span><span class="s">10</span><span class="nv"> </span><span class="s">Teams</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">At-Risk</span><span class="nv"> </span><span class="s">Certificates&quot;</span>
<a id="__codelineno-25-37" name="__codelineno-25-37" href="#__codelineno-25-37"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">table</span>
<a id="__codelineno-25-38" name="__codelineno-25-38" href="#__codelineno-25-38"></a><span class="w">      </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-25-39" name="__codelineno-25-39" href="#__codelineno-25-39"></a><span class="w">        </span><span class="no">topk(10, </span>
<a id="__codelineno-25-40" name="__codelineno-25-40" href="#__codelineno-25-40"></a><span class="w">          </span><span class="no">sum by (owner_team) (</span>
<a id="__codelineno-25-41" name="__codelineno-25-41" href="#__codelineno-25-41"></a><span class="w">            </span><span class="no">certificates{expiry_days &lt; 30}</span>
<a id="__codelineno-25-42" name="__codelineno-25-42" href="#__codelineno-25-42"></a><span class="w">          </span><span class="no">)</span>
<a id="__codelineno-25-43" name="__codelineno-25-43" href="#__codelineno-25-43"></a><span class="w">        </span><span class="no">)</span>
<a id="__codelineno-25-44" name="__codelineno-25-44" href="#__codelineno-25-44"></a>
<a id="__codelineno-25-45" name="__codelineno-25-45" href="#__codelineno-25-45"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Certificate</span><span class="nv"> </span><span class="s">Issuance</span><span class="nv"> </span><span class="s">Trend&quot;</span>
<a id="__codelineno-25-46" name="__codelineno-25-46" href="#__codelineno-25-46"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">time_series</span>
<a id="__codelineno-25-47" name="__codelineno-25-47" href="#__codelineno-25-47"></a><span class="w">      </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;rate(certificates_issued_total[7d])&quot;</span>
<a id="__codelineno-25-48" name="__codelineno-25-48" href="#__codelineno-25-48"></a>
<a id="__codelineno-25-49" name="__codelineno-25-49" href="#__codelineno-25-49"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Critical</span><span class="nv"> </span><span class="s">Issues&quot;</span>
<a id="__codelineno-25-50" name="__codelineno-25-50" href="#__codelineno-25-50"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stat</span>
<a id="__codelineno-25-51" name="__codelineno-25-51" href="#__codelineno-25-51"></a><span class="w">      </span><span class="nt">queries</span><span class="p">:</span>
<a id="__codelineno-25-52" name="__codelineno-25-52" href="#__codelineno-25-52"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Expired&quot;</span>
<a id="__codelineno-25-53" name="__codelineno-25-53" href="#__codelineno-25-53"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates_expired)&quot;</span>
<a id="__codelineno-25-54" name="__codelineno-25-54" href="#__codelineno-25-54"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Weak</span><span class="nv"> </span><span class="s">Crypto&quot;</span>
<a id="__codelineno-25-55" name="__codelineno-25-55" href="#__codelineno-25-55"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates_weak_crypto)&quot;</span>
<a id="__codelineno-25-56" name="__codelineno-25-56" href="#__codelineno-25-56"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Policy</span><span class="nv"> </span><span class="s">Violations&quot;</span>
<a id="__codelineno-25-57" name="__codelineno-25-57" href="#__codelineno-25-57"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates_policy_violation)&quot;</span>
</code></pre></div></p>
<p><strong>Operational dashboard</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nt">dashboard</span><span class="p">:</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Certificate</span><span class="nv"> </span><span class="s">Operations&quot;</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">  </span><span class="nt">refresh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1m</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">  </span><span class="nt">panels</span><span class="p">:</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Validation</span><span class="nv"> </span><span class="s">Failures</span><span class="nv"> </span><span class="s">(Last</span><span class="nv"> </span><span class="s">Hour)&quot;</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">time_series</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="w">      </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sum(rate(certificate_validation_failures_total[5m]))&quot;</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CA</span><span class="nv"> </span><span class="s">Health</span><span class="nv"> </span><span class="s">Status&quot;</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status_panel</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="w">      </span><span class="nt">queries</span><span class="p">:</span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Production</span><span class="nv"> </span><span class="s">CA&quot;</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ca_health_status{ca=&#39;prod&#39;}&quot;</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DR</span><span class="nv"> </span><span class="s">CA&quot;</span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ca_health_status{ca=&#39;dr&#39;}&quot;</span>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;OCSP</span><span class="nv"> </span><span class="s">Responder&quot;</span>
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ocsp_health_status&quot;</span>
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a>
<a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Certificate</span><span class="nv"> </span><span class="s">Operations</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Type&quot;</span>
<a id="__codelineno-26-21" name="__codelineno-26-21" href="#__codelineno-26-21"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pie_chart</span>
<a id="__codelineno-26-22" name="__codelineno-26-22" href="#__codelineno-26-22"></a><span class="w">      </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-26-23" name="__codelineno-26-23" href="#__codelineno-26-23"></a><span class="w">        </span><span class="no">sum by (operation_type) (</span>
<a id="__codelineno-26-24" name="__codelineno-26-24" href="#__codelineno-26-24"></a><span class="w">          </span><span class="no">rate(certificate_operations_total[1h])</span>
<a id="__codelineno-26-25" name="__codelineno-26-25" href="#__codelineno-26-25"></a><span class="w">        </span><span class="no">)</span>
<a id="__codelineno-26-26" name="__codelineno-26-26" href="#__codelineno-26-26"></a>
<a id="__codelineno-26-27" name="__codelineno-26-27" href="#__codelineno-26-27"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Renewal</span><span class="nv"> </span><span class="s">Pipeline</span><span class="nv"> </span><span class="s">Status&quot;</span>
<a id="__codelineno-26-28" name="__codelineno-26-28" href="#__codelineno-26-28"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">funnel</span>
<a id="__codelineno-26-29" name="__codelineno-26-29" href="#__codelineno-26-29"></a><span class="w">      </span><span class="nt">stages</span><span class="p">:</span>
<a id="__codelineno-26-30" name="__codelineno-26-30" href="#__codelineno-26-30"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Renewal</span><span class="nv"> </span><span class="s">Triggered&quot;</span>
<a id="__codelineno-26-31" name="__codelineno-26-31" href="#__codelineno-26-31"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(renewal_status{stage=&#39;triggered&#39;})&quot;</span>
<a id="__codelineno-26-32" name="__codelineno-26-32" href="#__codelineno-26-32"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CSR</span><span class="nv"> </span><span class="s">Generated&quot;</span>
<a id="__codelineno-26-33" name="__codelineno-26-33" href="#__codelineno-26-33"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(renewal_status{stage=&#39;csr_generated&#39;})&quot;</span>
<a id="__codelineno-26-34" name="__codelineno-26-34" href="#__codelineno-26-34"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Certificate</span><span class="nv"> </span><span class="s">Issued&quot;</span>
<a id="__codelineno-26-35" name="__codelineno-26-35" href="#__codelineno-26-35"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(renewal_status{stage=&#39;issued&#39;})&quot;</span>
<a id="__codelineno-26-36" name="__codelineno-26-36" href="#__codelineno-26-36"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Deployed&quot;</span>
<a id="__codelineno-26-37" name="__codelineno-26-37" href="#__codelineno-26-37"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(renewal_status{stage=&#39;deployed&#39;})&quot;</span>
<a id="__codelineno-26-38" name="__codelineno-26-38" href="#__codelineno-26-38"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Verified&quot;</span>
<a id="__codelineno-26-39" name="__codelineno-26-39" href="#__codelineno-26-39"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(renewal_status{stage=&#39;verified&#39;})&quot;</span>
<a id="__codelineno-26-40" name="__codelineno-26-40" href="#__codelineno-26-40"></a>
<a id="__codelineno-26-41" name="__codelineno-26-41" href="#__codelineno-26-41"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Deployment</span><span class="nv"> </span><span class="s">Failures&quot;</span>
<a id="__codelineno-26-42" name="__codelineno-26-42" href="#__codelineno-26-42"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">table</span>
<a id="__codelineno-26-43" name="__codelineno-26-43" href="#__codelineno-26-43"></a><span class="w">      </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-26-44" name="__codelineno-26-44" href="#__codelineno-26-44"></a><span class="w">        </span><span class="no">topk(20,</span>
<a id="__codelineno-26-45" name="__codelineno-26-45" href="#__codelineno-26-45"></a><span class="w">          </span><span class="no">certificate_deployment_failures_total</span>
<a id="__codelineno-26-46" name="__codelineno-26-46" href="#__codelineno-26-46"></a><span class="w">        </span><span class="no">) by (hostname, error_type)</span>
</code></pre></div></p>
<p><strong>Security dashboard</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nt">dashboard</span><span class="p">:</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;PKI</span><span class="nv"> </span><span class="s">Security</span><span class="nv"> </span><span class="s">Monitoring&quot;</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">  </span><span class="nt">refresh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5m</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">  </span><span class="nt">panels</span><span class="p">:</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Cryptographic</span><span class="nv"> </span><span class="s">Algorithm</span><span class="nv"> </span><span class="s">Distribution&quot;</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stacked_bar</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">      </span><span class="nt">queries</span><span class="p">:</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;RSA</span><span class="nv"> </span><span class="s">4096&quot;</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates{key_algorithm=&#39;RSA&#39;,</span><span class="nv"> </span><span class="s">key_size=&#39;4096&#39;})&quot;</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;RSA</span><span class="nv"> </span><span class="s">3072&quot;</span>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates{key_algorithm=&#39;RSA&#39;,</span><span class="nv"> </span><span class="s">key_size=&#39;3072&#39;})&quot;</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;RSA</span><span class="nv"> </span><span class="s">2048&quot;</span>
<a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates{key_algorithm=&#39;RSA&#39;,</span><span class="nv"> </span><span class="s">key_size=&#39;2048&#39;})&quot;</span>
<a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ECDSA</span><span class="nv"> </span><span class="s">P-384&quot;</span>
<a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates{key_algorithm=&#39;ECDSA&#39;,</span><span class="nv"> </span><span class="s">key_size=&#39;384&#39;})&quot;</span>
<a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ECDSA</span><span class="nv"> </span><span class="s">P-256&quot;</span>
<a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates{key_algorithm=&#39;ECDSA&#39;,</span><span class="nv"> </span><span class="s">key_size=&#39;256&#39;})&quot;</span>
<a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Weak&quot;</span>
<a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="w">          </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;count(certificates{key_size</span><span class="nv"> </span><span class="s">&lt;</span><span class="nv"> </span><span class="s">2048})&quot;</span>
<a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a>
<a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Unauthorized</span><span class="nv"> </span><span class="s">CA</span><span class="nv"> </span><span class="s">Detection&quot;</span>
<a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alert_list</span>
<a id="__codelineno-27-24" name="__codelineno-27-24" href="#__codelineno-27-24"></a><span class="w">      </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;certificates{issuer_ca</span><span class="nv"> </span><span class="s">NOT</span><span class="nv"> </span><span class="s">IN</span><span class="nv"> </span><span class="s">approved_ca_list}&quot;</span>
<a id="__codelineno-27-25" name="__codelineno-27-25" href="#__codelineno-27-25"></a>
<a id="__codelineno-27-26" name="__codelineno-27-26" href="#__codelineno-27-26"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Self-Signed</span><span class="nv"> </span><span class="s">Certificates</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Environment&quot;</span>
<a id="__codelineno-27-27" name="__codelineno-27-27" href="#__codelineno-27-27"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bar_chart</span>
<a id="__codelineno-27-28" name="__codelineno-27-28" href="#__codelineno-27-28"></a><span class="w">      </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-27-29" name="__codelineno-27-29" href="#__codelineno-27-29"></a><span class="w">        </span><span class="no">sum by (environment) (</span>
<a id="__codelineno-27-30" name="__codelineno-27-30" href="#__codelineno-27-30"></a><span class="w">          </span><span class="no">certificates{is_self_signed=&#39;true&#39;}</span>
<a id="__codelineno-27-31" name="__codelineno-27-31" href="#__codelineno-27-31"></a><span class="w">        </span><span class="no">)</span>
<a id="__codelineno-27-32" name="__codelineno-27-32" href="#__codelineno-27-32"></a>
<a id="__codelineno-27-33" name="__codelineno-27-33" href="#__codelineno-27-33"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Certificate</span><span class="nv"> </span><span class="s">Transparency</span><span class="nv"> </span><span class="s">Log</span><span class="nv"> </span><span class="s">Monitoring&quot;</span>
<a id="__codelineno-27-34" name="__codelineno-27-34" href="#__codelineno-27-34"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">time_series</span>
<a id="__codelineno-27-35" name="__codelineno-27-35" href="#__codelineno-27-35"></a><span class="w">      </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;rate(ct_log_entries_total{domain=~&#39;.*.example.com&#39;}[1h])&quot;</span>
<a id="__codelineno-27-36" name="__codelineno-27-36" href="#__codelineno-27-36"></a><span class="w">      </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Unexpected</span><span class="nv"> </span><span class="s">CT</span><span class="nv"> </span><span class="s">log</span><span class="nv"> </span><span class="s">activity&quot;</span>
</code></pre></div></p>
<h2 id="advanced-monitoring-patterns">Advanced Monitoring Patterns</h2>
<h3 id="anomaly-detection">Anomaly Detection</h3>
<p><strong>Machine learning for pattern detection</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">IsolationForest</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">AnomalyDetector</span><span class="p">:</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">IsolationForest</span><span class="p">(</span><span class="n">contamination</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">historical_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="sd">        Train anomaly detection model on historical certificate behavior</span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">historical_data</span><span class="p">)</span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">detect_anomalies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Anomaly</span><span class="p">]:</span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="sd">        Detect anomalous certificate patterns</span>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_trained</span><span class="p">:</span>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model must be trained first&quot;</span><span class="p">)</span>
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a>
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a>        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">current_data</span><span class="p">)</span>
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a>
<a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a>        <span class="n">anomalies</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">predictions</span><span class="p">):</span>
<a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a>            <span class="k">if</span> <span class="n">prediction</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  <span class="c1"># Anomaly detected</span>
<a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a>                <span class="n">anomalies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Anomaly</span><span class="p">(</span>
<a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a>                    <span class="n">certificate</span><span class="o">=</span><span class="n">current_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s1">&#39;certificate_id&#39;</span><span class="p">],</span>
<a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a>                    <span class="n">anomaly_score</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">score_samples</span><span class="p">([</span><span class="n">features</span><span class="p">[</span><span class="n">idx</span><span class="p">]])[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a>                    <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
<a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a>                    <span class="n">explanation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">explain_anomaly</span><span class="p">(</span><span class="n">current_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
<a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a>                <span class="p">))</span>
<a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a>
<a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a>        <span class="k">return</span> <span class="n">anomalies</span>
<a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a>
<a id="__codelineno-28-38" name="__codelineno-28-38" href="#__codelineno-28-38"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-28-39" name="__codelineno-28-39" href="#__codelineno-28-39"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-28-40" name="__codelineno-28-40" href="#__codelineno-28-40"></a><span class="sd">        Extract relevant features for anomaly detection</span>
<a id="__codelineno-28-41" name="__codelineno-28-41" href="#__codelineno-28-41"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-28-42" name="__codelineno-28-42" href="#__codelineno-28-42"></a>        <span class="k">return</span> <span class="n">data</span><span class="p">[[</span>
<a id="__codelineno-28-43" name="__codelineno-28-43" href="#__codelineno-28-43"></a>            <span class="s1">&#39;validity_period_days&#39;</span><span class="p">,</span>
<a id="__codelineno-28-44" name="__codelineno-28-44" href="#__codelineno-28-44"></a>            <span class="s1">&#39;issuance_rate&#39;</span><span class="p">,</span>
<a id="__codelineno-28-45" name="__codelineno-28-45" href="#__codelineno-28-45"></a>            <span class="s1">&#39;deployment_lag_hours&#39;</span><span class="p">,</span>
<a id="__codelineno-28-46" name="__codelineno-28-46" href="#__codelineno-28-46"></a>            <span class="s1">&#39;number_of_sans&#39;</span><span class="p">,</span>
<a id="__codelineno-28-47" name="__codelineno-28-47" href="#__codelineno-28-47"></a>            <span class="s1">&#39;key_size&#39;</span><span class="p">,</span>
<a id="__codelineno-28-48" name="__codelineno-28-48" href="#__codelineno-28-48"></a>            <span class="s1">&#39;time_since_last_renewal_days&#39;</span>
<a id="__codelineno-28-49" name="__codelineno-28-49" href="#__codelineno-28-49"></a>        <span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</code></pre></div></p>
<p><strong>Behavioral baselines</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">BehavioralBaseline</span><span class="p">:</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="sd">    Establish and monitor baselines for certificate operations</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lookback_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">):</span>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lookback_days</span> <span class="o">=</span> <span class="n">lookback_days</span>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_baseline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Baseline</span><span class="p">:</span>
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="sd">        Calculate baseline statistics for a metric</span>
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>        <span class="n">historical_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_historical_data</span><span class="p">(</span>
<a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a>            <span class="n">metric</span><span class="p">,</span> 
<a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a>            <span class="n">days</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lookback_days</span>
<a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a>        <span class="p">)</span>
<a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>
<a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a>        <span class="k">return</span> <span class="n">Baseline</span><span class="p">(</span>
<a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a>            <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a>            <span class="n">mean</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">historical_data</span><span class="p">),</span>
<a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a>            <span class="n">std</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">historical_data</span><span class="p">),</span>
<a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a>            <span class="n">p50</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">historical_data</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
<a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a>            <span class="n">p95</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">historical_data</span><span class="p">,</span> <span class="mi">95</span><span class="p">),</span>
<a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a>            <span class="n">p99</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">historical_data</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
<a id="__codelineno-29-25" name="__codelineno-29-25" href="#__codelineno-29-25"></a>        <span class="p">)</span>
<a id="__codelineno-29-26" name="__codelineno-29-26" href="#__codelineno-29-26"></a>
<a id="__codelineno-29-27" name="__codelineno-29-27" href="#__codelineno-29-27"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">detect_deviation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> 
<a id="__codelineno-29-28" name="__codelineno-29-28" href="#__codelineno-29-28"></a>                        <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Deviation</span><span class="p">]:</span>
<a id="__codelineno-29-29" name="__codelineno-29-29" href="#__codelineno-29-29"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-29-30" name="__codelineno-29-30" href="#__codelineno-29-30"></a><span class="sd">        Detect if current value deviates significantly from baseline</span>
<a id="__codelineno-29-31" name="__codelineno-29-31" href="#__codelineno-29-31"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-29-32" name="__codelineno-29-32" href="#__codelineno-29-32"></a>        <span class="n">baseline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_baseline</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>
<a id="__codelineno-29-33" name="__codelineno-29-33" href="#__codelineno-29-33"></a>
<a id="__codelineno-29-34" name="__codelineno-29-34" href="#__codelineno-29-34"></a>        <span class="c1"># Z-score calculation</span>
<a id="__codelineno-29-35" name="__codelineno-29-35" href="#__codelineno-29-35"></a>        <span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_value</span> <span class="o">-</span> <span class="n">baseline</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">baseline</span><span class="o">.</span><span class="n">std</span>
<a id="__codelineno-29-36" name="__codelineno-29-36" href="#__codelineno-29-36"></a>
<a id="__codelineno-29-37" name="__codelineno-29-37" href="#__codelineno-29-37"></a>        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_score</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># 3 sigma deviation</span>
<a id="__codelineno-29-38" name="__codelineno-29-38" href="#__codelineno-29-38"></a>            <span class="k">return</span> <span class="n">Deviation</span><span class="p">(</span>
<a id="__codelineno-29-39" name="__codelineno-29-39" href="#__codelineno-29-39"></a>                <span class="n">metric</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span>
<a id="__codelineno-29-40" name="__codelineno-29-40" href="#__codelineno-29-40"></a>                <span class="n">current_value</span><span class="o">=</span><span class="n">current_value</span><span class="p">,</span>
<a id="__codelineno-29-41" name="__codelineno-29-41" href="#__codelineno-29-41"></a>                <span class="n">baseline_mean</span><span class="o">=</span><span class="n">baseline</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
<a id="__codelineno-29-42" name="__codelineno-29-42" href="#__codelineno-29-42"></a>                <span class="n">z_score</span><span class="o">=</span><span class="n">z_score</span><span class="p">,</span>
<a id="__codelineno-29-43" name="__codelineno-29-43" href="#__codelineno-29-43"></a>                <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;high&#39;</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z_score</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="k">else</span> <span class="s1">&#39;medium&#39;</span>
<a id="__codelineno-29-44" name="__codelineno-29-44" href="#__codelineno-29-44"></a>            <span class="p">)</span>
<a id="__codelineno-29-45" name="__codelineno-29-45" href="#__codelineno-29-45"></a>
<a id="__codelineno-29-46" name="__codelineno-29-46" href="#__codelineno-29-46"></a>        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></p>
<h3 id="predictive-monitoring">Predictive Monitoring</h3>
<p><strong>Forecast certificate demands</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.holtwinters</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">CertificateDemandForecaster</span><span class="p">:</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="sd">    Forecast future certificate issuance and renewal demands</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forecast_issuance_demand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>                                <span class="n">days_ahead</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="sd">        Forecast certificate issuance demand</span>
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>        <span class="c1"># Get historical issuance data</span>
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>        <span class="n">historical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_daily_issuance_history</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">)</span>
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>        <span class="c1"># Fit model</span>
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span>
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a>            <span class="n">historical</span><span class="p">,</span>
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a>            <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>  <span class="c1"># Weekly seasonality</span>
<a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a>            <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span>
<a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a>            <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;add&#39;</span>
<a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a>        <span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a>
<a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a>        <span class="c1"># Generate forecast</span>
<a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a>        <span class="n">forecast</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">days_ahead</span><span class="p">)</span>
<a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a>
<a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a>            <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
<a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a>                <span class="n">start</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> 
<a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a>                <span class="n">periods</span><span class="o">=</span><span class="n">days_ahead</span>
<a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a>            <span class="p">),</span>
<a id="__codelineno-30-32" name="__codelineno-30-32" href="#__codelineno-30-32"></a>            <span class="s1">&#39;predicted_issuance&#39;</span><span class="p">:</span> <span class="n">forecast</span><span class="p">,</span>
<a id="__codelineno-30-33" name="__codelineno-30-33" href="#__codelineno-30-33"></a>            <span class="s1">&#39;lower_bound&#39;</span><span class="p">:</span> <span class="n">forecast</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span>
<a id="__codelineno-30-34" name="__codelineno-30-34" href="#__codelineno-30-34"></a>            <span class="s1">&#39;upper_bound&#39;</span><span class="p">:</span> <span class="n">forecast</span> <span class="o">*</span> <span class="mf">1.2</span>
<a id="__codelineno-30-35" name="__codelineno-30-35" href="#__codelineno-30-35"></a>        <span class="p">})</span>
<a id="__codelineno-30-36" name="__codelineno-30-36" href="#__codelineno-30-36"></a>
<a id="__codelineno-30-37" name="__codelineno-30-37" href="#__codelineno-30-37"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forecast_expiry_wave</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-30-38" name="__codelineno-30-38" href="#__codelineno-30-38"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-30-39" name="__codelineno-30-39" href="#__codelineno-30-39"></a><span class="sd">        Forecast upcoming certificate expiry waves</span>
<a id="__codelineno-30-40" name="__codelineno-30-40" href="#__codelineno-30-40"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-30-41" name="__codelineno-30-41" href="#__codelineno-30-41"></a>        <span class="n">all_certs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_certificates</span><span class="p">()</span>
<a id="__codelineno-30-42" name="__codelineno-30-42" href="#__codelineno-30-42"></a>
<a id="__codelineno-30-43" name="__codelineno-30-43" href="#__codelineno-30-43"></a>        <span class="c1"># Group by expiry date</span>
<a id="__codelineno-30-44" name="__codelineno-30-44" href="#__codelineno-30-44"></a>        <span class="n">expiry_distribution</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
<a id="__codelineno-30-45" name="__codelineno-30-45" href="#__codelineno-30-45"></a>            <span class="p">{</span>
<a id="__codelineno-30-46" name="__codelineno-30-46" href="#__codelineno-30-46"></a>                <span class="s1">&#39;expiry_date&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">not_after</span><span class="o">.</span><span class="n">date</span><span class="p">(),</span>
<a id="__codelineno-30-47" name="__codelineno-30-47" href="#__codelineno-30-47"></a>                <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-30-48" name="__codelineno-30-48" href="#__codelineno-30-48"></a>                <span class="s1">&#39;criticality&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">criticality_score</span>
<a id="__codelineno-30-49" name="__codelineno-30-49" href="#__codelineno-30-49"></a>            <span class="p">}</span>
<a id="__codelineno-30-50" name="__codelineno-30-50" href="#__codelineno-30-50"></a>            <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">all_certs</span>
<a id="__codelineno-30-51" name="__codelineno-30-51" href="#__codelineno-30-51"></a>        <span class="p">])</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;expiry_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
<a id="__codelineno-30-52" name="__codelineno-30-52" href="#__codelineno-30-52"></a>            <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
<a id="__codelineno-30-53" name="__codelineno-30-53" href="#__codelineno-30-53"></a>            <span class="s1">&#39;criticality&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span>
<a id="__codelineno-30-54" name="__codelineno-30-54" href="#__codelineno-30-54"></a>        <span class="p">})</span>
<a id="__codelineno-30-55" name="__codelineno-30-55" href="#__codelineno-30-55"></a>
<a id="__codelineno-30-56" name="__codelineno-30-56" href="#__codelineno-30-56"></a>        <span class="c1"># Identify waves (clusters of expirations)</span>
<a id="__codelineno-30-57" name="__codelineno-30-57" href="#__codelineno-30-57"></a>        <span class="n">expiry_distribution</span><span class="p">[</span><span class="s1">&#39;is_wave&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-30-58" name="__codelineno-30-58" href="#__codelineno-30-58"></a>            <span class="n">expiry_distribution</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span> <span class="o">&gt;</span> 
<a id="__codelineno-30-59" name="__codelineno-30-59" href="#__codelineno-30-59"></a>            <span class="n">expiry_distribution</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">expiry_distribution</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<a id="__codelineno-30-60" name="__codelineno-30-60" href="#__codelineno-30-60"></a>        <span class="p">)</span>
<a id="__codelineno-30-61" name="__codelineno-30-61" href="#__codelineno-30-61"></a>
<a id="__codelineno-30-62" name="__codelineno-30-62" href="#__codelineno-30-62"></a>        <span class="k">return</span> <span class="n">expiry_distribution</span>
</code></pre></div></p>
<h3 id="correlation-analysis">Correlation Analysis</h3>
<p><strong>Certificate incident correlation</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">IncidentCorrelationEngine</span><span class="p">:</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="sd">    Correlate certificate events with incidents and outages</span>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_incident_causes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>                               <span class="n">incident</span><span class="p">:</span> <span class="n">Incident</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CorrelationResult</span><span class="p">:</span>
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="sd">        Analyze if certificate issues contributed to incident</span>
<a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">CorrelationResult</span><span class="p">(</span><span class="n">incident</span><span class="o">=</span><span class="n">incident</span><span class="p">)</span>
<a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>
<a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>        <span class="c1"># Get timeline</span>
<a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>        <span class="n">incident_window</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a>            <span class="n">incident</span><span class="o">.</span><span class="n">start_time</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a>            <span class="n">incident</span><span class="o">.</span><span class="n">end_time</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a>        <span class="p">)</span>
<a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a>
<a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a>        <span class="c1"># Find certificate events in window</span>
<a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a>        <span class="n">cert_events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_certificate_events_in_window</span><span class="p">(</span>
<a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a>            <span class="n">incident_window</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-31-22" name="__codelineno-31-22" href="#__codelineno-31-22"></a>            <span class="n">incident_window</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-31-23" name="__codelineno-31-23" href="#__codelineno-31-23"></a>        <span class="p">)</span>
<a id="__codelineno-31-24" name="__codelineno-31-24" href="#__codelineno-31-24"></a>
<a id="__codelineno-31-25" name="__codelineno-31-25" href="#__codelineno-31-25"></a>        <span class="c1"># Look for correlations</span>
<a id="__codelineno-31-26" name="__codelineno-31-26" href="#__codelineno-31-26"></a>        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">cert_events</span><span class="p">:</span>
<a id="__codelineno-31-27" name="__codelineno-31-27" href="#__codelineno-31-27"></a>            <span class="c1"># Expiry events</span>
<a id="__codelineno-31-28" name="__codelineno-31-28" href="#__codelineno-31-28"></a>            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;expiry&#39;</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">service</span> <span class="o">==</span> <span class="n">incident</span><span class="o">.</span><span class="n">service</span><span class="p">:</span>
<a id="__codelineno-31-29" name="__codelineno-31-29" href="#__codelineno-31-29"></a>                <span class="n">result</span><span class="o">.</span><span class="n">add_correlation</span><span class="p">(</span>
<a id="__codelineno-31-30" name="__codelineno-31-30" href="#__codelineno-31-30"></a>                    <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">,</span>
<a id="__codelineno-31-31" name="__codelineno-31-31" href="#__codelineno-31-31"></a>                    <span class="n">correlation_strength</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
<a id="__codelineno-31-32" name="__codelineno-31-32" href="#__codelineno-31-32"></a>                    <span class="n">explanation</span><span class="o">=</span><span class="s2">&quot;Certificate expired for affected service&quot;</span>
<a id="__codelineno-31-33" name="__codelineno-31-33" href="#__codelineno-31-33"></a>                <span class="p">)</span>
<a id="__codelineno-31-34" name="__codelineno-31-34" href="#__codelineno-31-34"></a>
<a id="__codelineno-31-35" name="__codelineno-31-35" href="#__codelineno-31-35"></a>            <span class="c1"># Validation failures</span>
<a id="__codelineno-31-36" name="__codelineno-31-36" href="#__codelineno-31-36"></a>            <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;validation_failure&#39;</span><span class="p">:</span>
<a id="__codelineno-31-37" name="__codelineno-31-37" href="#__codelineno-31-37"></a>                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">hostname</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">affected_hosts</span><span class="p">:</span>
<a id="__codelineno-31-38" name="__codelineno-31-38" href="#__codelineno-31-38"></a>                    <span class="n">result</span><span class="o">.</span><span class="n">add_correlation</span><span class="p">(</span>
<a id="__codelineno-31-39" name="__codelineno-31-39" href="#__codelineno-31-39"></a>                        <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">,</span>
<a id="__codelineno-31-40" name="__codelineno-31-40" href="#__codelineno-31-40"></a>                        <span class="n">correlation_strength</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
<a id="__codelineno-31-41" name="__codelineno-31-41" href="#__codelineno-31-41"></a>                        <span class="n">explanation</span><span class="o">=</span><span class="s2">&quot;Certificate validation failed on incident hosts&quot;</span>
<a id="__codelineno-31-42" name="__codelineno-31-42" href="#__codelineno-31-42"></a>                    <span class="p">)</span>
<a id="__codelineno-31-43" name="__codelineno-31-43" href="#__codelineno-31-43"></a>
<a id="__codelineno-31-44" name="__codelineno-31-44" href="#__codelineno-31-44"></a>            <span class="c1"># Deployment events</span>
<a id="__codelineno-31-45" name="__codelineno-31-45" href="#__codelineno-31-45"></a>            <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;deployment&#39;</span><span class="p">:</span>
<a id="__codelineno-31-46" name="__codelineno-31-46" href="#__codelineno-31-46"></a>                <span class="k">if</span> <span class="nb">abs</span><span class="p">((</span><span class="n">event</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">-</span> <span class="n">incident</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">:</span>
<a id="__codelineno-31-47" name="__codelineno-31-47" href="#__codelineno-31-47"></a>                    <span class="n">result</span><span class="o">.</span><span class="n">add_correlation</span><span class="p">(</span>
<a id="__codelineno-31-48" name="__codelineno-31-48" href="#__codelineno-31-48"></a>                        <span class="n">event</span><span class="o">=</span><span class="n">event</span><span class="p">,</span>
<a id="__codelineno-31-49" name="__codelineno-31-49" href="#__codelineno-31-49"></a>                        <span class="n">correlation_strength</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
<a id="__codelineno-31-50" name="__codelineno-31-50" href="#__codelineno-31-50"></a>                        <span class="n">explanation</span><span class="o">=</span><span class="s2">&quot;Certificate deployment occurred near incident start&quot;</span>
<a id="__codelineno-31-51" name="__codelineno-31-51" href="#__codelineno-31-51"></a>                    <span class="p">)</span>
<a id="__codelineno-31-52" name="__codelineno-31-52" href="#__codelineno-31-52"></a>
<a id="__codelineno-31-53" name="__codelineno-31-53" href="#__codelineno-31-53"></a>        <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-31-54" name="__codelineno-31-54" href="#__codelineno-31-54"></a>
<a id="__codelineno-31-55" name="__codelineno-31-55" href="#__codelineno-31-55"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">find_similar_incidents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_alert</span><span class="p">:</span> <span class="n">Alert</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">HistoricalIncident</span><span class="p">]:</span>
<a id="__codelineno-31-56" name="__codelineno-31-56" href="#__codelineno-31-56"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-31-57" name="__codelineno-31-57" href="#__codelineno-31-57"></a><span class="sd">        Find historical incidents similar to current alert</span>
<a id="__codelineno-31-58" name="__codelineno-31-58" href="#__codelineno-31-58"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-31-59" name="__codelineno-31-59" href="#__codelineno-31-59"></a>        <span class="c1"># Extract features from current alert</span>
<a id="__codelineno-31-60" name="__codelineno-31-60" href="#__codelineno-31-60"></a>        <span class="n">current_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_incident_features</span><span class="p">(</span><span class="n">current_alert</span><span class="p">)</span>
<a id="__codelineno-31-61" name="__codelineno-31-61" href="#__codelineno-31-61"></a>
<a id="__codelineno-31-62" name="__codelineno-31-62" href="#__codelineno-31-62"></a>        <span class="c1"># Find similar past incidents</span>
<a id="__codelineno-31-63" name="__codelineno-31-63" href="#__codelineno-31-63"></a>        <span class="n">historical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_historical_incidents</span><span class="p">()</span>
<a id="__codelineno-31-64" name="__codelineno-31-64" href="#__codelineno-31-64"></a>        <span class="n">similarities</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-31-65" name="__codelineno-31-65" href="#__codelineno-31-65"></a>
<a id="__codelineno-31-66" name="__codelineno-31-66" href="#__codelineno-31-66"></a>        <span class="k">for</span> <span class="n">past_incident</span> <span class="ow">in</span> <span class="n">historical</span><span class="p">:</span>
<a id="__codelineno-31-67" name="__codelineno-31-67" href="#__codelineno-31-67"></a>            <span class="n">past_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_incident_features</span><span class="p">(</span><span class="n">past_incident</span><span class="p">)</span>
<a id="__codelineno-31-68" name="__codelineno-31-68" href="#__codelineno-31-68"></a>            <span class="n">similarity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_similarity</span><span class="p">(</span><span class="n">current_features</span><span class="p">,</span> <span class="n">past_features</span><span class="p">)</span>
<a id="__codelineno-31-69" name="__codelineno-31-69" href="#__codelineno-31-69"></a>
<a id="__codelineno-31-70" name="__codelineno-31-70" href="#__codelineno-31-70"></a>            <span class="k">if</span> <span class="n">similarity</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">:</span>
<a id="__codelineno-31-71" name="__codelineno-31-71" href="#__codelineno-31-71"></a>                <span class="n">similarities</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">past_incident</span><span class="p">,</span> <span class="n">similarity</span><span class="p">))</span>
<a id="__codelineno-31-72" name="__codelineno-31-72" href="#__codelineno-31-72"></a>
<a id="__codelineno-31-73" name="__codelineno-31-73" href="#__codelineno-31-73"></a>        <span class="c1"># Sort by similarity and return top matches</span>
<a id="__codelineno-31-74" name="__codelineno-31-74" href="#__codelineno-31-74"></a>        <span class="n">similarities</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-31-75" name="__codelineno-31-75" href="#__codelineno-31-75"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">incident</span> <span class="k">for</span> <span class="n">incident</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">similarities</span><span class="p">[:</span><span class="mi">5</span><span class="p">]]</span>
</code></pre></div></p>
<h2 id="best-practices">Best Practices</h2>
<h3 id="dos">Do's</h3>
<p><strong>Comprehensive monitoring</strong>:</p>
<ul>
<li>Monitor the entire certificate lifecycle, not just expiry</li>
<li>Track both certificate and CA infrastructure health</li>
<li>Implement synthetic checks for critical services</li>
<li>Correlate certificate events with business metrics</li>
</ul>
<p><strong>Actionable alerts</strong>:</p>
<ul>
<li>Every alert must have a clear response action</li>
<li>Include context and remediation steps in alerts</li>
<li>Route alerts to appropriate teams with escalation</li>
<li>Use severity levels consistently</li>
</ul>
<p><strong>Continuous improvement</strong>:</p>
<ul>
<li>Analyze alert fatigue and false positive rates</li>
<li>Tune thresholds based on historical patterns</li>
<li>Review incident post-mortems for monitoring gaps</li>
<li>Update runbooks based on actual response patterns</li>
</ul>
<h3 id="donts">Don'ts</h3>
<p><strong>Avoid alert fatigue</strong>:</p>
<ul>
<li>Don't alert on everything</li>
<li>Don't use the same severity for all alerts</li>
<li>Don't send alerts without clear ownership</li>
<li>Don't ignore deduplication and throttling</li>
</ul>
<p><strong>Don't neglect maintenance</strong>:</p>
<ul>
<li>Don't let dashboards become stale</li>
<li>Don't ignore monitoring system health</li>
<li>Don't skip regular review of alert effectiveness</li>
<li>Don't forget to update runbooks</li>
</ul>
<p><strong>Avoid single points of failure</strong>:</p>
<ul>
<li>Don't rely on single monitoring system</li>
<li>Don't monitor only from one location</li>
<li>Don't ignore backup CA monitoring</li>
<li>Don't assume API data is complete</li>
</ul>
<h2 id="integration-with-incident-response">Integration with Incident Response</h2>
<h3 id="automated-remediation">Automated remediation**:</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AutomatedRemediator</span><span class="p">:</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="sd">    Automated remediation for common certificate issues</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">handle_expiring_certificate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">):</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="sd">        Automated response to expiring certificate</span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>        <span class="c1"># Check if auto-renewal is enabled</span>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>        <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">auto_renew_enabled</span><span class="p">:</span>
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Triggering automated renewal for </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">subject_cn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>                <span class="c1"># Initiate renewal workflow</span>
<a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a>                <span class="n">renewal_job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">renewal_system</span><span class="o">.</span><span class="n">create_renewal_job</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a>
<a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a>                <span class="c1"># Monitor renewal progress</span>
<a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">monitor_renewal_job</span><span class="p">(</span><span class="n">renewal_job</span><span class="p">)</span>
<a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a>
<a id="__codelineno-32-21" name="__codelineno-32-21" href="#__codelineno-32-21"></a>                <span class="c1"># If successful, notify stakeholders</span>
<a id="__codelineno-32-22" name="__codelineno-32-22" href="#__codelineno-32-22"></a>                <span class="k">if</span> <span class="n">renewal_job</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;completed&#39;</span><span class="p">:</span>
<a id="__codelineno-32-23" name="__codelineno-32-23" href="#__codelineno-32-23"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">notify_success</span><span class="p">(</span><span class="n">cert</span><span class="p">,</span> <span class="n">renewal_job</span><span class="p">)</span>
<a id="__codelineno-32-24" name="__codelineno-32-24" href="#__codelineno-32-24"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-32-25" name="__codelineno-32-25" href="#__codelineno-32-25"></a>                    <span class="c1"># Escalate if automated renewal fails</span>
<a id="__codelineno-32-26" name="__codelineno-32-26" href="#__codelineno-32-26"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">escalate_renewal_failure</span><span class="p">(</span><span class="n">cert</span><span class="p">,</span> <span class="n">renewal_job</span><span class="p">)</span>
<a id="__codelineno-32-27" name="__codelineno-32-27" href="#__codelineno-32-27"></a>
<a id="__codelineno-32-28" name="__codelineno-32-28" href="#__codelineno-32-28"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-32-29" name="__codelineno-32-29" href="#__codelineno-32-29"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Automated renewal failed: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-32-30" name="__codelineno-32-30" href="#__codelineno-32-30"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">escalate_renewal_failure</span><span class="p">(</span><span class="n">cert</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-32-31" name="__codelineno-32-31" href="#__codelineno-32-31"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-32-32" name="__codelineno-32-32" href="#__codelineno-32-32"></a>            <span class="c1"># Create ticket for manual renewal</span>
<a id="__codelineno-32-33" name="__codelineno-32-33" href="#__codelineno-32-33"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">create_renewal_ticket</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-32-34" name="__codelineno-32-34" href="#__codelineno-32-34"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">notify_owner</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
</code></pre></div>
<h2 id="conclusion">Conclusion</h2>
<p>Effective PKI monitoring transforms certificate management from a reactive, error-prone process to a proactive, predictable capability. By monitoring the complete certificate lifecycle, implementing intelligent alerting with proper context and escalation, and integrating with incident response workflows, organizations can prevent certificate-related outages and maintain high availability.</p>
<p>The investment in comprehensive monitoring infrastructure pays immediate dividends through reduced outages, faster incident response, and improved compliance. Start with basic expiry monitoring, expand to lifecycle coverage, and continuously refine based on operational experience. Remember: what gets monitored gets managed, and what gets measured gets improved.</p>
<h2 id="references">References</h2>
<h3 id="standards-and-specifications">Standards and Specifications</h3>
<ol>
<li>
<p><strong>RFC 6960 - X.509 Internet Public Key Infrastructure Online Certificate Status Protocol (OCSP)</strong><br />
   https://datatracker.ietf.org/doc/html/rfc6960<br />
   Real-time certificate revocation checking in monitoring systems</p>
</li>
<li>
<p><strong>RFC 5280 - Internet X.509 Public Key Infrastructure Certificate and CRL Profile</strong><br />
   https://datatracker.ietf.org/doc/html/rfc5280<br />
   Certificate validation requirements for monitoring</p>
</li>
<li>
<p><strong>RFC 6962 - Certificate Transparency</strong><br />
   https://datatracker.ietf.org/doc/html/rfc6962<br />
   Public certificate logging for monitoring and alerting</p>
</li>
<li>
<p><strong>RFC 8555 - Automatic Certificate Management Environment (ACME)</strong><br />
   https://datatracker.ietf.org/doc/html/rfc8555<br />
   Monitoring automated certificate lifecycle events</p>
</li>
<li>
<p><strong>NIST SP 800-92 - Guide to Computer Security Log Management</strong><br />
   https://csrc.nist.gov/publications/detail/sp/800-92/final<br />
   Log management for certificate monitoring</p>
</li>
</ol>
<h3 id="monitoring-tools-and-platforms">Monitoring Tools and Platforms</h3>
<ol>
<li>
<p><strong>Prometheus - Open Source Monitoring</strong><br />
   https://prometheus.io/docs/introduction/overview/<br />
   Time-series database for certificate metrics</p>
</li>
<li>
<p><strong>Grafana - Visualization and Dashboards</strong><br />
   https://grafana.com/docs/<br />
   Dashboard creation for certificate monitoring</p>
</li>
<li>
<p><strong>Nagios - Infrastructure Monitoring</strong><br />
   https://www.nagios.org/documentation/<br />
   Classic monitoring with certificate check plugins</p>
</li>
<li>
<p><strong>Zabbix - Enterprise Monitoring</strong><br />
   https://www.zabbix.com/documentation/<br />
   Comprehensive infrastructure monitoring including certificates</p>
</li>
<li>
<p><strong>Icinga - Open Source Monitoring</strong><br />
    https://icinga.com/docs/<br />
    Scalable monitoring with certificate checks</p>
</li>
</ol>
<h3 id="certificate-specific-monitoring-tools">Certificate-Specific Monitoring Tools</h3>
<ol>
<li>
<p><strong>cert-checker - Certificate Expiry Monitoring</strong><br />
    https://github.com/timothybasanov/cert-checker<br />
    Lightweight certificate expiration checker</p>
</li>
<li>
<p><strong>x509-certificate-exporter - Prometheus Exporter</strong><br />
    https://github.com/enix/x509-certificate-exporter<br />
    Export certificate metrics to Prometheus</p>
</li>
<li>
<p><strong>ssl-cert-check - Shell Script</strong><br />
    https://github.com/Matty9191/ssl-cert-check<br />
    Command-line certificate expiry monitoring</p>
</li>
<li>
<p><strong>Certwatch - Certificate Monitoring Daemon</strong><br />
    https://linux.die.net/man/1/certwatch<br />
    System daemon for certificate monitoring</p>
</li>
<li>
<p><strong>SSLmate CertSpotter</strong><br />
    https://sslmate.com/certspotter/<br />
    Certificate transparency log monitoring</p>
</li>
</ol>
<h3 id="cloud-provider-monitoring">Cloud Provider Monitoring</h3>
<ol>
<li>
<p><strong>AWS CloudWatch - Certificate Monitoring</strong><br />
    https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/<br />
    Native AWS monitoring for ACM certificates</p>
</li>
<li>
<p><strong>Azure Monitor - Application Insights</strong><br />
    https://learn.microsoft.com/azure/azure-monitor/<br />
    Azure-native certificate and TLS monitoring</p>
</li>
<li>
<p><strong>Google Cloud Monitoring</strong><br />
    https://cloud.google.com/monitoring/docs<br />
    GCP certificate authority and SSL monitoring</p>
</li>
<li>
<p><strong>AWS Certificate Manager Metrics</strong><br />
    https://docs.aws.amazon.com/acm/latest/userguide/cloudwatch-metrics.html<br />
    Native ACM certificate monitoring metrics</p>
</li>
<li>
<p><strong>Azure Key Vault Monitoring</strong><br />
    https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault<br />
    Certificate operations monitoring in Azure</p>
</li>
</ol>
<h3 id="alerting-and-incident-management">Alerting and Incident Management</h3>
<ol>
<li>
<p><strong>PagerDuty - Incident Management Platform</strong><br />
    https://www.pagerduty.com/<br />
    On-call scheduling and alert routing</p>
</li>
<li>
<p><strong>Opsgenie - Alert Management</strong><br />
    https://www.atlassian.com/software/opsgenie<br />
    Alert aggregation and escalation</p>
</li>
<li>
<p><strong>VictorOps (Splunk On-Call)</strong><br />
    https://victorops.com/<br />
    Incident response and on-call management</p>
</li>
<li>
<p><strong>AlertManager - Prometheus Alerting</strong><br />
    https://prometheus.io/docs/alerting/latest/alertmanager/<br />
    Alert routing and deduplication for Prometheus</p>
</li>
<li>
<p><strong>Sentry - Error Tracking</strong><br />
    https://docs.sentry.io/<br />
    Application error monitoring including TLS failures</p>
</li>
</ol>
<h3 id="synthetic-monitoring-and-active-checks">Synthetic Monitoring and Active Checks</h3>
<ol>
<li>
<p><strong>Pingdom - Uptime Monitoring</strong><br />
    https://www.pingdom.com/<br />
    Synthetic checks including certificate validation</p>
</li>
<li>
<p><strong>UptimeRobot - Website Monitoring</strong><br />
    https://uptimerobot.com/<br />
    Free uptime monitoring with SSL checks</p>
</li>
<li>
<p><strong>StatusCake - Performance Monitoring</strong><br />
    https://www.statuscake.com/<br />
    Uptime and certificate monitoring</p>
</li>
<li>
<p><strong>Datadog Synthetic Monitoring</strong><br />
    https://docs.datadoghq.com/synthetics/<br />
    Active certificate validation checks</p>
</li>
<li>
<p><strong>New Relic Synthetic Monitoring</strong><br />
    https://docs.newrelic.com/docs/synthetics/<br />
    Scripted browser and API tests with TLS validation</p>
</li>
</ol>
<h3 id="observability-and-apm-platforms">Observability and APM Platforms</h3>
<ol>
<li>
<p><strong>Datadog - Infrastructure Monitoring</strong><br />
    https://docs.datadoghq.com/<br />
    Full-stack observability including certificates</p>
</li>
<li>
<p><strong>New Relic - Application Performance Monitoring</strong><br />
    https://docs.newrelic.com/<br />
    APM with TLS certificate monitoring</p>
</li>
<li>
<p><strong>Dynatrace - AI-Powered Monitoring</strong><br />
    https://www.dynatrace.com/support/doc/<br />
    Automatic certificate problem detection</p>
</li>
<li>
<p><strong>AppDynamics - Business Monitoring</strong><br />
    https://docs.appdynamics.com/<br />
    Business transaction monitoring including TLS</p>
</li>
<li>
<p><strong>Elastic Observability</strong><br />
    https://www.elastic.co/observability<br />
    Logs, metrics, and APM with certificate tracking</p>
</li>
</ol>
<h3 id="log-aggregation-and-analysis">Log Aggregation and Analysis</h3>
<ol>
<li>
<p><strong>ELK Stack (Elasticsearch, Logstash, Kibana)</strong><br />
    https://www.elastic.co/elastic-stack/<br />
    Log aggregation and analysis for certificate events</p>
</li>
<li>
<p><strong>Splunk - Data Analytics Platform</strong><br />
    https://docs.splunk.com/<br />
    Security information and event management with certificate monitoring</p>
</li>
<li>
<p><strong>Graylog - Log Management</strong><br />
    https://www.graylog.org/documentation/<br />
    Open-source log aggregation for certificate events</p>
</li>
<li>
<p><strong>Fluentd - Log Collector</strong><br />
    https://docs.fluentd.org/<br />
    Unified logging layer for certificate monitoring</p>
</li>
<li>
<p><strong>Loki - Log Aggregation</strong><br />
    https://grafana.com/oss/loki/<br />
    Grafana Labs log aggregation system</p>
</li>
</ol>
<h3 id="network-monitoring-and-protocol-analysis">Network Monitoring and Protocol Analysis</h3>
<ol>
<li>
<p><strong>Wireshark - Protocol Analyzer</strong><br />
    https://www.wireshark.org/docs/<br />
    TLS handshake and certificate inspection</p>
</li>
<li>
<p><strong>tcpdump - Packet Capture</strong><br />
    https://www.tcpdump.org/manpages/tcpdump.1.html<br />
    Command-line packet capture for TLS analysis</p>
</li>
<li>
<p><strong>Zeek (Bro) - Network Security Monitor</strong><br />
    https://docs.zeek.org/<br />
    Protocol analysis including SSL/TLS certificates</p>
</li>
<li>
<p><strong>Suricata - Network IDS</strong><br />
    https://suricata.readthedocs.io/<br />
    Intrusion detection with TLS monitoring</p>
</li>
<li>
<p><strong>Moloch/Arkime - Packet Capture</strong><br />
    https://arkime.com/<br />
    Full packet capture with certificate extraction</p>
</li>
</ol>
<h3 id="security-information-and-event-management-siem">Security Information and Event Management (SIEM)</h3>
<ol>
<li>
<p><strong>Splunk Enterprise Security</strong><br />
    https://docs.splunk.com/Documentation/ES<br />
    SIEM with certificate security monitoring</p>
</li>
<li>
<p><strong>IBM QRadar</strong><br />
    https://www.ibm.com/qradar<br />
    Enterprise SIEM with PKI monitoring</p>
</li>
<li>
<p><strong>Microsoft Sentinel</strong><br />
    https://learn.microsoft.com/azure/sentinel/<br />
    Cloud-native SIEM with certificate threat detection</p>
</li>
<li>
<p><strong>LogRhythm</strong><br />
    https://docs.logrhythm.com/<br />
    SIEM platform with certificate compliance monitoring</p>
</li>
<li>
<p><strong>AlienVault OSSIM</strong><br />
    https://www.alienvault.com/products/ossim<br />
    Open-source SIEM with certificate monitoring</p>
</li>
</ol>
<h3 id="api-and-integration-tools">API and Integration Tools</h3>
<ol>
<li>
<p><strong>Python cryptography Library</strong><br />
    https://cryptography.io/en/latest/<br />
    Certificate validation and monitoring in Python</p>
</li>
<li>
<p><strong>OpenSSL Command-Line Tools</strong><br />
    https://www.openssl.org/docs/<br />
    Certificate inspection and validation utilities</p>
</li>
<li>
<p><strong>curl - Certificate Verification</strong><br />
    https://curl.se/docs/sslcerts.html<br />
    HTTP client with certificate validation</p>
</li>
<li>
<p><strong>Python Requests Library - SSL Verification</strong><br />
    https://requests.readthedocs.io/en/latest/user/advanced/#ssl-cert-verification<br />
    HTTP library with certificate checking</p>
</li>
<li>
<p><strong>Go crypto/tls Package</strong><br />
    https://pkg.go.dev/crypto/tls<br />
    TLS client and certificate validation in Go</p>
</li>
</ol>
<h3 id="compliance-and-audit-frameworks">Compliance and Audit Frameworks</h3>
<ol>
<li>
<p><strong>NIST SP 800-53 Rev. 5 - CA-7: Continuous Monitoring</strong><br />
    https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final<br />
    Continuous monitoring requirements for federal systems</p>
</li>
<li>
<p><strong>PCI DSS v4.0 - Requirement 10: Log and Monitor</strong><br />
    https://www.pcisecuritystandards.org/<br />
    Logging and monitoring for payment card environments</p>
</li>
<li>
<p><strong>SOC 2 - CC7.2: System Monitoring</strong><br />
    https://www.aicpa.org/soc4so<br />
    Monitoring requirements for service organizations</p>
</li>
<li>
<p><strong>ISO/IEC 27001:2022 - A.12.4: Logging and Monitoring</strong><br />
    https://www.iso.org/standard/27001<br />
    Information security monitoring controls</p>
</li>
<li>
<p><strong>HIPAA Security Rule - 164.312(b): Audit Controls</strong><br />
    https://www.hhs.gov/hipaa/<br />
    Healthcare monitoring requirements</p>
</li>
</ol>
<h3 id="time-series-databases">Time-Series Databases</h3>
<ol>
<li>
<p><strong>InfluxDB - Time-Series Database</strong><br />
    https://docs.influxdata.com/<br />
    Metrics storage for certificate monitoring</p>
</li>
<li>
<p><strong>TimescaleDB - PostgreSQL for Time-Series</strong><br />
    https://docs.timescale.com/<br />
    Time-series extension for PostgreSQL</p>
</li>
<li>
<p><strong>Graphite - Metrics Storage</strong><br />
    https://graphite.readthedocs.io/<br />
    Scalable real-time graphing</p>
</li>
<li>
<p><strong>OpenTSDB - Distributed Time-Series Database</strong><br />
    http://opentsdb.net/docs/build/html/<br />
    HBase-backed time-series storage</p>
</li>
<li>
<p><strong>VictoriaMetrics - Time-Series Database</strong><br />
    https://docs.victoriametrics.com/<br />
    Fast, cost-effective metrics storage</p>
</li>
</ol>
<h3 id="real-world-incident-case-studies">Real-World Incident Case Studies</h3>
<ol>
<li>
<p><strong>LinkedIn Certificate Expiry Outage (2023)</strong><br />
    Public incident reports and post-mortems</p>
</li>
<li>
<p><strong>Microsoft Teams Certificate Outage (2023)</strong><br />
    Azure incident reports</p>
</li>
<li>
<p><strong>Spotify Certificate Expiry (2022)</strong><br />
    Public disclosure of certificate-related service disruption</p>
</li>
<li>
<p><strong>Equifax Data Breach (2017)</strong><br />
    Role of expired certificates in delayed breach detection</p>
</li>
<li>
<p><strong>Ericsson Network Outage (2018)</strong><br />
    Certificate expiry causing cellular network disruption</p>
</li>
</ol>
<h3 id="operational-best-practices">Operational Best Practices</h3>
<ol>
<li>
<p><strong>Google SRE Book - Monitoring Distributed Systems</strong><br />
    https://sre.google/sre-book/monitoring-distributed-systems/<br />
    Principles of effective monitoring</p>
</li>
<li>
<p><strong>Google SRE Workbook - Alerting on SLOs</strong><br />
    https://sre.google/workbook/alerting-on-slos/<br />
    Service level objective-based alerting</p>
</li>
<li>
<p><strong>Brendan Gregg - Systems Performance</strong><br />
    http://www.brendangregg.com/systems-performance-2nd-edition-book.html<br />
    Performance analysis methodologies</p>
</li>
<li>
<p><strong>Site Reliability Engineering</strong><br />
    https://sre.google/books/<br />
    Comprehensive operational practices</p>
</li>
<li>
<p><strong>The Art of Monitoring</strong><br />
    https://artofmonitoring.com/<br />
    James Turnbull's guide to modern monitoring</p>
</li>
</ol>
<h3 id="academic-research">Academic Research</h3>
<ol>
<li>
<p><strong>Chung, T., et al. "A Longitudinal, End-to-End View of the DNSSEC Ecosystem"</strong> (2017)<br />
    USENIX Security - Infrastructure monitoring insights</p>
</li>
<li>
<p><strong>Amann, J., et al. "Mission Accomplished? HTTPS Security after DigiNotar"</strong> (2017)<br />
    IMC '17 - Certificate ecosystem monitoring</p>
</li>
<li>
<p><strong>Durumeric, Z., et al. "The Security Impact of HTTPS Interception"</strong> (2017)<br />
    NDSS '17 - TLS validation and monitoring challenges</p>
</li>
<li>
<p><strong>Kumar, D., et al. "Security Challenges in an Increasingly Tangled Web"</strong> (2017)<br />
    WWW '17 - Certificate validation issues</p>
</li>
<li>
<p><strong>Holz, R., et al. "The SSL Landscape"</strong> (2011)<br />
    IMC '11 - Comprehensive certificate ecosystem study</p>
</li>
</ol>
<h3 id="machine-learning-and-anomaly-detection">Machine Learning and Anomaly Detection</h3>
<ol>
<li>
<p><strong>Scikit-learn - Anomaly Detection</strong><br />
    https://scikit-learn.org/stable/modules/outlier_detection.html<br />
    ML algorithms for certificate behavior analysis</p>
</li>
<li>
<p><strong>TensorFlow - Time Series Forecasting</strong><br />
    https://www.tensorflow.org/tutorials/structured_data/time_series<br />
    Predictive models for certificate expiry patterns</p>
</li>
<li>
<p><strong>Prophet - Time Series Forecasting</strong><br />
    https://facebook.github.io/prophet/<br />
    Facebook's forecasting tool for certificate metrics</p>
</li>
<li>
<p><strong>Datadog Anomaly Detection</strong><br />
    https://docs.datadoghq.com/monitors/types/anomaly/<br />
    ML-based anomaly detection for certificate metrics</p>
</li>
<li>
<p><strong>Elastic Machine Learning</strong><br />
    https://www.elastic.co/guide/en/machine-learning/current/<br />
    Anomaly detection in Elasticsearch</p>
</li>
</ol>
<h3 id="books-and-comprehensive-resources">Books and Comprehensive Resources</h3>
<ol>
<li>
<p><strong>Beyer, B., et al. "Site Reliability Engineering"</strong> (2016)<br />
    O'Reilly - Operational monitoring best practices</p>
</li>
<li>
<p><strong>Beyer, B., et al. "The Site Reliability Workbook"</strong> (2018)<br />
    O'Reilly - Practical monitoring implementation</p>
</li>
<li>
<p><strong>Turnbull, James. "The Art of Monitoring"</strong> (2014)<br />
    Monitoring practices for modern infrastructure</p>
</li>
<li>
<p><strong>Risti, Ivan. "Bulletproof SSL and TLS"</strong> (2014)<br />
    Feisty Duck - TLS deployment and monitoring</p>
</li>
<li>
<p><strong>Cvrcek, Dan. "Enterprise PKI Patterns"</strong> (2025)<br />
    Real-world certificate monitoring implementations</p>
</li>
</ol>









  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/axonsecurity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var sidebar = document.querySelector('.md-sidebar--secondary .md-sidebar__scrollwrap');
      if (sidebar) {
        var disclaimer = document.createElement('div');
        disclaimer.className = 'md-sidebar-disclaimer';
        disclaimer.innerHTML = `
          <div class="md-typeset">
            <div class="admonition info">
              <p class="admonition-title"> Our Books</p>
              <p><a href="https://axonshield.com/book"><strong>The Invisible Certificate Management Tax and How Automation Eliminates 94% of It</strong></a></p>
            </div>
            <div class="admonition warning">
              <p class="admonition-title"> Disclaimer</p>
              <p><small>This documentation is based on "best practices". We've observed these ignore 
                unique organizational needs and often prove ineffective for long-term, sustainable 
                operations and ignore strategic advanteges of building infrastructure intelligence.</small></p>
            </div>
          </div>
        `;
        sidebar.insertBefore(disclaimer, sidebar.firstChild);
      }
    });
  </script>
  

  </body>
</html>