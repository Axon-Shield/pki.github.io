
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://vault.axonshield.com/operations/inventory-and-discovery/">
      
      
        <link rel="prev" href="../certificate-rotation-strategies/">
      
      
        <link rel="next" href="../monitoring-and-alerting/">
      
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Inventory and Discovery - Shield Vault</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
    
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WJXPDRF2');</script>
  <!-- End Google Tag Manager -->
  
  <!-- Apollo Tracking -->
  <script>
    (function() {
      var apolloScript = document.createElement('script');
      apolloScript.type = 'text/javascript';
      apolloScript.async = true;
      apolloScript.src = 'https://cdn.apollo.io/v1/apollo.js';
      apolloScript.setAttribute('data-apollo-id', '68b8b91c5e883f0021f7f7aa');
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(apolloScript, s);
    })();
  </script>
  <!-- End Apollo Tracking -->

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#inventory-and-discovery" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Shield Vault" class="md-header__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Shield Vault
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Inventory and Discovery
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Foundations for Infrastructure Intelligence - Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../book/" class="md-tabs__link">
        
  
  
    
  
  Book

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../foundations/certificate-anatomy/" class="md-tabs__link">
          
  
  
  Foundations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../implementation/acme-protocol-implementation/" class="md-tabs__link">
          
  
  
  Implementation

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../certificate-lifecycle-management/" class="md-tabs__link">
          
  
  
  Operations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../security/private-key-protection/" class="md-tabs__link">
          
  
  
  Security

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../standards/acme-protocol/" class="md-tabs__link">
          
  
  
  Standards

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Shield Vault" class="md-nav__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    Shield Vault
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Foundations for Infrastructure Intelligence - Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../book/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Book
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Foundations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Foundations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/certificate-anatomy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Anatomy
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/cryptographic-primitives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cryptographic Primitives
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/public-private-key-pairs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Public-Private Key Pairs
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/trust-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trust Models
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/what-is-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is PKI?
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Implementation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/acme-protocol-implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/ca-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Architecture
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/certificate-issuance-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Issuance Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/hsm-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HSM Integration
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/multi-cloud-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Cloud PKI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate-lifecycle-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Lifecycle Management
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate-rotation-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Rotation Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Inventory and Discovery
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Inventory and Discovery
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-discovery-challenge" class="md-nav__link">
    <span class="md-ellipsis">
      The Discovery Challenge
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Discovery Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scale-and-distribution" class="md-nav__link">
    <span class="md-ellipsis">
      Scale and Distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visibility-gaps" class="md-nav__link">
    <span class="md-ellipsis">
      Visibility Gaps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discovery-complexity" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery Complexity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discovery-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Discovery Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#passive-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Passive Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#active-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Active Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybrid-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Hybrid Discovery
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inventory-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Inventory Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inventory Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-model" class="md-nav__link">
    <span class="md-ellipsis">
      Data Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-and-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      Storage and Indexing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discovery-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery Scheduling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Discovery Scheduling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#continuous-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Continuous Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discovery-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery Performance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inventory-enrichment" class="md-nav__link">
    <span class="md-ellipsis">
      Inventory Enrichment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inventory Enrichment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contextual-data" class="md-nav__link">
    <span class="md-ellipsis">
      Contextual Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#risk-scoring" class="md-nav__link">
    <span class="md-ellipsis">
      Risk Scoring
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deduplication-and-correlation" class="md-nav__link">
    <span class="md-ellipsis">
      Deduplication and Correlation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deduplication and Correlation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-same-certificate-multiple-locations" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge: Same Certificate, Multiple Locations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deduplication-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Deduplication Strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlation-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Correlation Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-points" class="md-nav__link">
    <span class="md-ellipsis">
      Integration Points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integration Points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmdb-integration" class="md-nav__link">
    <span class="md-ellipsis">
      CMDB Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#workflow-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Workflow Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inventory-accuracy" class="md-nav__link">
    <span class="md-ellipsis">
      Inventory Accuracy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inventory Accuracy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-quality-challenges" class="md-nav__link">
    <span class="md-ellipsis">
      Data Quality Challenges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verification-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Verification Strategies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operational-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operational Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-inventory-build" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Inventory Build
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maintenance-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Maintenance Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reporting-and-dashboards" class="md-nav__link">
    <span class="md-ellipsis">
      Reporting and Dashboards
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reporting and Dashboards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executive-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Executive Dashboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operational-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Dashboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-reporting" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Reporting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dos" class="md-nav__link">
    <span class="md-ellipsis">
      Do's
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#donts" class="md-nav__link">
    <span class="md-ellipsis">
      Don'ts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-challenges-and-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      Common Challenges and Solutions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Challenges and Solutions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-shadow-it-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge: Shadow IT Certificates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-dynamic-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge: Dynamic Infrastructure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-access-restrictions" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge: Access Restrictions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-performance-at-scale" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge: Performance at Scale
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-directions" class="md-nav__link">
    <span class="md-ellipsis">
      Future Directions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Future Directions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#machine-learning-for-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Machine Learning for Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-mesh-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Service Mesh Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zero-trust-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Zero Trust Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitoring-and-alerting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring and Alerting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../renewal-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Renewal Automation
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/private-key-protection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Private Key Protection
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Standards
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Standards
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/acme-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/ocsp-and-crl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OCSP and CRL
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/pkcs-standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PKCS Standards
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/tls-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TLS Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/x509-standard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    X.509 Standard
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-discovery-challenge" class="md-nav__link">
    <span class="md-ellipsis">
      The Discovery Challenge
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Discovery Challenge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scale-and-distribution" class="md-nav__link">
    <span class="md-ellipsis">
      Scale and Distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visibility-gaps" class="md-nav__link">
    <span class="md-ellipsis">
      Visibility Gaps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discovery-complexity" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery Complexity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discovery-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Discovery Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#passive-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Passive Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#active-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Active Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hybrid-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Hybrid Discovery
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inventory-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Inventory Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inventory Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-model" class="md-nav__link">
    <span class="md-ellipsis">
      Data Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage-and-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      Storage and Indexing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discovery-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery Scheduling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Discovery Scheduling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#continuous-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Continuous Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discovery-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Discovery Performance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inventory-enrichment" class="md-nav__link">
    <span class="md-ellipsis">
      Inventory Enrichment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inventory Enrichment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contextual-data" class="md-nav__link">
    <span class="md-ellipsis">
      Contextual Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#risk-scoring" class="md-nav__link">
    <span class="md-ellipsis">
      Risk Scoring
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deduplication-and-correlation" class="md-nav__link">
    <span class="md-ellipsis">
      Deduplication and Correlation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deduplication and Correlation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-same-certificate-multiple-locations" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge: Same Certificate, Multiple Locations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deduplication-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Deduplication Strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlation-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Correlation Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-points" class="md-nav__link">
    <span class="md-ellipsis">
      Integration Points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integration Points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cmdb-integration" class="md-nav__link">
    <span class="md-ellipsis">
      CMDB Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#workflow-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Workflow Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inventory-accuracy" class="md-nav__link">
    <span class="md-ellipsis">
      Inventory Accuracy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inventory Accuracy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-quality-challenges" class="md-nav__link">
    <span class="md-ellipsis">
      Data Quality Challenges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verification-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Verification Strategies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operational-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operational Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-inventory-build" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Inventory Build
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maintenance-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Maintenance Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reporting-and-dashboards" class="md-nav__link">
    <span class="md-ellipsis">
      Reporting and Dashboards
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reporting and Dashboards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#executive-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Executive Dashboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operational-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Dashboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-reporting" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance Reporting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dos" class="md-nav__link">
    <span class="md-ellipsis">
      Do's
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#donts" class="md-nav__link">
    <span class="md-ellipsis">
      Don'ts
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-challenges-and-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      Common Challenges and Solutions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Challenges and Solutions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#challenge-shadow-it-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge: Shadow IT Certificates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-dynamic-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge: Dynamic Infrastructure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-access-restrictions" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge: Access Restrictions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#challenge-performance-at-scale" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge: Performance at Scale
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-directions" class="md-nav__link">
    <span class="md-ellipsis">
      Future Directions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Future Directions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#machine-learning-for-discovery" class="md-nav__link">
    <span class="md-ellipsis">
      Machine Learning for Discovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-mesh-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Service Mesh Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zero-trust-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Zero Trust Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WJXPDRF2"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
  <!-- Right sidebar with disclaimer above TOC -->
  
    <style>
      @media screen and (min-width: 76.25em) {
        .md-sidebar--secondary {
          order: 1;
        }
        .md-sidebar--secondary::before {
          content: '';
          display: block;
          margin-bottom: 1rem;
        }
      }
    </style>
  
  
  
                  



<h1 id="inventory-and-discovery">Inventory and Discovery</h1>
<h2 id="overview">Overview</h2>
<p>Certificate inventory and discovery is the foundational operational capability that enables effective PKI management. Without comprehensive visibility into certificate deployment, organizations cannot effectively manage expiration, ensure compliance, or maintain security posture. This capability transforms PKI operations from reactive firefighting to proactive infrastructure management.</p>
<p><strong>Key principle</strong>: You cannot manage what you cannot see.</p>
<h2 id="the-discovery-challenge">The Discovery Challenge</h2>
<h3 id="scale-and-distribution">Scale and Distribution</h3>
<p>Modern enterprises face certificate sprawl across:
- <strong>Cloud infrastructure</strong>: AWS, Azure, GCP instances and services
- <strong>Container platforms</strong>: Kubernetes clusters, Docker environments
- <strong>Traditional infrastructure</strong>: Load balancers, web servers, application servers
- <strong>Network devices</strong>: Firewalls, VPN concentrators, wireless controllers
- <strong>Endpoints</strong>: Workstations, mobile devices, IoT sensors
- <strong>Applications</strong>: Databases, message queues, API gateways
- <strong>Development environments</strong>: CI/CD pipelines, testing infrastructure</p>
<p>A typical Fortune 500 organization manages 50,000 to 500,000+ certificates across these environments.</p>
<h3 id="visibility-gaps">Visibility Gaps</h3>
<p>Common blind spots include:
- Certificates created outside centralized PKI systems
- Self-signed certificates in development environments
- Certificates embedded in application code or configuration
- Short-lived certificates in dynamic infrastructure
- Certificates on decommissioned but still-running systems
- Shadow IT certificate deployments</p>
<h3 id="discovery-complexity">Discovery Complexity</h3>
<p>Technical challenges:
- <strong>Access control</strong>: Different teams control different infrastructure segments
- <strong>Network segmentation</strong>: DMZs, private networks, cloud VPCs require different access patterns
- <strong>Protocol diversity</strong>: TLS/SSL, code signing, email encryption, VPN use different discovery methods
- <strong>Dynamic infrastructure</strong>: Containers and cloud instances appear and disappear constantly
- <strong>Authentication requirements</strong>: Different systems require different credentials
- <strong>Performance impact</strong>: Aggressive scanning can affect production systems</p>
<h2 id="discovery-methods">Discovery Methods</h2>
<h3 id="passive-discovery">Passive Discovery</h3>
<p><strong>Network traffic analysis</strong>:
- Monitor TLS handshakes to identify certificates in use
- Capture SNI (Server Name Indication) data
- Analyze certificate chains in transit
- Identify certificate authorities being used</p>
<p>Advantages:
- No authentication required
- Minimal system impact
- Discovers certificates actually in use
- Works across heterogeneous environments</p>
<p>Limitations:
- Only finds certificates actively serving traffic
- Misses unused or backup certificates
- Requires network tap or SPAN port access
- May miss encrypted internal traffic</p>
<p><strong>Log aggregation</strong>:
- Parse web server logs for certificate information
- Extract certificate data from load balancer logs
- Analyze application logs for TLS errors
- Monitor CA issuance logs</p>
<h3 id="active-discovery">Active Discovery</h3>
<p><strong>Network scanning</strong>:
- Port scanning for TLS services (443, 8443, etc.)
- Certificate retrieval via TLS connection
- SNI-based virtual host enumeration
- Certificate chain extraction</p>
<p>Scan configurations:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">scan_profile</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Enterprise</span><span class="nv"> </span><span class="s">TLS</span><span class="nv"> </span><span class="s">Discovery&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="nt">ports</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">443</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8443</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">9443</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8080</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8181</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5s</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">  </span><span class="nt">parallel_threads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">  </span><span class="nt">rate_limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100/minute</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">  </span><span class="nt">protocols</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tls_1.2</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tls_1.3</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">  </span><span class="nt">sni_discovery</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">  </span><span class="nt">chain_extraction</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">  </span><span class="nt">network_ranges</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.0/8</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.16.0.0/12</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.0/16</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">  </span><span class="nt">exclusions</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.1.50.0/24</span><span class="w">  </span><span class="c1"># Sensitive lab network</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.16.99.0/24</span><span class="w">  </span><span class="c1"># Critical production</span>
</code></pre></div></p>
<p><strong>API-based discovery</strong>:
- Query cloud provider APIs (AWS Certificate Manager, Azure Key Vault)
- Extract certificates from load balancer configurations
- Read Kubernetes secrets and TLS ingress configurations
- Query certificate management platforms</p>
<p>Example AWS discovery:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">discover_aws_certificates</span><span class="p">(</span><span class="n">region</span><span class="p">):</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="sd">    Discover certificates across AWS services in a region</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    <span class="n">certificates</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="c1"># ACM certificates</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="n">acm</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;acm&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    <span class="n">acm_certs</span> <span class="o">=</span> <span class="n">acm</span><span class="o">.</span><span class="n">list_certificates</span><span class="p">()</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="k">for</span> <span class="n">cert_summary</span> <span class="ow">in</span> <span class="n">acm_certs</span><span class="p">[</span><span class="s1">&#39;CertificateSummaryList&#39;</span><span class="p">]:</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>        <span class="n">cert_detail</span> <span class="o">=</span> <span class="n">acm</span><span class="o">.</span><span class="n">describe_certificate</span><span class="p">(</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>            <span class="n">CertificateArn</span><span class="o">=</span><span class="n">cert_summary</span><span class="p">[</span><span class="s1">&#39;CertificateArn&#39;</span><span class="p">]</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>        <span class="p">)</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>        <span class="n">certificates</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>            <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;ACM&#39;</span><span class="p">,</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>            <span class="s1">&#39;arn&#39;</span><span class="p">:</span> <span class="n">cert_summary</span><span class="p">[</span><span class="s1">&#39;CertificateArn&#39;</span><span class="p">],</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>            <span class="s1">&#39;domain&#39;</span><span class="p">:</span> <span class="n">cert_summary</span><span class="p">[</span><span class="s1">&#39;DomainName&#39;</span><span class="p">],</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>            <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="n">cert_detail</span><span class="p">[</span><span class="s1">&#39;Certificate&#39;</span><span class="p">]</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>        <span class="p">})</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>    <span class="c1"># IAM server certificates</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>    <span class="n">iam</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;iam&#39;</span><span class="p">)</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>    <span class="n">iam_certs</span> <span class="o">=</span> <span class="n">iam</span><span class="o">.</span><span class="n">list_server_certificates</span><span class="p">()</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>    <span class="k">for</span> <span class="n">cert_metadata</span> <span class="ow">in</span> <span class="n">iam_certs</span><span class="p">[</span><span class="s1">&#39;ServerCertificateMetadataList&#39;</span><span class="p">]:</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>        <span class="n">cert_detail</span> <span class="o">=</span> <span class="n">iam</span><span class="o">.</span><span class="n">get_server_certificate</span><span class="p">(</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>            <span class="n">ServerCertificateName</span><span class="o">=</span><span class="n">cert_metadata</span><span class="p">[</span><span class="s1">&#39;ServerCertificateName&#39;</span><span class="p">]</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>        <span class="p">)</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>        <span class="n">certificates</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>            <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;IAM&#39;</span><span class="p">,</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">cert_metadata</span><span class="p">[</span><span class="s1">&#39;ServerCertificateName&#39;</span><span class="p">],</span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>            <span class="s1">&#39;arn&#39;</span><span class="p">:</span> <span class="n">cert_metadata</span><span class="p">[</span><span class="s1">&#39;Arn&#39;</span><span class="p">],</span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>            <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="n">cert_detail</span><span class="p">[</span><span class="s1">&#39;ServerCertificate&#39;</span><span class="p">]</span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>        <span class="p">})</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>    <span class="k">return</span> <span class="n">certificates</span>
</code></pre></div></p>
<p><strong>Filesystem scanning</strong>:
- Search for certificate file patterns (.pem, .crt, .cer, .pfx, .p12)
- Parse configuration files for certificate paths
- Extract certificates from Java keystores
- Read from Windows certificate stores</p>
<p>Filesystem search patterns:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Common certificate locations</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>/etc/ssl/certs/
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>/etc/pki/tls/certs/
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>/var/www/*/ssl/
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>~/.ssh/
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>/opt/*/conf/ssl/
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># Common filename patterns</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>*.pem
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>*.crt
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>*.cer
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>*.key
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>*.pfx
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>*.p12
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>*.jks
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>*.keystore
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>*.truststore
</code></pre></div></p>
<p><strong>Agent-based discovery</strong>:
- Deploy lightweight agents on endpoints
- Query local certificate stores directly
- Extract certificates from application configurations
- Report to central inventory system</p>
<p>Agent architecture:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>          Central Inventory              
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>                                         
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>       Discovery Coordinator          
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>                
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>        
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>                                    
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>         
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    Agent 1     Agent 2     Agent N 
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    Web         App         DB      
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>    Servers     Servers     Servers 
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>         
</code></pre></div></p>
<h3 id="hybrid-discovery">Hybrid Discovery</h3>
<p><strong>Multi-method orchestration</strong>:
- Combine passive and active techniques
- Correlate findings across discovery methods
- Validate API data with network scans
- Cross-reference filesystem and runtime discoveries</p>
<p>Strategy example:
1. Use API discovery for known infrastructure (AWS, K8s)
2. Perform network scanning to find unknown endpoints
3. Deploy agents on critical systems for deep visibility
4. Enable passive monitoring on network boundaries
5. Aggregate and deduplicate across all sources</p>
<h2 id="inventory-architecture">Inventory Architecture</h2>
<h3 id="data-model">Data Model</h3>
<p>Core certificate attributes:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nd">@dataclass</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">CertificateInventoryEntry</span><span class="p">:</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="c1"># Identity</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">certificate_id</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="n">serial_number</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="n">fingerprint_sha256</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    <span class="c1"># Subject and issuer</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="n">subject_dn</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="n">subject_cn</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    <span class="n">subject_san</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    <span class="n">issuer_dn</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>    <span class="n">issuer_cn</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    <span class="c1"># Validity</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>    <span class="n">not_before</span><span class="p">:</span> <span class="n">datetime</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>    <span class="n">not_after</span><span class="p">:</span> <span class="n">datetime</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>    <span class="n">days_until_expiry</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>    <span class="c1"># Cryptographic properties</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>    <span class="n">key_algorithm</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>    <span class="n">key_size</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>    <span class="n">signature_algorithm</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>    <span class="c1"># Discovery metadata</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>    <span class="n">discovery_method</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>    <span class="n">discovery_timestamp</span><span class="p">:</span> <span class="n">datetime</span>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>    <span class="n">last_seen</span><span class="p">:</span> <span class="n">datetime</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>    <span class="c1"># Location</span>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>    <span class="n">locations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">CertificateLocation</span><span class="p">]</span>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>    <span class="c1"># Trust chain</span>
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a>    <span class="n">chain</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a>    <span class="n">trust_anchor</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a>
<a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a>    <span class="c1"># Compliance and risk</span>
<a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a>    <span class="n">compliance_status</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span>
<a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a>    <span class="n">risk_score</span><span class="p">:</span> <span class="nb">float</span>
<a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a>    <span class="n">findings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div></p>
<p>Location tracking:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nd">@dataclass</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">CertificateLocation</span><span class="p">:</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="c1"># Where</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="c1"># What</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="n">service_type</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># web, api, vpn, etc.</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>    <span class="n">application</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    <span class="n">environment</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># prod, staging, dev</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>    <span class="c1"># Who</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>    <span class="n">owner_team</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>    <span class="n">business_unit</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>    <span class="c1"># How</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>    <span class="n">deployment_method</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># load_balancer, direct, reverse_proxy</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>    <span class="c1"># Context</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>    <span class="n">cloud_provider</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>    <span class="n">region</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>    <span class="n">availability_zone</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>    <span class="n">kubernetes_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>    <span class="c1"># State</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># active, inactive, unknown</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>    <span class="n">verified</span><span class="p">:</span> <span class="nb">bool</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>    <span class="n">last_verified</span><span class="p">:</span> <span class="n">datetime</span>
</code></pre></div></p>
<h3 id="storage-and-indexing">Storage and Indexing</h3>
<p><strong>Database schema considerations</strong>:</p>
<p>Time-series data:
- Certificate history over time
- Discovery event logs
- Expiry timeline projections
- Compliance status changes</p>
<p>Relational structure:
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1">-- Core certificate table</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">certificates</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="n">UUID</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="n">serial_number</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="n">fingerprint_sha256</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span><span class="n">subject_dn</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span><span class="n">issuer_dn</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">    </span><span class="n">not_before</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">    </span><span class="n">not_after</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">    </span><span class="n">public_key_algorithm</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">    </span><span class="n">key_size</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">    </span><span class="n">signature_algorithm</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">    </span><span class="n">updated_at</span><span class="w"> </span><span class="k">TIMESTAMP</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="p">);</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="c1">-- Location tracking</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">certificate_locations</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="n">UUID</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">    </span><span class="n">certificate_id</span><span class="w"> </span><span class="n">UUID</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">certificates</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">    </span><span class="n">hostname</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">    </span><span class="n">ip_address</span><span class="w"> </span><span class="n">INET</span><span class="p">,</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="w">    </span><span class="n">port</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">    </span><span class="n">service_type</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="w">    </span><span class="n">environment</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="w">    </span><span class="n">owner_team</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="w">    </span><span class="n">first_seen</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="w">    </span><span class="n">last_seen</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a><span class="w">    </span><span class="k">UNIQUE</span><span class="p">(</span><span class="n">certificate_id</span><span class="p">,</span><span class="w"> </span><span class="n">hostname</span><span class="p">,</span><span class="w"> </span><span class="n">port</span><span class="p">)</span>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a><span class="p">);</span>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a><span class="c1">-- Discovery events</span>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">discovery_events</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="n">UUID</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a><span class="w">    </span><span class="n">certificate_id</span><span class="w"> </span><span class="n">UUID</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">certificates</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a><span class="w">    </span><span class="n">discovery_method</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a><span class="w">    </span><span class="n">discovered_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span>
<a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a><span class="w">    </span><span class="n">discovery_details</span><span class="w"> </span><span class="n">JSONB</span>
<a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a><span class="p">);</span>
<a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>
<a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a><span class="c1">-- Create indexes for common queries</span>
<a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cert_expiry</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">certificates</span><span class="p">(</span><span class="n">not_after</span><span class="p">);</span>
<a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_cert_subject</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">certificates</span><span class="p">(</span><span class="n">subject_dn</span><span class="p">);</span>
<a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_location_hostname</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">certificate_locations</span><span class="p">(</span><span class="n">hostname</span><span class="p">);</span>
<a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_location_owner</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">certificate_locations</span><span class="p">(</span><span class="n">owner_team</span><span class="p">);</span>
</code></pre></div></p>
<p><strong>Search and query capabilities</strong>:</p>
<p>Critical queries:
- Certificates expiring within N days
- All certificates for a given hostname
- Certificates issued by specific CA
- Weak cryptography identification
- Orphaned certificates (no active locations)
- Duplicate certificates across environments</p>
<p>Example search interface:
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CertificateInventory</span><span class="p">:</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>               <span class="n">expires_within_days</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>               <span class="n">hostname</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>               <span class="n">owner_team</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>               <span class="n">environment</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>               <span class="n">issuer_contains</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>               <span class="n">key_size_less_than</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="sd">        Flexible certificate search with multiple filters</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>        <span class="k">pass</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">expiring_soon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Critical operational query&quot;&quot;&quot;</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>        <span class="k">pass</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">by_risk_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_score</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">7.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Security-focused query&quot;&quot;&quot;</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>        <span class="k">pass</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">compliance_violations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>                            <span class="n">policy</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compliance reporting&quot;&quot;&quot;</span>
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>        <span class="k">pass</span>
</code></pre></div></p>
<h2 id="discovery-scheduling">Discovery Scheduling</h2>
<h3 id="continuous-discovery">Continuous Discovery</h3>
<p><strong>Real-time discovery</strong>:
- Event-driven triggers (new host appears, configuration change)
- Kubernetes admission controller integration
- Cloud provider event streams (CloudTrail, Activity Log)
- Infrastructure-as-code pipeline integration</p>
<p><strong>Periodic scanning</strong>:
- Full network scans: Weekly or monthly
- Critical infrastructure: Daily
- Cloud API queries: Hourly
- Passive monitoring: Continuous</p>
<p>Schedule example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nt">discovery_schedule</span><span class="p">:</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">  </span><span class="nt">continuous</span><span class="p">:</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">passive_network_monitoring</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cloud_event_stream</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">      </span><span class="nt">sources</span><span class="p">:</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws_cloudtrail</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure_activity_log</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gcp_audit_log</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">  </span><span class="nt">periodic</span><span class="p">:</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_scan</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">      </span><span class="nt">schedule</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0</span><span class="nv"> </span><span class="s">2</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">0&quot;</span><span class="w">  </span><span class="c1"># 2 AM every Sunday</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">      </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">full_network</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">api_discovery</span>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">      </span><span class="nt">schedule</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*/15</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*&quot;</span><span class="w">  </span><span class="c1"># Every 15 minutes</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">      </span><span class="nt">sources</span><span class="p">:</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aws_acm</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure_keyvault</span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">filesystem_scan</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="w">      </span><span class="nt">schedule</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0</span><span class="nv"> </span><span class="s">3</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*&quot;</span><span class="w">  </span><span class="c1"># 3 AM daily</span>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="w">      </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">critical_servers</span>
</code></pre></div></p>
<h3 id="discovery-performance">Discovery Performance</h3>
<p><strong>Optimization strategies</strong>:</p>
<p>Rate limiting:
- Prevent network congestion
- Avoid triggering IDS/IPS systems
- Respect API rate limits
- Distribute load across time windows</p>
<p>Incremental discovery:
- Track what's been scanned recently
- Focus on changes since last scan
- Use change detection mechanisms
- Prioritize critical infrastructure</p>
<p>Parallelization:
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">concurrent.futures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">parallel_discovery</span><span class="p">(</span><span class="n">targets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> 
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>                       <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="sd">    Parallel certificate discovery with rate limiting</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>    <span class="n">discovered</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>        <span class="c1"># Submit all discovery tasks</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>        <span class="n">future_to_target</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>            <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">discover_certificates</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span> <span class="n">target</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>            <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">targets</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>        <span class="p">}</span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>        <span class="c1"># Collect results as they complete</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>        <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">future_to_target</span><span class="p">):</span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>            <span class="n">target</span> <span class="o">=</span> <span class="n">future_to_target</span><span class="p">[</span><span class="n">future</span><span class="p">]</span>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>                <span class="n">certs</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>                <span class="n">discovered</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">certs</span><span class="p">)</span>
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a>                <span class="n">log_discovery_failure</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>
<a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>    <span class="k">return</span> <span class="n">discovered</span>
</code></pre></div></p>
<h2 id="inventory-enrichment">Inventory Enrichment</h2>
<h3 id="contextual-data">Contextual Data</h3>
<p><strong>Ownership attribution</strong>:
- CMDB integration for asset owners
- Cloud resource tags for team identification
- Network subnet to team mappings
- LDAP/Active Directory lookups for responsible parties</p>
<p><strong>Business context</strong>:
- Application criticality ratings
- Compliance requirements by system
- Data classification levels
- SLA requirements</p>
<p><strong>Technical metadata</strong>:
- Certificate usage patterns (traffic volume)
- Related infrastructure (load balancers, firewalls)
- Deployment history (when installed, by whom)
- Renewal history (success/failure patterns)</p>
<h3 id="risk-scoring">Risk Scoring</h3>
<p>Automated risk assessment:
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">calculate_risk_score</span><span class="p">(</span><span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="sd">    Multi-factor risk scoring for certificates</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>    <span class="c1"># Expiry risk (0-3 points)</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    <span class="n">days_until_expiry</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">days_until_expiry</span><span class="p">()</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>    <span class="k">if</span> <span class="n">days_until_expiry</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>        <span class="n">score</span> <span class="o">+=</span> <span class="mf">3.0</span>  <span class="c1"># Expired</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>    <span class="k">elif</span> <span class="n">days_until_expiry</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">:</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>        <span class="n">score</span> <span class="o">+=</span> <span class="mf">2.5</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>    <span class="k">elif</span> <span class="n">days_until_expiry</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>        <span class="n">score</span> <span class="o">+=</span> <span class="mf">2.0</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>    <span class="k">elif</span> <span class="n">days_until_expiry</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">:</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>        <span class="n">score</span> <span class="o">+=</span> <span class="mf">1.0</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>    <span class="c1"># Cryptographic strength (0-3 points)</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>    <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_size</span> <span class="o">&lt;</span> <span class="mi">2048</span><span class="p">:</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>        <span class="n">score</span> <span class="o">+=</span> <span class="mf">3.0</span>  <span class="c1"># Weak key</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>    <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">signature_algorithm</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sha1&#39;</span><span class="p">,</span> <span class="s1">&#39;md5&#39;</span><span class="p">]:</span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>        <span class="n">score</span> <span class="o">+=</span> <span class="mf">2.0</span>  <span class="c1"># Weak signature</span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>    <span class="c1"># Trust chain (0-2 points)</span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">cert</span><span class="o">.</span><span class="n">has_valid_chain</span><span class="p">():</span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>        <span class="n">score</span> <span class="o">+=</span> <span class="mf">2.0</span>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>    <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">is_self_signed</span><span class="p">():</span>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>        <span class="n">score</span> <span class="o">+=</span> <span class="mf">1.5</span>
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>    <span class="c1"># Usage context (0-2 points)</span>
<a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a>    <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">is_public_facing</span><span class="p">():</span>
<a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a>        <span class="n">score</span> <span class="o">+=</span> <span class="mf">1.0</span>  <span class="c1"># Higher visibility</span>
<a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a>    <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">is_production</span><span class="p">():</span>
<a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a>        <span class="n">score</span> <span class="o">+=</span> <span class="mf">1.0</span>  <span class="c1"># Higher impact</span>
<a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a>
<a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a>    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="deduplication-and-correlation">Deduplication and Correlation</h2>
<h3 id="challenge-same-certificate-multiple-locations">Challenge: Same Certificate, Multiple Locations</h3>
<p>A single certificate may be discovered:
- Multiple times via different methods
- Across different locations (servers, load balancers)
- In different states (active, backup, archived)
- With different metadata (ownership, context)</p>
<h3 id="deduplication-strategy">Deduplication Strategy</h3>
<p><strong>Primary key identification</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">deduplicate_certificates</span><span class="p">(</span><span class="n">discoveries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Certificate</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Certificate</span><span class="p">]:</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="sd">    Deduplicate certificate discoveries using multiple strategies</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    <span class="c1"># Primary: fingerprint (most reliable)</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="n">unique_by_fingerprint</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">discoveries</span><span class="p">:</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>        <span class="n">fingerprint</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">fingerprint_sha256</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>        <span class="k">if</span> <span class="n">fingerprint</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_by_fingerprint</span><span class="p">:</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>            <span class="n">unique_by_fingerprint</span><span class="p">[</span><span class="n">fingerprint</span><span class="p">]</span> <span class="o">=</span> <span class="n">cert</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>            <span class="c1"># Merge locations and metadata</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>            <span class="n">existing</span> <span class="o">=</span> <span class="n">unique_by_fingerprint</span><span class="p">[</span><span class="n">fingerprint</span><span class="p">]</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>            <span class="n">existing</span><span class="o">.</span><span class="n">locations</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">locations</span><span class="p">)</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>            <span class="n">existing</span><span class="o">.</span><span class="n">discovery_methods</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">discovery_method</span><span class="p">)</span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>            <span class="n">existing</span><span class="o">.</span><span class="n">last_seen</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">existing</span><span class="o">.</span><span class="n">last_seen</span><span class="p">,</span> <span class="n">cert</span><span class="o">.</span><span class="n">last_seen</span><span class="p">)</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_by_fingerprint</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</code></pre></div></p>
<p><strong>Location consolidation</strong>:
- Aggregate all locations where certificate appears
- Track which discovery method found each location
- Maintain most recent verification timestamp
- Preserve ownership information for each location</p>
<h3 id="correlation-analysis">Correlation Analysis</h3>
<p><strong>Certificate relationships</strong>:
- Certificates sharing same private key
- Certificates in the same chain
- Certificates from the same issuance request
- Replacement certificates (renewed versions)</p>
<p><strong>Infrastructure relationships</strong>:
- Certificates used by related services
- Load-balanced configurations
- High-availability pairs
- Disaster recovery duplicates</p>
<h2 id="integration-points">Integration Points</h2>
<h3 id="cmdb-integration">CMDB Integration</h3>
<p><strong>Bi-directional synchronization</strong>:</p>
<p>From CMDB to inventory:
- Asset ownership information
- Configuration item relationships
- Change management data
- Business service mappings</p>
<p>From inventory to CMDB:
- Certificate configuration items
- Certificate-to-asset relationships
- Expiry and compliance status
- Discovery timestamps</p>
<p>Integration example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CMDBIntegration</span><span class="p">:</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">enrich_from_cmdb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Certificate</span><span class="p">:</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="sd">        Enrich certificate with CMDB data</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>        <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">cert</span><span class="o">.</span><span class="n">locations</span><span class="p">:</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>            <span class="c1"># Query CMDB for host information</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>            <span class="n">ci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmdb_client</span><span class="o">.</span><span class="n">get_ci_by_hostname</span><span class="p">(</span><span class="n">location</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>            <span class="k">if</span> <span class="n">ci</span><span class="p">:</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>                <span class="n">location</span><span class="o">.</span><span class="n">owner_team</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">owner_team</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>                <span class="n">location</span><span class="o">.</span><span class="n">business_unit</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">business_unit</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>                <span class="n">location</span><span class="o">.</span><span class="n">application</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">application_name</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>                <span class="n">location</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">environment</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>                <span class="n">location</span><span class="o">.</span><span class="n">change_window</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">maintenance_window</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>        <span class="k">return</span> <span class="n">cert</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_ci_for_certificate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="sd">        Create CMDB configuration item for certificate</span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a>        <span class="n">ci_data</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;X.509 Certificate&#39;</span><span class="p">,</span>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a>            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Certificate: </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">subject_cn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a>            <span class="s1">&#39;serial_number&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">serial_number</span><span class="p">,</span>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>            <span class="s1">&#39;expiry_date&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">not_after</span><span class="p">,</span>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a>            <span class="s1">&#39;issuer&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">issuer_cn</span><span class="p">,</span>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a>            <span class="s1">&#39;related_hosts&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">loc</span><span class="o">.</span><span class="n">hostname</span> <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="n">cert</span><span class="o">.</span><span class="n">locations</span><span class="p">]</span>
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a>        <span class="p">}</span>
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a>
<a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmdb_client</span><span class="o">.</span><span class="n">create_ci</span><span class="p">(</span><span class="n">ci_data</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="monitoring-integration">Monitoring Integration</h3>
<p><strong>Alert generation</strong>:
- Feed expiry data to monitoring systems
- Generate alerts for compliance violations
- Trigger incidents for high-risk certificates
- Create tickets for renewal workflows</p>
<p><strong>Metric export</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># Prometheus metrics example</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">prometheus_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gauge</span><span class="p">,</span> <span class="n">Counter</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">certificates_total</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    <span class="s1">&#39;pki_certificates_total&#39;</span><span class="p">,</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>    <span class="s1">&#39;Total number of certificates in inventory&#39;</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="p">)</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="n">certificates_expiring</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>    <span class="s1">&#39;pki_certificates_expiring&#39;</span><span class="p">,</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>    <span class="s1">&#39;Certificates expiring within N days&#39;</span><span class="p">,</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>    <span class="p">[</span><span class="s1">&#39;days&#39;</span><span class="p">]</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="p">)</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="n">certificates_expired</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>    <span class="s1">&#39;pki_certificates_expired&#39;</span><span class="p">,</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>    <span class="s1">&#39;Number of expired certificates&#39;</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="p">)</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="n">discovery_runs</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a>    <span class="s1">&#39;pki_discovery_runs_total&#39;</span><span class="p">,</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a>    <span class="s1">&#39;Total discovery runs&#39;</span><span class="p">,</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a>    <span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">]</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="p">)</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="n">discovery_duration</span> <span class="o">=</span> <span class="n">Gauge</span><span class="p">(</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>    <span class="s1">&#39;pki_discovery_duration_seconds&#39;</span><span class="p">,</span>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a>    <span class="s1">&#39;Time taken for discovery run&#39;</span><span class="p">,</span>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a>    <span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span>
<a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="p">)</span>
</code></pre></div></p>
<h3 id="workflow-integration">Workflow Integration</h3>
<p><strong>Automated remediation</strong>:
- Trigger renewal workflows for expiring certificates
- Generate change requests for certificate replacement
- Queue validation tasks for new discoveries
- Schedule decommissioning for orphaned certificates</p>
<p><strong>Approval routing</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">WorkflowIntegration</span><span class="p">:</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">handle_expiring_certificate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">):</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="sd">        Automated workflow for expiring certificates</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>        <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">days_until_expiry</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>            <span class="c1"># Create renewal ticket</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>            <span class="n">ticket</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticket_system</span><span class="o">.</span><span class="n">create_ticket</span><span class="p">(</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>                <span class="n">summary</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Certificate expiring: </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">subject_cn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>                <span class="n">description</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_renewal_instructions</span><span class="p">(</span><span class="n">cert</span><span class="p">),</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>                <span class="n">assigned_to</span><span class="o">=</span><span class="n">cert</span><span class="o">.</span><span class="n">owner_team</span><span class="p">,</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>                <span class="n">priority</span><span class="o">=</span><span class="s1">&#39;high&#39;</span> <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">is_production</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>                <span class="n">due_date</span><span class="o">=</span><span class="n">cert</span><span class="o">.</span><span class="n">not_after</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>            <span class="p">)</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>            <span class="c1"># Notify owner</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">notify_owner</span><span class="p">(</span><span class="n">cert</span><span class="p">,</span> <span class="n">ticket</span><span class="p">)</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>            <span class="c1"># If high-criticality, escalate</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>            <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">is_critical</span><span class="p">()</span> <span class="ow">and</span> <span class="n">cert</span><span class="o">.</span><span class="n">days_until_expiry</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">14</span><span class="p">:</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">escalate_to_management</span><span class="p">(</span><span class="n">cert</span><span class="p">,</span> <span class="n">ticket</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="inventory-accuracy">Inventory Accuracy</h2>
<h3 id="data-quality-challenges">Data Quality Challenges</h3>
<p><strong>Stale data</strong>:
- Certificates removed but still in inventory
- Hosts decommissioned but still showing locations
- Changed configurations not yet discovered
- Cached discovery results</p>
<p><strong>False positives</strong>:
- Test certificates in production scans
- Backup certificates reported as active
- Development certificates in staging
- Certificates in archived configurations</p>
<p><strong>False negatives</strong>:
- Certificates behind authentication
- Certificates in air-gapped networks
- Certificates created outside discovery windows
- Dynamic certificates with very short lifetimes</p>
<h3 id="verification-strategies">Verification Strategies</h3>
<p><strong>Active verification</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">verify_certificate_in_use</span><span class="p">(</span><span class="n">location</span><span class="p">:</span> <span class="n">CertificateLocation</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="sd">    Actively verify certificate is still in use at location</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>        <span class="c1"># Attempt TLS connection</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>        <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>        <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">((</span><span class="n">location</span><span class="o">.</span><span class="n">hostname</span><span class="p">,</span> <span class="n">location</span><span class="o">.</span><span class="n">port</span><span class="p">),</span> 
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>            <span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> 
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>                                    <span class="n">server_hostname</span><span class="o">=</span><span class="n">location</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>                <span class="c1"># Get certificate presented</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>                <span class="n">presented_cert</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">(</span><span class="n">binary_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>                <span class="n">fingerprint</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">presented_cert</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>                <span class="c1"># Compare with inventory</span>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a>                <span class="k">return</span> <span class="n">fingerprint</span> <span class="o">==</span> <span class="n">location</span><span class="o">.</span><span class="n">certificate</span><span class="o">.</span><span class="n">fingerprint_sha256</span>
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>        <span class="c1"># Connection failed - certificate may no longer be in use</span>
<a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a>        <span class="n">log_verification_failure</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></p>
<p><strong>Confidence scoring</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nd">@dataclass</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">InventoryConfidence</span><span class="p">:</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>    <span class="n">certificate</span><span class="p">:</span> <span class="n">Certificate</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>    <span class="n">confidence_score</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># 0.0 to 1.0</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>    <span class="n">last_verified</span><span class="p">:</span> <span class="n">datetime</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>    <span class="n">verification_method</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_confidence</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="sd">        Calculate confidence in inventory accuracy</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>        <span class="n">score</span> <span class="o">=</span> <span class="mf">1.0</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>        <span class="c1"># Decay based on time since verification</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>        <span class="n">days_since_verification</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>            <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_verified</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>        <span class="p">)</span><span class="o">.</span><span class="n">days</span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>        <span class="k">if</span> <span class="n">days_since_verification</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>            <span class="n">score</span> <span class="o">*=</span> <span class="mf">0.9</span>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>        <span class="k">if</span> <span class="n">days_since_verification</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>            <span class="n">score</span> <span class="o">*=</span> <span class="mf">0.7</span>
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>        <span class="k">if</span> <span class="n">days_since_verification</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>            <span class="n">score</span> <span class="o">*=</span> <span class="mf">0.5</span>
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>        <span class="c1"># Boost for active verification</span>
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verification_method</span> <span class="o">==</span> <span class="s1">&#39;active_connection&#39;</span><span class="p">:</span>
<a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>            <span class="n">score</span> <span class="o">*=</span> <span class="mf">1.1</span>
<a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>
<a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>        <span class="c1"># Reduce for passive-only discovery</span>
<a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verification_method</span> <span class="o">==</span> <span class="s1">&#39;passive_observation&#39;</span><span class="p">:</span>
<a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>            <span class="n">score</span> <span class="o">*=</span> <span class="mf">0.9</span>
<a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>
<a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a>        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="operational-patterns">Operational Patterns</h2>
<h3 id="initial-inventory-build">Initial Inventory Build</h3>
<p><strong>Phase 1: Quick wins (Week 1)</strong>:
- Query cloud provider APIs
- Scan DMZ and external-facing systems
- Extract from certificate management platforms
- Query load balancer configurations</p>
<p>Target: 60-70% coverage of production certificates</p>
<p><strong>Phase 2: Deep discovery (Weeks 2-4)</strong>:
- Full network scanning
- Filesystem searches on critical servers
- Agent deployment to key infrastructure
- Integration with CMDB and asset management</p>
<p>Target: 85-90% coverage</p>
<p><strong>Phase 3: Continuous improvement (Ongoing)</strong>:
- Enable passive monitoring
- Implement change-driven discovery
- Expand agent deployment
- Refine search patterns based on gaps</p>
<p>Target: 95%+ coverage</p>
<h3 id="maintenance-operations">Maintenance Operations</h3>
<p><strong>Regular cleanup</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">inventory_maintenance</span><span class="p">():</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="sd">    Periodic inventory hygiene operations</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    <span class="c1"># Remove stale entries</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>    <span class="n">remove_certificates_not_seen_for</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>    <span class="c1"># Verify high-risk certificates</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    <span class="n">high_risk</span> <span class="o">=</span> <span class="n">get_certificates_by_risk</span><span class="p">(</span><span class="n">min_score</span><span class="o">=</span><span class="mf">7.0</span><span class="p">)</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>    <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">high_risk</span><span class="p">:</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>        <span class="n">verify_all_locations</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>    <span class="c1"># Update ownership from CMDB</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>    <span class="n">sync_ownership_data</span><span class="p">()</span>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>    <span class="c1"># Recalculate risk scores</span>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>    <span class="n">recalculate_all_risk_scores</span><span class="p">()</span>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>    <span class="c1"># Clean up duplicate locations</span>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>    <span class="n">deduplicate_certificate_locations</span><span class="p">()</span>
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>    <span class="c1"># Archive expired certificates</span>
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>    <span class="n">archive_expired_certificates</span><span class="p">(</span><span class="n">expired_for_days</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>Quality metrics</strong>:
- Coverage percentage (discovered vs. expected)
- Verification freshness (% verified in last 7 days)
- Accuracy rate (verified as active vs. total)
- Discovery lag (time from deployment to discovery)
- False positive rate
- False negative rate (from manual audit sampling)</p>
<h2 id="reporting-and-dashboards">Reporting and Dashboards</h2>
<h3 id="executive-dashboard">Executive Dashboard</h3>
<p>Key metrics:
- Total certificates under management
- Certificates expiring in next 30/60/90 days
- Expired certificates count
- Weak cryptography count
- Compliance violations
- High-risk certificate count</p>
<p><strong>Trends over time</strong>:
- Certificate population growth
- Expiry rate vs. renewal rate
- Time-to-discovery for new certificates
- Discovery coverage percentage</p>
<h3 id="operational-dashboard">Operational Dashboard</h3>
<p><strong>Real-time views</strong>:
- Recent discoveries (last 24 hours)
- Verification failures
- Discovery job status
- Active alerts and incidents</p>
<p><strong>Detailed breakdowns</strong>:
- Certificates by team/business unit
- Certificates by environment
- Certificates by issuing CA
- Certificates by cryptographic algorithm
- Certificates by cloud provider/region</p>
<h3 id="compliance-reporting">Compliance Reporting</h3>
<p>Required for audits:
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_compliance_report</span><span class="p">(</span><span class="n">policy</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Report</span><span class="p">:</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="sd">    Generate compliance report for specific policy</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    <span class="n">all_certs</span> <span class="o">=</span> <span class="n">get_all_certificates</span><span class="p">()</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>    <span class="n">report</span> <span class="o">=</span> <span class="n">ComplianceReport</span><span class="p">()</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    <span class="n">report</span><span class="o">.</span><span class="n">policy</span> <span class="o">=</span> <span class="n">policy</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>    <span class="n">report</span><span class="o">.</span><span class="n">total_certificates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_certs</span><span class="p">)</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>    <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">all_certs</span><span class="p">:</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>        <span class="n">status</span> <span class="o">=</span> <span class="n">evaluate_compliance</span><span class="p">(</span><span class="n">cert</span><span class="p">,</span> <span class="n">policy</span><span class="p">)</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>        <span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">compliant</span><span class="p">:</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>            <span class="n">report</span><span class="o">.</span><span class="n">compliant_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>            <span class="n">report</span><span class="o">.</span><span class="n">non_compliant_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>            <span class="n">report</span><span class="o">.</span><span class="n">violations</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>                <span class="s1">&#39;certificate&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="p">,</span>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>                <span class="s1">&#39;reasons&#39;</span><span class="p">:</span> <span class="n">status</span><span class="o">.</span><span class="n">violations</span><span class="p">,</span>
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>                <span class="s1">&#39;remediation&#39;</span><span class="p">:</span> <span class="n">status</span><span class="o">.</span><span class="n">recommended_actions</span>
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a>            <span class="p">})</span>
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a>
<a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a>    <span class="n">report</span><span class="o">.</span><span class="n">compliance_percentage</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a>        <span class="n">report</span><span class="o">.</span><span class="n">compliant_count</span> <span class="o">/</span> <span class="n">report</span><span class="o">.</span><span class="n">total_certificates</span> <span class="o">*</span> <span class="mi">100</span>
<a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a>    <span class="p">)</span>
<a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a>
<a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a>    <span class="k">return</span> <span class="n">report</span>
</code></pre></div></p>
<h2 id="best-practices">Best Practices</h2>
<h3 id="dos">Do's</h3>
<p><strong>Comprehensive coverage</strong>:
- Use multiple discovery methods for redundancy
- Prioritize critical infrastructure for deep discovery
- Implement both scheduled and event-driven discovery
- Maintain discovery method diversity</p>
<p><strong>Data accuracy</strong>:
- Regularly verify certificate locations
- Implement confidence scoring
- Perform manual audits to identify gaps
- Clean up stale data systematically</p>
<p><strong>Integration</strong>:
- Connect inventory to monitoring and alerting
- Synchronize with CMDB for ownership data
- Feed compliance reporting from inventory
- Trigger workflows from inventory insights</p>
<p><strong>Performance</strong>:
- Implement rate limiting to avoid network impact
- Use incremental discovery where possible
- Cache API results appropriately
- Optimize database queries with proper indexing</p>
<h3 id="donts">Don'ts</h3>
<p><strong>Avoid aggressive scanning</strong>:
- Don't scan production systems during business hours without approval
- Don't exceed API rate limits
- Don't trigger IDS/IPS systems with aggressive probes
- Don't impact application performance with filesystem scans</p>
<p><strong>Don't trust single sources</strong>:
- Don't rely solely on self-reported inventory
- Don't assume APIs are complete
- Don't skip verification of passive discoveries
- Don't ignore discovery method blind spots</p>
<p><strong>Avoid data quality issues</strong>:
- Don't keep unverified data indefinitely
- Don't ignore duplicate detection
- Don't skip ownership attribution
- Don't neglect contextual enrichment</p>
<h2 id="common-challenges-and-solutions">Common Challenges and Solutions</h2>
<h3 id="challenge-shadow-it-certificates">Challenge: Shadow IT Certificates</h3>
<p><strong>Problem</strong>: Teams create certificates outside central PKI, often using public CAs or self-signed certificates.</p>
<p><strong>Solution</strong>:
- Implement network-based discovery to find all certificates regardless of source
- Use passive monitoring to identify certificates as they're used
- Establish clear policies and communication about approved certificate sources
- Provide easy-to-use self-service certificate issuance as an alternative
- Monitor public CT logs for unauthorized certificates on company domains</p>
<h3 id="challenge-dynamic-infrastructure">Challenge: Dynamic Infrastructure</h3>
<p><strong>Problem</strong>: Container platforms and cloud auto-scaling create and destroy infrastructure rapidly, making inventory tracking difficult.</p>
<p><strong>Solution</strong>:
- Integrate with orchestration platforms (Kubernetes, ECS) at the API level
- Implement event-driven discovery triggered by infrastructure changes
- Focus on certificate templates and policies rather than individual instances
- Use short-lived certificates that don't require long-term tracking
- Aggregate metrics at the service level rather than instance level</p>
<h3 id="challenge-access-restrictions">Challenge: Access Restrictions</h3>
<p><strong>Problem</strong>: Security boundaries, network segmentation, and access controls prevent comprehensive discovery.</p>
<p><strong>Solution</strong>:
- Deploy distributed discovery agents within each security zone
- Coordinate with security teams for approved access methods
- Use API-based discovery where available to avoid network scanning
- Implement agent-based discovery on systems where network access is restricted
- Maintain separate inventories per zone with aggregation at reporting layer</p>
<h3 id="challenge-performance-at-scale">Challenge: Performance at Scale</h3>
<p><strong>Problem</strong>: Scanning hundreds of thousands of hosts and certificates becomes time and resource intensive.</p>
<p><strong>Solution</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ScalableDiscovery</span><span class="p">:</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">discovery_pool</span> <span class="o">=</span> <span class="n">DiscoveryPool</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rate_limiter</span> <span class="o">=</span> <span class="n">RateLimiter</span><span class="p">(</span><span class="n">max_per_second</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">discover_at_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="sd">        Implement tiered discovery strategy for scale</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>        <span class="c1"># Tier 1: API-based (fastest, most reliable)</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>        <span class="n">api_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_api_discoverable</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>        <span class="n">api_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_api_discovery</span><span class="p">(</span><span class="n">api_targets</span><span class="p">)</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>        <span class="c1"># Tier 2: Agent-based (good for managed hosts)</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>        <span class="n">agent_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_agent_available</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>        <span class="n">agent_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent_discovery</span><span class="p">(</span><span class="n">agent_targets</span><span class="p">)</span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>        <span class="c1"># Tier 3: Network scan (slowest, for unknowns)</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>        <span class="n">scan_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_unknown</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>        <span class="n">scan_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate_limited_scan</span><span class="p">(</span><span class="n">scan_targets</span><span class="p">)</span>
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a>        <span class="c1"># Aggregate and deduplicate</span>
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">consolidate_results</span><span class="p">([</span>
<a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a>            <span class="n">api_results</span><span class="p">,</span>
<a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a>            <span class="n">agent_results</span><span class="p">,</span> 
<a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a>            <span class="n">scan_results</span>
<a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a>        <span class="p">])</span>
</code></pre></div></p>
<h2 id="future-directions">Future Directions</h2>
<h3 id="machine-learning-for-discovery">Machine Learning for Discovery</h3>
<p><strong>Predictive patterns</strong>:
- Learn typical certificate deployment patterns
- Identify anomalous certificate usage
- Predict where certificates are likely to be found
- Suggest new discovery targets based on infrastructure patterns</p>
<p><strong>Automated classification</strong>:
- Automatically categorize certificates by usage type
- Identify certificate purposes from context
- Cluster related certificates
- Detect certificate sprawl patterns</p>
<h3 id="service-mesh-integration">Service Mesh Integration</h3>
<p>As service mesh adoption grows:
- Integrate with Istio, Linkerd certificate management
- Discover sidecar proxy certificates
- Track mutual TLS configurations
- Monitor certificate rotation in service mesh</p>
<h3 id="zero-trust-architecture">Zero Trust Architecture</h3>
<p>Discovery in zero trust:
- Track certificate-based authentication everywhere
- Monitor device certificates and endpoint certificates
- Integrate with identity providers
- Discover certificates used in continuous authentication</p>
<h2 id="conclusion">Conclusion</h2>
<p>Certificate inventory and discovery is not a one-time project but an ongoing operational capability. Comprehensive visibility enables everything else in PKI operations: you cannot renew what you don't know exists, you cannot comply with policies for certificates you haven't discovered, and you cannot respond to vulnerabilities in certificates you can't find.</p>
<p>The investment in robust discovery pays dividends across the entire PKI lifecycle: reduced outages from unexpected expirations, faster response to security issues, improved compliance posture, and transformation of PKI from cost center to strategic capability.</p>
<p>Start with quick wins using API-based discovery, expand systematically to cover all infrastructure, and continuously improve coverage and accuracy. The goal is not perfection but progressive improvement toward comprehensive, verified visibility into your certificate estate.</p>









  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/axonsecurity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var sidebar = document.querySelector('.md-sidebar--secondary .md-sidebar__scrollwrap');
      if (sidebar) {
        var disclaimer = document.createElement('div');
        disclaimer.className = 'md-sidebar-disclaimer';
        disclaimer.innerHTML = `
          <div class="md-typeset">
            <div class="admonition info">
              <p class="admonition-title"> Our Books</p>
              <p><a href="https://axonshield.com/book"><strong>The Invisible Certificate Management Tax and How Automation Eliminates 94% of It</strong></a></p>
            </div>
            <div class="admonition warning">
              <p class="admonition-title"> Disclaimer</p>
              <p><small>This documentation is based on "best practices". We've observed these ignore 
                unique organizational needs and often prove ineffective for long-term, sustainable 
                operations and ignore strategic advanteges of building infrastructure intelligence.</small></p>
            </div>
          </div>
        `;
        sidebar.insertBefore(disclaimer, sidebar.firstChild);
      }
    });
  </script>
  

  </body>
</html>