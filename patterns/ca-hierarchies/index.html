
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://vault.axonshield.com/patterns/ca-hierarchies/">
      
      
        <link rel="prev" href="../../operations/renewal-automation/">
      
      
        <link rel="next" href="../cloud-vs-on-premises/">
      
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>CA Hierarchies - Shield Vault</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
    
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WJXPDRF2');</script>
  <!-- End Google Tag Manager -->
  
  <!-- Apollo Tracking -->
  <script>
    (function() {
      var apolloScript = document.createElement('script');
      apolloScript.type = 'text/javascript';
      apolloScript.async = true;
      apolloScript.src = 'https://cdn.apollo.io/v1/apollo.js';
      apolloScript.setAttribute('data-apollo-id', '68b8b91c5e883f0021f7f7aa');
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(apolloScript, s);
    })();
  </script>
  <!-- End Apollo Tracking -->

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ca-hierarchies" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Shield Vault" class="md-header__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Shield Vault
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CA Hierarchies
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Why Certificate Management Matters

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../quick-start/" class="md-tabs__link">
        
  
  
    
  
  Quick Start Guide

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../technical-guide/" class="md-tabs__link">
        
  
  
    
  
  Foundations for Infrastructure Intelligence - Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../architecture/case-studies/" class="md-tabs__link">
          
  
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../business/cost_of_certificate_management/" class="md-tabs__link">
          
  
  
  Business

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../foundations/certificate-anatomy/" class="md-tabs__link">
          
  
  
  Foundations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../implementation/acme-protocol-implementation/" class="md-tabs__link">
          
  
  
  Implementation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../operations/certificate-lifecycle-management/" class="md-tabs__link">
          
  
  
  Operations

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  Patterns

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../security/ca-compromise-scenarios/" class="md-tabs__link">
          
  
  
  Security

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../standards/acme-protocol/" class="md-tabs__link">
          
  
  
  Standards

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../strategy/success-metrics/" class="md-tabs__link">
          
  
  
  Strategy

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../troubleshooting/chain-validation-errors/" class="md-tabs__link">
          
  
  
  Troubleshooting

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../vendors/digicert-certcentral/" class="md-tabs__link">
          
  
  
  Vendors

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Shield Vault" class="md-nav__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    Shield Vault
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why Certificate Management Matters
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technical-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Foundations for Infrastructure Intelligence - Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/case-studies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Case Studies - Certificate Management at Scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/certificate-as-code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate-as-Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/mutual-tls-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mutual TLS Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/service-mesh-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service Mesh Certificates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/zero-trust-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zero-Trust Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Business
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Business
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../business/cost_of_certificate_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The $67 Million Risk: Hidden Costs of Manual Certificate Management
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Foundations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Foundations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/certificate-anatomy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Anatomy
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/cryptographic-primitives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cryptographic Primitives
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/public-private-key-pairs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Public-Private Key Pairs
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/trust-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trust Models
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/what-is-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is PKI?
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Implementation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/acme-protocol-implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/ca-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Architecture
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/certificate-issuance-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Issuance Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/hsm-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HSM Integration
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/multi-cloud-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Cloud PKI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/certificate-lifecycle-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Lifecycle Management
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/certificate-rotation-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Rotation Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/inventory-and-discovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inventory and Discovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/monitoring-and-alerting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring and Alerting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/renewal-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Renewal Automation
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Patterns
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    CA Hierarchies
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    CA Hierarchies
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-hierarchy-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Hierarchy Matters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Hierarchy Matters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-isolation" class="md-nav__link">
    <span class="md-ellipsis">
      Security Isolation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operational-flexibility" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Flexibility
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#business-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Business Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-hierarchy-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Common Hierarchy Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Hierarchy Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#two-tier-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Two-Tier Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#three-tier-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Three-Tier Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-signed-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Signed Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bridge-ca-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Bridge CA Hierarchy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hierarchy-design-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Hierarchy Design Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hierarchy Design Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#path-length-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Path Length Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#name-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Name Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Policies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hierarchy-anti-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Hierarchy Anti-Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hierarchy Anti-Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anti-pattern-1-online-root-ca" class="md-nav__link">
    <span class="md-ellipsis">
      Anti-Pattern 1: Online Root CA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-pattern-2-single-intermediate-for-everything" class="md-nav__link">
    <span class="md-ellipsis">
      Anti-Pattern 2: Single Intermediate for Everything
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-pattern-3-too-many-tiers" class="md-nav__link">
    <span class="md-ellipsis">
      Anti-Pattern 3: Too Many Tiers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-pattern-4-no-name-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Anti-Pattern 4: No Name Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-pattern-5-inconsistent-key-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Anti-Pattern 5: Inconsistent Key Algorithms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operational-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operational Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#root-ca-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Root CA Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intermediate-ca-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Intermediate CA Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#high-availability" class="md-nav__link">
    <span class="md-ellipsis">
      High Availability
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hierarchy-evolution" class="md-nav__link">
    <span class="md-ellipsis">
      Hierarchy Evolution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hierarchy Evolution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-new-intermediates" class="md-nav__link">
    <span class="md-ellipsis">
      Adding New Intermediates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrating-to-new-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to New Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sunsetting-old-intermediates" class="md-nav__link">
    <span class="md-ellipsis">
      Sunsetting Old Intermediates
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standards-and-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Standards and Specifications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cabrowser-forum-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      CA/Browser Forum Requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#federal-pki-and-bridge-cas" class="md-nav__link">
    <span class="md-ellipsis">
      Federal PKI and Bridge CAs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-extensions-and-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Extensions and Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hsm-and-key-management" class="md-nav__link">
    <span class="md-ellipsis">
      HSM and Key Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root-ca-operations_1" class="md-nav__link">
    <span class="md-ellipsis">
      Root CA Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subordinate-ca-management" class="md-nav__link">
    <span class="md-ellipsis">
      Subordinate CA Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-certification-and-federation" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Certification and Federation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hierarchy-evolution-and-migration" class="md-nav__link">
    <span class="md-ellipsis">
      Hierarchy Evolution and Migration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-transparency-and-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Transparency and Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industry-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Industry Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloud-pki-services" class="md-nav__link">
    <span class="md-ellipsis">
      Cloud PKI Services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cryptographic-agility" class="md-nav__link">
    <span class="md-ellipsis">
      Cryptographic Agility
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#browser-root-programs" class="md-nav__link">
    <span class="md-ellipsis">
      Browser Root Programs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#academic-research" class="md-nav__link">
    <span class="md-ellipsis">
      Academic Research
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-and-audit" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance and Audit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud-vs-on-premises/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud vs On-Premises
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../high-availability-disaster-recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    High Availability and Disaster Recovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi-tenancy-considerations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Tenancy Considerations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/ca-compromise-scenarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Compromise Scenarios
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/certificate-pinning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Pinning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/common-vulnerabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Vulnerabilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/compliance-and-audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compliance and Audit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/incident-response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Incident Response
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/key-management-best-practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Key Management Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/private-key-protection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Private Key Protection
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/threat-models-and-attack-vectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threat Models and Attack Vectors
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Standards
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Standards
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/acme-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/ocsp-and-crl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OCSP and CRL
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/pkcs-standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PKCS Standards
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/tls-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TLS Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/x509-standard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    X.509 Standard
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Strategy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Strategy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategy/success-metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Success Metrics and KPIs for Certificate Automation
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Troubleshooting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/chain-validation-errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chain Validation Errors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/common-misconfigurations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Misconfigurations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/expired-certificate-outages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Expired Certificate Outages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/performance-bottlenecks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Bottlenecks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Vendors
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Vendors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/digicert-certcentral/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DigiCert CertCentral
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/hashicorp-vault-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HashiCorp Vault PKI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/keyfactor-command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Keyfactor Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/venafi-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Venafi Platform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/vendor-comparison-matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vendor Comparison Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-hierarchy-matters" class="md-nav__link">
    <span class="md-ellipsis">
      Why Hierarchy Matters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Hierarchy Matters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-isolation" class="md-nav__link">
    <span class="md-ellipsis">
      Security Isolation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operational-flexibility" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Flexibility
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#business-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Business Requirements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-hierarchy-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Common Hierarchy Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Hierarchy Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#two-tier-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Two-Tier Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#three-tier-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Three-Tier Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-signed-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Signed Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bridge-ca-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Bridge CA Hierarchy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hierarchy-design-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Hierarchy Design Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hierarchy Design Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#path-length-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Path Length Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#name-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Name Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Policies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hierarchy-anti-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      Hierarchy Anti-Patterns
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hierarchy Anti-Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anti-pattern-1-online-root-ca" class="md-nav__link">
    <span class="md-ellipsis">
      Anti-Pattern 1: Online Root CA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-pattern-2-single-intermediate-for-everything" class="md-nav__link">
    <span class="md-ellipsis">
      Anti-Pattern 2: Single Intermediate for Everything
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-pattern-3-too-many-tiers" class="md-nav__link">
    <span class="md-ellipsis">
      Anti-Pattern 3: Too Many Tiers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-pattern-4-no-name-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Anti-Pattern 4: No Name Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anti-pattern-5-inconsistent-key-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Anti-Pattern 5: Inconsistent Key Algorithms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operational-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operational Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#root-ca-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Root CA Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intermediate-ca-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Intermediate CA Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#high-availability" class="md-nav__link">
    <span class="md-ellipsis">
      High Availability
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hierarchy-evolution" class="md-nav__link">
    <span class="md-ellipsis">
      Hierarchy Evolution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hierarchy Evolution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-new-intermediates" class="md-nav__link">
    <span class="md-ellipsis">
      Adding New Intermediates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrating-to-new-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to New Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sunsetting-old-intermediates" class="md-nav__link">
    <span class="md-ellipsis">
      Sunsetting Old Intermediates
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standards-and-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Standards and Specifications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cabrowser-forum-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      CA/Browser Forum Requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#federal-pki-and-bridge-cas" class="md-nav__link">
    <span class="md-ellipsis">
      Federal PKI and Bridge CAs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-extensions-and-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Extensions and Constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hsm-and-key-management" class="md-nav__link">
    <span class="md-ellipsis">
      HSM and Key Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root-ca-operations_1" class="md-nav__link">
    <span class="md-ellipsis">
      Root CA Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subordinate-ca-management" class="md-nav__link">
    <span class="md-ellipsis">
      Subordinate CA Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-certification-and-federation" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-Certification and Federation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hierarchy-evolution-and-migration" class="md-nav__link">
    <span class="md-ellipsis">
      Hierarchy Evolution and Migration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-transparency-and-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Transparency and Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#industry-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Industry Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloud-pki-services" class="md-nav__link">
    <span class="md-ellipsis">
      Cloud PKI Services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cryptographic-agility" class="md-nav__link">
    <span class="md-ellipsis">
      Cryptographic Agility
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#browser-root-programs" class="md-nav__link">
    <span class="md-ellipsis">
      Browser Root Programs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#academic-research" class="md-nav__link">
    <span class="md-ellipsis">
      Academic Research
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compliance-and-audit" class="md-nav__link">
    <span class="md-ellipsis">
      Compliance and Audit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WJXPDRF2"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
  <!-- Right sidebar with disclaimer above TOC -->
  
    <style>
      @media screen and (min-width: 76.25em) {
        .md-sidebar--secondary {
          order: 1;
        }
        .md-sidebar--secondary::before {
          content: '';
          display: block;
          margin-bottom: 1rem;
        }
      }
    </style>
  
  
  
                  



<h1 id="ca-hierarchies">CA Hierarchies</h1>
<h2 id="overview">Overview</h2>
<p>Certificate Authority hierarchy design is the foundational architectural decision in PKI infrastructure. The hierarchy structure determines security boundaries, operational flexibility, failure domains, and the blast radius of compromise. While a flat structure might seem simpler, hierarchical PKI architectures provide critical security and operational benefits that become increasingly valuable at scale.</p>
<p><strong>Core principle</strong>: CA hierarchy design is a security architecture decision, not just an organizational chart. The structure should minimize risk, contain compromise, and enable operational agility.</p>
<h2 id="why-hierarchy-matters">Why Hierarchy Matters</h2>
<h3 id="security-isolation">Security Isolation</h3>
<p>The root CA is the ultimate trust anchor. If compromised, the entire PKI collapses. By isolating the root CA offline and using intermediate CAs for day-to-day operations, you create security boundaries that limit the impact of compromise.</p>
<p><strong>Offline root CA benefits</strong>:</p>
<ul>
<li>Root private key never exposed to network attacks</li>
<li>Physical security controls protect the root</li>
<li>Limited access windows reduce attack surface</li>
<li>Air-gap prevents remote compromise</li>
<li>Root remains trustworthy even if intermediate compromised</li>
</ul>
<p><strong>Intermediate CA compromise containment</strong>:</p>
<ul>
<li>Revoke compromised intermediate without affecting root</li>
<li>Other intermediates continue operating</li>
<li>Only certificates from compromised intermediate need replacement</li>
<li>Recovery time measured in days, not months</li>
<li>Trust hierarchy remains intact</li>
</ul>
<h3 id="operational-flexibility">Operational Flexibility</h3>
<p>Different certificate types have different operational characteristics. TLS certificates may need 90-day automated rotation. Code signing certificates require manual approval and longer validity. Email certificates have different validation requirements. A hierarchy enables customized operational models per certificate type.</p>
<p><strong>Purpose-specific intermediates</strong>:</p>
<ul>
<li>TLS intermediate: Automated issuance, short validity, high volume</li>
<li>Code signing intermediate: Manual approval, longer validity, low volume</li>
<li>Email intermediate: Identity validation, moderate validity, medium volume</li>
<li>Internal intermediate: Relaxed validation, flexible validity, high trust</li>
</ul>
<p>Each intermediate can have different:</p>
<ul>
<li>Certificate Practices Statement (CPS)</li>
<li>Issuance procedures and automation level</li>
<li>Validation requirements</li>
<li>Key protection requirements (HSM vs software)</li>
<li>Certificate validity periods</li>
<li>Revocation policies</li>
</ul>
<h3 id="business-requirements">Business Requirements</h3>
<p>Organizations often need separation for business reasons:</p>
<p><strong>Multi-brand separation</strong>: Different companies within a conglomerate may need separate branding in certificates while sharing infrastructure.</p>
<p><strong>Geographic distribution</strong>: Regional intermediates can be placed closer to issuance points, reducing latency and enabling local compliance.</p>
<p><strong>Customer delegation</strong>: Managed service providers can delegate subordinate CAs to customers, giving them autonomy while maintaining oversight.</p>
<p><strong>Risk segmentation</strong>: High-risk environments (development, test) can use separate intermediate CAs, preventing their compromise from affecting production.</p>
<h2 id="common-hierarchy-patterns">Common Hierarchy Patterns</h2>
<h3 id="two-tier-hierarchy">Two-Tier Hierarchy</h3>
<p>The simplest and most common production hierarchy:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>                    
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>                       Root CA   
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>                      (Offline)  
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>                    
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>                           
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>            
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                                        
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>              
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        Issuing      Issuing     Issuing 
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>         CA 1         CA 2        CA 3   
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>         (TLS)       (Code)      (Email) 
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>              
</code></pre></div>
<p><strong>Characteristics</strong>:</p>
<ul>
<li>Root CA offline, generates intermediates</li>
<li>Issuing CAs operational, issue end-entity certificates</li>
<li>Clean separation between security (root) and operations (issuing)</li>
<li>Most certificates 2-3 hops from root</li>
<li>Simple to understand and operate</li>
</ul>
<p><strong>When to use</strong>:</p>
<ul>
<li>Most organizations' default choice</li>
<li>Clear security/operations boundary needed</li>
<li>Moderate certificate volume (thousands to millions)</li>
<li>Multiple certificate types with different requirements</li>
</ul>
<p><strong>Example configuration</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">TwoTierHierarchy</span><span class="p">:</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="sd">    Standard two-tier CA hierarchy</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>        <span class="c1"># Root CA (offline)</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">root_ca</span> <span class="o">=</span> <span class="n">RootCA</span><span class="p">(</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>            <span class="n">common_name</span><span class="o">=</span><span class="s2">&quot;Example Corp Root CA&quot;</span><span class="p">,</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>            <span class="n">key_algorithm</span><span class="o">=</span><span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>            <span class="n">key_size</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>            <span class="n">validity_years</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>            <span class="n">location</span><span class="o">=</span><span class="s2">&quot;offline_vault&quot;</span><span class="p">,</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>            <span class="n">hsm</span><span class="o">=</span><span class="s2">&quot;thales_luna_7&quot;</span><span class="p">,</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>            <span class="n">access</span><span class="o">=</span><span class="s2">&quot;ceremony_only&quot;</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>        <span class="p">)</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>        <span class="c1"># Issuing CA for TLS certificates</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tls_issuing_ca</span> <span class="o">=</span> <span class="n">IssuingCA</span><span class="p">(</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>            <span class="n">common_name</span><span class="o">=</span><span class="s2">&quot;Example Corp TLS Issuing CA&quot;</span><span class="p">,</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>            <span class="n">issuer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_ca</span><span class="p">,</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>            <span class="n">key_algorithm</span><span class="o">=</span><span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>            <span class="n">key_size</span><span class="o">=</span><span class="mi">3072</span><span class="p">,</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>            <span class="n">validity_years</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>            <span class="n">location</span><span class="o">=</span><span class="s2">&quot;datacenter_a&quot;</span><span class="p">,</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>            <span class="n">hsm</span><span class="o">=</span><span class="s2">&quot;aws_cloudhsm&quot;</span><span class="p">,</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>            <span class="n">permitted_uses</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;serverAuth&quot;</span><span class="p">,</span> <span class="s2">&quot;clientAuth&quot;</span><span class="p">],</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>            <span class="n">max_validity_days</span><span class="o">=</span><span class="mi">398</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>        <span class="p">)</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>        <span class="c1"># Issuing CA for code signing</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">code_signing_ca</span> <span class="o">=</span> <span class="n">IssuingCA</span><span class="p">(</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>            <span class="n">common_name</span><span class="o">=</span><span class="s2">&quot;Example Corp Code Signing CA&quot;</span><span class="p">,</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>            <span class="n">issuer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">root_ca</span><span class="p">,</span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>            <span class="n">key_algorithm</span><span class="o">=</span><span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>            <span class="n">key_size</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>            <span class="n">validity_years</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>            <span class="n">location</span><span class="o">=</span><span class="s2">&quot;secure_facility&quot;</span><span class="p">,</span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>            <span class="n">hsm</span><span class="o">=</span><span class="s2">&quot;thales_luna_7&quot;</span><span class="p">,</span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>            <span class="n">permitted_uses</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;codeSigning&quot;</span><span class="p">],</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>            <span class="n">max_validity_days</span><span class="o">=</span><span class="mi">1095</span>  <span class="c1"># 3 years</span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>        <span class="p">)</span>
</code></pre></div>
<h3 id="three-tier-hierarchy">Three-Tier Hierarchy</h3>
<p>Adds a policy layer between root and issuing CAs:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>                    
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>                       Root CA   
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>                      (Offline)  
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>                    
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>                           
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>            
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>                                        
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>            
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>        Policy       Policy      Policy   
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>         CA 1         CA 2        CA 3    
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>        (Prod)        (Dev)     (External)
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>            
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>                                        
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>               
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>                                       
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>      TLS Code Email TLS Code Email TLS Code Email
</code></pre></div>
<p><strong>Characteristics</strong>:</p>
<ul>
<li>Root CA signs policy CAs</li>
<li>Policy CAs establish different certificate policies</li>
<li>Issuing CAs under each policy CA</li>
<li>3-4 certificate hops from root to end-entity</li>
<li>Clear policy boundaries</li>
</ul>
<p><strong>When to use</strong>:</p>
<ul>
<li>Multiple distinct certificate policies needed</li>
<li>Different environments with different risk profiles</li>
<li>Organizational boundaries need policy separation</li>
<li>Compliance requires policy segregation</li>
<li>Large organizations (&gt;10,000 certificates)</li>
</ul>
<p><strong>Benefits</strong>:</p>
<ul>
<li>Policy CA compromise doesn't affect root</li>
<li>Can revoke entire policy CA if needed</li>
<li>Different policies for different contexts</li>
<li>Enables policy evolution without root changes</li>
</ul>
<p><strong>Drawbacks</strong>:</p>
<ul>
<li>More complexity to manage</li>
<li>Additional layer adds validation overhead</li>
<li>Longer certificate chains</li>
<li>More CAs to monitor and maintain</li>
</ul>
<h3 id="cross-signed-hierarchy">Cross-Signed Hierarchy</h3>
<p>Enables trust across multiple roots:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>                    
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>      Root CA                 Root CA 
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>         A        B    
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>       Cross-sign   
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>                                    
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>                  
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>                                        
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>Issuing CA  Issuing CA    Issuing CA  Issuing CA
</code></pre></div>
<p><strong>Use cases</strong>:</p>
<ul>
<li>Mergers and acquisitions (transition period)</li>
<li>Migration to new root CA</li>
<li>Multiple trust anchors for different purposes</li>
<li>Partner organization integration</li>
</ul>
<p><strong>Cross-signing mechanics</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_cross_signed_certificate</span><span class="p">(</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="n">subject_ca</span><span class="p">:</span> <span class="n">CA</span><span class="p">,</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="n">issuer_ca</span><span class="p">:</span> <span class="n">CA</span><span class="p">,</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">validity_years</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Certificate</span><span class="p">:</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="sd">    Create cross-signed certificate enabling trust across roots</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="c1"># Root A signs Root B&#39;s certificate</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="n">cross_signed_cert</span> <span class="o">=</span> <span class="n">Certificate</span><span class="p">(</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>        <span class="n">subject</span><span class="o">=</span><span class="n">subject_ca</span><span class="o">.</span><span class="n">subject_dn</span><span class="p">,</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>        <span class="n">subject_public_key</span><span class="o">=</span><span class="n">subject_ca</span><span class="o">.</span><span class="n">public_key</span><span class="p">,</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>        <span class="n">issuer</span><span class="o">=</span><span class="n">issuer_ca</span><span class="o">.</span><span class="n">subject_dn</span><span class="p">,</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>        <span class="n">validity</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="o">*</span><span class="n">validity_years</span><span class="p">),</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>        <span class="n">extensions</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>            <span class="s1">&#39;basicConstraints&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>                <span class="s1">&#39;ca&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>                <span class="s1">&#39;pathlen&#39;</span><span class="p">:</span> <span class="mi">1</span>  <span class="c1"># Can sign one more level</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>            <span class="p">},</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>            <span class="s1">&#39;keyUsage&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;keyCertSign&#39;</span><span class="p">,</span> <span class="s1">&#39;cRLSign&#39;</span><span class="p">]</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>        <span class="p">}</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>    <span class="p">)</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>    <span class="c1"># Sign with issuer&#39;s private key</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>    <span class="n">cross_signed_cert</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">issuer_ca</span><span class="o">.</span><span class="n">private_key</span><span class="p">)</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>    <span class="k">return</span> <span class="n">cross_signed_cert</span>
</code></pre></div>
<p><strong>Transition example</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>Phase 1: Both roots active
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    Old Root cross-sign New Root
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>                             
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    Old Issuing           New Issuing
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>Phase 2: Migrate to new root (6-12 months)
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    - Issue new certificates from New Root
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    - Old certificates still valid via Old Root
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    - Both roots trusted during transition
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>Phase 3: Deprecate old root
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>    - All certificates migrated to New Root
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>    - Remove Old Root from trust stores
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>    - Old Root retired
</code></pre></div>
<h3 id="bridge-ca-hierarchy">Bridge CA Hierarchy</h3>
<p>Connect multiple independent PKI hierarchies:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>                
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    Root A      Root B      Root C
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>                
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>                                  
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>                         
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>         Bridge 
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>                     CA   
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>                  
</code></pre></div>
<p><strong>Characteristics</strong>:</p>
<ul>
<li>Bridge CA cross-certified with multiple roots</li>
<li>Enables trust between otherwise independent PKIs</li>
<li>Used in government/defense for interoperability</li>
<li>Complex trust relationships</li>
</ul>
<p><strong>When to use</strong>:</p>
<ul>
<li>Multiple independent organizations need interoperability</li>
<li>Government PKI interconnection</li>
<li>Federation scenarios</li>
<li>Partner ecosystems</li>
</ul>
<p><strong>Complexity warning</strong>: Bridge CA architectures are complex and should be avoided unless specifically required. Most organizations should use simpler hierarchies.</p>
<h2 id="hierarchy-design-considerations">Hierarchy Design Considerations</h2>
<h3 id="path-length-constraints">Path Length Constraints</h3>
<p>Certificate chains can specify maximum path length (how many CAs can be chained):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_path_length_constraint</span><span class="p">(</span><span class="n">ca_cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">,</span> <span class="n">max_path_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="sd">    Set basicConstraints pathLen to limit chain depth</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="n">ca_cert</span><span class="o">.</span><span class="n">extensions</span><span class="p">[</span><span class="s1">&#39;basicConstraints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>        <span class="s1">&#39;ca&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>        <span class="s1">&#39;critical&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>        <span class="s1">&#39;pathlen&#39;</span><span class="p">:</span> <span class="n">max_path_length</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>    <span class="p">}</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="c1"># Examples:</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="n">root_ca_cert</span> <span class="o">=</span> <span class="n">create_certificate</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="n">set_path_length_constraint</span><span class="p">(</span><span class="n">root_ca_cert</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Can sign 2 more levels</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="n">intermediate_ca_cert</span> <span class="o">=</span> <span class="n">create_certificate</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="n">set_path_length_constraint</span><span class="p">(</span><span class="n">intermediate_ca_cert</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Can sign 1 more level</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="n">issuing_ca_cert</span> <span class="o">=</span> <span class="n">create_certificate</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="n">set_path_length_constraint</span><span class="p">(</span><span class="n">issuing_ca_cert</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Can only sign end-entity certs</span>
</code></pre></div>
<p><strong>Best practices</strong>:</p>
<ul>
<li>Root CA: pathLen = number of intermediate tiers</li>
<li>Intermediate CAs: pathLen = remaining tiers below them</li>
<li>Issuing CAs: pathLen = 0 (only end-entity certificates)</li>
<li>Never omit pathLen on CA certificates</li>
</ul>
<h3 id="name-constraints">Name Constraints</h3>
<p>Restrict what names subordinate CAs can issue certificates for:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_name_constraints</span><span class="p">(</span><span class="n">ca_cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">,</span> 
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>                          <span class="n">permitted_subtrees</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>                          <span class="n">excluded_subtrees</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="sd">    Apply name constraints to limit issuance scope</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>    <span class="n">ca_cert</span><span class="o">.</span><span class="n">extensions</span><span class="p">[</span><span class="s1">&#39;nameConstraints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>        <span class="s1">&#39;critical&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>        <span class="s1">&#39;permitted&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>            <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;DNS&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">subtree</span><span class="p">}</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>            <span class="k">for</span> <span class="n">subtree</span> <span class="ow">in</span> <span class="n">permitted_subtrees</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>        <span class="p">],</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>        <span class="s1">&#39;excluded&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>            <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;DNS&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">subtree</span><span class="p">}</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>            <span class="k">for</span> <span class="n">subtree</span> <span class="ow">in</span> <span class="p">(</span><span class="n">excluded_subtrees</span> <span class="ow">or</span> <span class="p">[])</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>        <span class="p">]</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>    <span class="p">}</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="c1"># Example: Restrict issuing CA to company domains</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="n">tls_issuing_ca</span> <span class="o">=</span> <span class="n">create_ca_certificate</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="n">apply_name_constraints</span><span class="p">(</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>    <span class="n">tls_issuing_ca</span><span class="p">,</span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>    <span class="n">permitted_subtrees</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;.example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;.example.net&#39;</span><span class="p">],</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>    <span class="n">excluded_subtrees</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;untrusted.example.com&#39;</span><span class="p">]</span>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="p">)</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="c1"># This issuing CA can now ONLY issue certificates for:</span>
<a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="c1"># *.example.com, *.example.net</span>
<a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="c1"># But NOT for:</span>
<a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="c1"># *.google.com (not permitted)</span>
<a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="c1"># *.untrusted.example.com (explicitly excluded)</span>
</code></pre></div>
<p><strong>Use cases</strong>:</p>
<ul>
<li>Restrict departmental CAs to their domains</li>
<li>Prevent wildcard abuse</li>
<li>Enforce geographic boundaries</li>
<li>Contain compromise scope</li>
</ul>
<h3 id="certificate-policies">Certificate Policies</h3>
<p>Declare which policies certificates adhere to:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CertificatePolicy</span><span class="p">:</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="sd">    Define certificate policies for hierarchy levels</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>    <span class="c1"># Policy OID structure: 1.3.6.1.4.1.ENTERPRISE.1.POLICY_TYPE</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>    <span class="n">ENTERPRISE_OID</span> <span class="o">=</span> <span class="s2">&quot;1.3.6.1.4.1.99999&quot;</span>  <span class="c1"># Example</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>    <span class="n">POLICIES</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>        <span class="s1">&#39;root&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ENTERPRISE_OID</span><span class="si">}</span><span class="s2">.1.1&quot;</span><span class="p">,</span>      <span class="c1"># Root CA policy</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>        <span class="s1">&#39;high_assurance&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ENTERPRISE_OID</span><span class="si">}</span><span class="s2">.1.2.1&quot;</span><span class="p">,</span>  <span class="c1"># High assurance</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>        <span class="s1">&#39;standard&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ENTERPRISE_OID</span><span class="si">}</span><span class="s2">.1.2.2&quot;</span><span class="p">,</span>        <span class="c1"># Standard validation</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>        <span class="s1">&#39;low_assurance&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ENTERPRISE_OID</span><span class="si">}</span><span class="s2">.1.2.3&quot;</span><span class="p">,</span>   <span class="c1"># Low assurance</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>        <span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ENTERPRISE_OID</span><span class="si">}</span><span class="s2">.1.3&quot;</span><span class="p">,</span>      <span class="c1"># Test/development</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>    <span class="p">}</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply_policy_to_certificate</span><span class="p">(</span><span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">,</span> <span class="n">policy_oid</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="sd">        Add certificate policy extension</span>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>        <span class="n">cert</span><span class="o">.</span><span class="n">extensions</span><span class="p">[</span><span class="s1">&#39;certificatePolicies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>            <span class="p">{</span>
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>                <span class="s1">&#39;policyIdentifier&#39;</span><span class="p">:</span> <span class="n">policy_oid</span><span class="p">,</span>
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a>                <span class="s1">&#39;policyQualifiers&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>                    <span class="p">{</span>
<a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>                        <span class="s1">&#39;policyQualifierId&#39;</span><span class="p">:</span> <span class="s1">&#39;id-qt-cps&#39;</span><span class="p">,</span>
<a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a>                        <span class="s1">&#39;qualifier&#39;</span><span class="p">:</span> <span class="s1">&#39;https://pki.example.com/cps&#39;</span>
<a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a>                    <span class="p">},</span>
<a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a>                    <span class="p">{</span>
<a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a>                        <span class="s1">&#39;policyQualifierId&#39;</span><span class="p">:</span> <span class="s1">&#39;id-qt-unotice&#39;</span><span class="p">,</span>
<a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a>                        <span class="s1">&#39;qualifier&#39;</span><span class="p">:</span> <span class="s1">&#39;This certificate is issued under the Example Corp CPS&#39;</span>
<a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a>                    <span class="p">}</span>
<a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a>                <span class="p">]</span>
<a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a>            <span class="p">}</span>
<a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a>        <span class="p">]</span>
<a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a>
<a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a><span class="c1"># Usage in hierarchy:</span>
<a id="__codelineno-9-39" name="__codelineno-9-39" href="#__codelineno-9-39"></a><span class="n">high_assurance_ca</span> <span class="o">=</span> <span class="n">create_ca_certificate</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-9-40" name="__codelineno-9-40" href="#__codelineno-9-40"></a><span class="n">CertificatePolicy</span><span class="o">.</span><span class="n">apply_policy_to_certificate</span><span class="p">(</span>
<a id="__codelineno-9-41" name="__codelineno-9-41" href="#__codelineno-9-41"></a>    <span class="n">high_assurance_ca</span><span class="p">,</span>
<a id="__codelineno-9-42" name="__codelineno-9-42" href="#__codelineno-9-42"></a>    <span class="n">CertificatePolicy</span><span class="o">.</span><span class="n">POLICIES</span><span class="p">[</span><span class="s1">&#39;high_assurance&#39;</span><span class="p">]</span>
<a id="__codelineno-9-43" name="__codelineno-9-43" href="#__codelineno-9-43"></a><span class="p">)</span>
</code></pre></div>
<h2 id="hierarchy-anti-patterns">Hierarchy Anti-Patterns</h2>
<h3 id="anti-pattern-1-online-root-ca">Anti-Pattern 1: Online Root CA</h3>
<p><strong>Problem</strong>: Root CA online and issuing certificates directly.</p>
<p><strong>Why it's bad</strong>:</p>
<ul>
<li>Root compromise = complete PKI failure</li>
<li>No containment boundaries</li>
<li>Single point of failure</li>
<li>Network attack surface on most critical component</li>
</ul>
<p><strong>Correct approach</strong>: Offline root CA that only signs intermediate CAs.</p>
<h3 id="anti-pattern-2-single-intermediate-for-everything">Anti-Pattern 2: Single Intermediate for Everything</h3>
<p><strong>Problem</strong>: One intermediate CA used for all certificate types.</p>
<p><strong>Why it's bad</strong>:</p>
<ul>
<li>No operational flexibility</li>
<li>Can't have different policies per use case</li>
<li>Compromise affects all certificate types</li>
<li>Can't deprecate or rotate without affecting everything</li>
</ul>
<p><strong>Correct approach</strong>: Purpose-specific intermediates (TLS, code signing, email, etc.)</p>
<h3 id="anti-pattern-3-too-many-tiers">Anti-Pattern 3: Too Many Tiers</h3>
<p><strong>Problem</strong>: Four or five-tier hierarchies with excessive nesting.</p>
<p><strong>Why it's bad</strong>:</p>
<ul>
<li>Unnecessary complexity</li>
<li>Longer certificate chains (validation overhead)</li>
<li>More CAs to manage and secure</li>
<li>Difficult to understand and audit</li>
<li>Most validation only checks 2-3 levels anyway</li>
</ul>
<p><strong>Correct approach</strong>: Two or three tiers covers 95% of use cases.</p>
<h3 id="anti-pattern-4-no-name-constraints">Anti-Pattern 4: No Name Constraints</h3>
<p><strong>Problem</strong>: Intermediate CAs without name constraints can issue for any domain.</p>
<p><strong>Why it's bad</strong>:</p>
<ul>
<li>Compromise enables issuance for arbitrary domains</li>
<li>No technical enforcement of policy boundaries</li>
<li>Violates principle of least privilege</li>
</ul>
<p><strong>Correct approach</strong>: Apply restrictive name constraints to all intermediate CAs.</p>
<h3 id="anti-pattern-5-inconsistent-key-algorithms">Anti-Pattern 5: Inconsistent Key Algorithms</h3>
<p><strong>Problem</strong>: Mix of RSA, ECDSA, different key sizes throughout hierarchy.</p>
<p><strong>Why it's bad</strong>:</p>
<ul>
<li>Validation complexity</li>
<li>Weakest algorithm determines chain security</li>
<li>Migration difficulties</li>
<li>Support matrix complexity</li>
</ul>
<p><strong>Correct approach</strong>: Consistent algorithm family throughout hierarchy, plan migrations carefully.</p>
<h2 id="operational-considerations">Operational Considerations</h2>
<h3 id="root-ca-operations">Root CA Operations</h3>
<p><strong>Generation ceremony</strong>:</p>
<ul>
<li>Multi-party key generation</li>
<li>Witnessed and documented</li>
<li>Secure facility with physical controls</li>
<li>HSM-based key generation</li>
<li>Video recording of ceremony</li>
<li>All participants sign documentation</li>
</ul>
<p><strong>Root CA usage</strong>:</p>
<ul>
<li>Brought online only for intermediate CA issuance</li>
<li>Requires security officer presence</li>
<li>Limited time window (hours)</li>
<li>Returned to offline storage immediately</li>
<li>All operations logged and audited</li>
</ul>
<p><strong>Root CA renewal</strong>:</p>
<ul>
<li>Plan 1-2 years before expiry</li>
<li>Communicate to all stakeholders</li>
<li>Coordinated update of trust stores</li>
<li>Potential for cross-signing during transition</li>
<li>Extensive testing before deployment</li>
</ul>
<h3 id="intermediate-ca-operations">Intermediate CA Operations</h3>
<p><strong>Key generation</strong>:</p>
<ul>
<li>Generated in production HSM</li>
<li>Or generated offline and imported</li>
<li>CSR submitted to root CA</li>
<li>Root CA signs during limited online window</li>
</ul>
<p><strong>Certificate issuance</strong>:</p>
<ul>
<li>Online and automated (for appropriate use cases)</li>
<li>Rate limiting to prevent abuse</li>
<li>Comprehensive audit logging</li>
<li>Anomaly detection</li>
</ul>
<p><strong>Renewal before expiry</strong>:</p>
<ul>
<li>Renew at 67-75% of validity consumed</li>
<li>Generates new key pair (recommended)</li>
<li>Overlap period for migration</li>
<li>Gradual deployment to avoid disruption</li>
</ul>
<p><strong>Revocation</strong>:</p>
<ul>
<li>Revoke if private key compromised</li>
<li>Revoke all end-entity certificates issued by compromised CA</li>
<li>Communicate to all relying parties</li>
<li>Issue replacement from different intermediate</li>
</ul>
<h3 id="high-availability">High Availability</h3>
<p><strong>Active-passive intermediates</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">HAIntermediateCA</span><span class="p">:</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="sd">    High availability configuration for intermediate CAs</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>        <span class="c1"># Primary issuing CA</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">primary</span> <span class="o">=</span> <span class="n">IssuingCA</span><span class="p">(</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;TLS Issuing CA - Primary&quot;</span><span class="p">,</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>            <span class="n">location</span><span class="o">=</span><span class="s2">&quot;datacenter_a&quot;</span><span class="p">,</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>            <span class="n">hsm</span><span class="o">=</span><span class="s2">&quot;aws_cloudhsm_cluster_a&quot;</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>        <span class="p">)</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>        <span class="c1"># Secondary issuing CA (same key material)</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secondary</span> <span class="o">=</span> <span class="n">IssuingCA</span><span class="p">(</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;TLS Issuing CA - Secondary&quot;</span><span class="p">,</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>            <span class="n">location</span><span class="o">=</span><span class="s2">&quot;datacenter_b&quot;</span><span class="p">,</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>            <span class="n">hsm</span><span class="o">=</span><span class="s2">&quot;aws_cloudhsm_cluster_b&quot;</span><span class="p">,</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>            <span class="n">key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">primary</span><span class="o">.</span><span class="n">key</span>  <span class="c1"># Replicated key material</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>        <span class="p">)</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>        <span class="c1"># Load balancer directs traffic</span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load_balancer</span> <span class="o">=</span> <span class="n">LoadBalancer</span><span class="p">(</span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>            <span class="n">primary</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">primary</span><span class="p">,</span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>            <span class="n">secondary</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">secondary</span><span class="p">,</span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>            <span class="n">health_check_interval</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>            <span class="n">failover_threshold</span><span class="o">=</span><span class="mi">3</span>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>        <span class="p">)</span>
</code></pre></div>
<p><strong>Active-active intermediates</strong>:</p>
<ul>
<li>Multiple intermediates with different keys</li>
<li>Load distributed across all</li>
<li>Failure of one doesn't affect others</li>
<li>No key replication needed</li>
<li>Higher operational complexity</li>
</ul>
<p><strong>Geographic distribution</strong>:</p>
<ul>
<li>Intermediate CAs in multiple regions</li>
<li>Lower latency for issuance</li>
<li>Resilience to regional outages</li>
<li>Compliance with data residency requirements</li>
</ul>
<h2 id="hierarchy-evolution">Hierarchy Evolution</h2>
<p>Organizations' PKI needs evolve. Plan for evolution:</p>
<h3 id="adding-new-intermediates">Adding New Intermediates</h3>
<p><strong>Process</strong>:
1. Define new intermediate's purpose and policy
2. Generate key pair (ceremony if appropriate)
3. Create CSR
4. Bring root CA online
5. Issue intermediate certificate
6. Return root CA offline
7. Deploy new intermediate
8. Begin issuing from new intermediate</p>
<p><strong>Considerations</strong>:</p>
<ul>
<li>No impact to existing intermediates</li>
<li>Test thoroughly before production use</li>
<li>Document purpose and policy</li>
<li>Update CP/CPS if needed</li>
</ul>
<h3 id="migrating-to-new-hierarchy">Migrating to New Hierarchy</h3>
<p><strong>Phased migration</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>Phase 1: Preparation (Months 1-3)
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>- Design new hierarchy
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>- Document migration plan
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>- Generate new root CA
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>- Create new intermediates
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>- Prepare deployment procedures
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>Phase 2: Parallel Operation (Months 4-9)
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>- Deploy new hierarchy alongside old
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>- Issue new certificates from new hierarchy
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>- Old certificates continue working
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>- Both hierarchies fully operational
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>Phase 3: Migration (Months 10-15)
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>- Renew expiring certificates from new hierarchy
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>- Gradually retire old certificates
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>- Monitor for issues
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>- Support both during transition
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>Phase 4: Deprecation (Months 16-18)
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>- All certificates migrated to new hierarchy
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a>- Old hierarchy read-only (no new issuance)
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a>- Remove old root from trust stores
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a>- Archive old hierarchy
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>Phase 5: Decommissioning (Month 19+)
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>- Old hierarchy fully retired
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>- Keys securely destroyed
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>- Documentation archived
<a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a>- Lessons learned captured
</code></pre></div>
<h3 id="sunsetting-old-intermediates">Sunsetting Old Intermediates</h3>
<p>When intermediate CA is no longer needed:</p>
<ol>
<li><strong>Stop issuing</strong>: Disable issuance from intermediate</li>
<li><strong>Certificate migration</strong>: Renew certificates under different intermediate</li>
<li><strong>Wait for expiry</strong>: Allow existing certificates to expire naturally</li>
<li><strong>Grace period</strong>: Monitor for any remaining usage</li>
<li><strong>Revocation</strong>: Revoke intermediate CA certificate</li>
<li><strong>Key destruction</strong>: Securely destroy private key</li>
<li><strong>Documentation</strong>: Update hierarchy documentation</li>
</ol>
<h2 id="best-practices-summary">Best Practices Summary</h2>
<p><strong>Hierarchy design</strong>:</p>
<ul>
<li>Two-tier for most organizations</li>
<li>Three-tier if multiple distinct policies needed</li>
<li>Offline root CA (non-negotiable)</li>
<li>Purpose-specific intermediates</li>
<li>Name constraints on all intermediates</li>
<li>Consistent algorithms throughout hierarchy</li>
</ul>
<p><strong>Security</strong>:</p>
<ul>
<li>Root CA always offline, HSM-protected</li>
<li>Multi-party ceremonies for root operations</li>
<li>Intermediate CA keys in HSM</li>
<li>Comprehensive audit logging</li>
<li>Regular security assessments</li>
</ul>
<p><strong>Operations</strong>:</p>
<ul>
<li>Clear operational procedures for each CA type</li>
<li>Automated where appropriate (issuance)</li>
<li>Manual where necessary (root operations)</li>
<li>High availability for critical intermediates</li>
<li>Regular backup and recovery testing</li>
</ul>
<p><strong>Evolution</strong>:</p>
<ul>
<li>Plan for change from the beginning</li>
<li>Build flexibility into design</li>
<li>Document migration paths</li>
<li>Test evolution scenarios</li>
<li>Update documentation as hierarchy evolves</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>CA hierarchy design is foundational to PKI security and operations. A well-designed hierarchy provides security isolation, operational flexibility, and resilience to compromise. Poor hierarchy design creates single points of failure, operational rigidity, and security weaknesses.</p>
<p>The vast majority of organizations should implement a two-tier hierarchy: offline root CA signing multiple purpose-specific intermediate CAs. This provides the right balance of security, flexibility, and operational simplicity.</p>
<p>More complex hierarchies (three-tier, bridge CAs) should only be implemented when specific business or technical requirements justify the additional complexity. Remember: hierarchy complexity is operational debt that you'll pay throughout the PKI lifecycle.</p>
<p>Design your hierarchy for the organization you'll become, not just the one you are today. Build in flexibility for evolution while maintaining simplicity in the core design. The best hierarchies are simple enough to understand, secure enough to trust, and flexible enough to evolve.</p>
<h2 id="references">References</h2>
<h3 id="standards-and-specifications">Standards and Specifications</h3>
<p><strong>RFC 5280 - X.509 Certificate and CRL Profile</strong>
- Cooper, D., et al. "Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile." RFC 5280, May 2008.
  - <a href="https://tools.ietf.org/html/rfc5280">Ietf - Rfc5280</a>
- Certificate hierarchy structures
- Name constraints and path length constraints
- Certificate policies and extensions</p>
<p><strong>RFC 3647 - Certificate Policy and Certification Practices Framework</strong>
- Chokhani, S., et al. "Internet X.509 Public Key Infrastructure Certificate Policy and Certification Practices Framework." RFC 3647, November 2003.
  - <a href="https://tools.ietf.org/html/rfc3647">Ietf - Rfc3647</a>
- Standard framework for documenting CA hierarchies
- Policy and practice statement guidance</p>
<p><strong>NIST SP 800-32 - Introduction to Public Key Technology and Federal PKI</strong>
- NIST. "Introduction to Public Key Technology and the Federal PKI Infrastructure." February 2001.
  - <a href="https://csrc.nist.gov/publications/detail/sp/800-32/final">Nist - Detail</a>
- Federal PKI hierarchy design
- Trust anchor management
- Cross-certification models</p>
<h3 id="cabrowser-forum-requirements">CA/Browser Forum Requirements</h3>
<p><strong>CA/Browser Forum Baseline Requirements</strong>
- CA/Browser Forum. "Baseline Requirements for the Issuance and Management of Publicly-Trusted Certificates." Current version.
  - <a href="https://cabforum.org/baseline-requirements-documents/">Cabforum - Baseline Requirements Documents</a>
- Requirements for public CA hierarchies
- Subordinate CA requirements
- Cross-certification restrictions</p>
<p><strong>CA/Browser Forum Network Security Requirements</strong>
- CA/Browser Forum. "Network and Certificate System Security Requirements." Current version.
  - <a href="https://cabforum.org/network-security-requirements/">Cabforum - Network Security Requirements</a>
- Security requirements for CA systems
- Physical and logical security controls
- Key ceremony requirements</p>
<h3 id="federal-pki-and-bridge-cas">Federal PKI and Bridge CAs</h3>
<p><strong>Federal PKI (FPKI) Architecture</strong>
- U.S. General Services Administration. "Federal Public Key Infrastructure."
  - <a href="https://www.idmanagement.gov/fpki/">Idmanagement - Fpki</a>
- Federal Bridge CA architecture
- Cross-certification model
- Policy mapping</p>
<p><strong>Federal Bridge Certification Authority Certificate Policy</strong>
- Federal PKI Policy Authority. "X.509 Certificate Policy for the Federal Bridge Certification Authority (FBCA)." Current version.
  - <a href="https://www.idmanagement.gov/fpki/">Idmanagement - Fpki</a>
- Bridge CA operational requirements
- Cross-certification procedures
- Policy constraints</p>
<p><strong>Federal Common Policy CP</strong>
- Federal PKI Policy Authority. "X.509 Certificate Policy for the U.S. Federal PKI Common Policy Framework." Current version.
- Common policy CA requirements
- Assurance levels
- Certificate profiles</p>
<h3 id="certificate-extensions-and-constraints">Certificate Extensions and Constraints</h3>
<p><strong>RFC 5280 Section 4.2 - Certificate Extensions</strong>
- Basic Constraints extension (Section 4.2.1.9)
  - CA flag and path length constraints
- Name Constraints extension (Section 4.2.1.10)
  - Permitted and excluded subtrees
- Certificate Policies extension (Section 4.2.1.4)
  - Policy OIDs and qualifiers</p>
<p><strong>RFC 3739 - Qualified Certificates Profile</strong>
- Santesson, S., et al. "Internet X.509 Public Key Infrastructure: Qualified Certificates Profile." RFC 3739, March 2004.
  - <a href="https://tools.ietf.org/html/rfc3739">Ietf - Rfc3739</a>
- European qualified certificates
- Policy requirements</p>
<h3 id="hsm-and-key-management">HSM and Key Management</h3>
<p><strong>NIST SP 800-57 - Key Management Recommendations</strong>
- NIST. "Recommendation for Key Management: Part 1 - General." Revision 5, May 2020.
  - <a href="https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final">Nist - Detail</a>
- Key hierarchy recommendations
- Cryptoperiods for different key types
- Key backup and recovery</p>
<p><strong>FIPS 140-2 - Cryptographic Module Security</strong>
- NIST. "Security Requirements for Cryptographic Modules." May 2001.
  - <a href="https://csrc.nist.gov/publications/detail/fips/140/2/final">Nist - Detail</a>
- HSM requirements for CA keys
- Physical security requirements
- Key zeroization</p>
<h3 id="root-ca-operations_1">Root CA Operations</h3>
<p><strong>CA Key Generation Ceremony</strong>
- Gutmann, P. "Key Ceremony Procedures." 2004.
  - <a href="https://www.cs.auckland.ac.nz/~pgut001/pubs/key_ceremony.txt">Ac - Pubs</a>
- Practical ceremony guidance
- Multi-party control procedures
- Documentation requirements</p>
<p><strong>WebTrust Principles and Criteria for CAs</strong>
- CPA Canada/AICPA. "WebTrust Principles and Criteria for Certification Authorities." Current version.
  - <a href="https://www.cpacanada.ca/en/business-and-accounting-resources/audit-and-assurance/overview-of-webtrust-services">Cpacanada - Audit And Assurance</a>
- CA operational requirements
- Root CA offline requirements
- Key ceremony audit requirements</p>
<h3 id="subordinate-ca-management">Subordinate CA Management</h3>
<p><strong>CA/Browser Forum - Subordinate CA Requirements</strong>
- Section 7.1.2: Subordinate CA Certificates
- Name constraints requirements
- EKU constraints
- Technical constraints enforcement</p>
<p><strong>ETSI EN 319 411 - Policy Requirements for Trust Service Providers</strong>
- ETSI. "Policy and security requirements for Trust Service Providers issuing certificates." Parts 1 and 2.
  - <a href="https://www.etsi.org/standards">Etsi - Standards</a>
- European CA requirements
- Qualified and non-qualified certificates
- Subordinate CA constraints</p>
<h3 id="cross-certification-and-federation">Cross-Certification and Federation</h3>
<p><strong>"Understanding Cross-Certification in Public Key Infrastructure"</strong>
- Polk, W.T., Hastings, N.E. "Bridge Certification Authorities: Connecting B2B Public Key Infrastructures." NIST, October 2000.
- Cross-certification models
- Path discovery and validation
- Trust anchor management</p>
<p><strong>RFC 4158 - Certification Path Building</strong>
- Cooper, M., et al. "Internet X.509 Public Key Infrastructure: Certification Path Building." RFC 4158, September 2005.
  - <a href="https://tools.ietf.org/html/rfc4158">Ietf - Rfc4158</a>
- Path construction algorithms
- Cross-certified environment navigation
- Forward and reverse path building</p>
<h3 id="hierarchy-evolution-and-migration">Hierarchy Evolution and Migration</h3>
<p><strong>"PKI Evolution: Certificate Policy Planning for Technical Non-Repudiation"</strong>
- Lloyd, S. "PKI Evolution: Certificate Policy Planning for Technical Non-Repudiation." SANS Institute, 2003.
- Hierarchy migration strategies
- Policy evolution
- Backward compatibility</p>
<p><strong>NIST SP 800-130 - Framework for Designing Key Management Systems</strong>
- NIST. "A Framework for Designing Cryptographic Key Management Systems." August 2013.
  - <a href="https://csrc.nist.gov/publications/detail/sp/800-130/final">Nist - Detail</a>
- Key hierarchy design
- Key lifecycle management
- Migration and transition strategies</p>
<h3 id="certificate-transparency-and-monitoring">Certificate Transparency and Monitoring</h3>
<p><strong>RFC 6962 - Certificate Transparency</strong>
- Laurie, B., Langley, A., Kasper, E. "Certificate Transparency." RFC 6962, June 2013.
  - <a href="https://tools.ietf.org/html/rfc6962">Ietf - Rfc6962</a>
- Public logging of certificates
- Log structure and operation
- Monitoring for misissuance</p>
<p><strong>Google Certificate Transparency Log Policy</strong>
- Google. "Certificate Transparency Log Policy."
  - <a href="https://github.com/google/certificate-transparency-community-site">Github - Certificate Transparency Community Site</a>
- Log operator requirements
- Temporal sharding
- Log monitoring</p>
<h3 id="industry-best-practices">Industry Best Practices</h3>
<p><strong>"Planning for PKI" (Wiley)</strong>
- Housley, R., Polk, T. "Planning for PKI: Best Practices Guide for Deploying Public Key Infrastructure." Wiley, 2001.
- Comprehensive PKI planning
- Hierarchy design decisions
- Cross-certification planning</p>
<p><strong>"PKI Security Solutions for the Enterprise" (Wiley)</strong>
- Nash, A., et al. "PKI: Implementing and Managing E-Security." RSA Press/Wiley, 2001.
- Enterprise PKI architecture
- Hierarchy design patterns
- Operational considerations</p>
<h3 id="cloud-pki-services">Cloud PKI Services</h3>
<p><strong>AWS Private CA Documentation</strong>
- AWS. "AWS Certificate Manager Private Certificate Authority."
  - <a href="https://docs.aws.amazon.com/acm-pca/">Amazon - Acm Pca</a>
- Managed CA hierarchy
- Subordinate CA configuration
- Cross-account access</p>
<p><strong>Azure Key Vault Certificates</strong>
- Microsoft. "About Azure Key Vault Certificates."
  - <a href="https://docs.microsoft.com/en-us/azure/key-vault/certificates/">Microsoft - Azure</a>
- Certificate authority integration
- Hierarchy management in cloud</p>
<p><strong>Google Certificate Authority Service</strong>
- Google Cloud. "Certificate Authority Service."
  - <a href="https://cloud.google.com/certificate-authority-service/docs">Google - Certificate Authority Service</a>
- Managed CA hierarchies
- Subordinate CA pools
- DevOps integration</p>
<h3 id="cryptographic-agility">Cryptographic Agility</h3>
<p><strong>NIST SP 800-131A - Transitioning to Cryptographic Algorithms</strong>
- NIST. "Transitioning the Use of Cryptographic Algorithms and Key Lengths." Revision 2, March 2019.
  - <a href="https://csrc.nist.gov/publications/detail/sp/800-131a/rev-2/final">Nist - Detail</a>
- Algorithm transition planning
- Deprecation timelines
- Hierarchy migration for crypto upgrades</p>
<p><strong>Post-Quantum Cryptography Transition</strong>
- NIST. "Post-Quantum Cryptography Standardization."
  - <a href="https://csrc.nist.gov/projects/post-quantum-cryptography">Nist - Post Quantum Cryptography</a>
- Quantum-resistant algorithms
- Migration strategies
- Hybrid certificate approaches</p>
<h3 id="browser-root-programs">Browser Root Programs</h3>
<p><strong>Mozilla Root Store Policy</strong>
- Mozilla. "Mozilla CA Certificate Policy." Version 2.8, 2023.
  - <a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/">Mozilla - About</a>
- Requirements for root inclusion
- Subordinate CA requirements
- Technical constraints</p>
<p><strong>Apple Root Certificate Program</strong>
- Apple. "Apple Root Certificate Program."
  - <a href="https://www.apple.com/certificateauthority/ca_program.html">Apple - Ca Program.Html</a>
- Root program requirements
- Subordinate CA restrictions</p>
<p><strong>Microsoft Trusted Root Program</strong>
- Microsoft. "Trusted Root Certificate Program Requirements."
  - <a href="https://docs.microsoft.com/en-us/security/trusted-root/program-requirements">Microsoft - Security</a>
- Root certificate requirements
- Subordinate CA issuance restrictions</p>
<h3 id="academic-research">Academic Research</h3>
<p><strong>"Measuring and Analyzing the Revocation Landscape"</strong>
- Liu, Y., et al. "An End-to-End Measurement of Certificate Revocation in the Web's PKI." ACM IMC 2015.
- Revocation mechanisms analysis
- Hierarchy impact on revocation
- Operational challenges</p>
<p><strong>"Analysis of the HTTPS Certificate Ecosystem"</strong>
- Durumeric, Z., et al. "Analysis of the HTTPS Certificate Ecosystem." ACM IMC 2013.
- Certificate hierarchy analysis at scale
- CA behavior patterns
- Security implications</p>
<p><strong>"SoK: SSL and HTTPS - Revisiting Past Challenges and Evaluating Certificate Trust Model Enhancements"</strong>
- Clark, J., van Oorschot, P.C. "SoK: SSL and HTTPS: Revisiting past challenges and evaluating certificate trust model enhancements." IEEE S&amp;P 2013.
- Trust model analysis
- Hierarchy alternatives
- Enhancement proposals</p>
<h3 id="compliance-and-audit">Compliance and Audit</h3>
<p><strong>ISO/IEC 21188 - Public Key Infrastructure for Financial Services</strong>
- ISO/IEC 21188:2018. "Information technology  Public key infrastructure for financial services  Practices and policy framework."
- Financial sector PKI requirements
- Hierarchy design for compliance
- Audit requirements</p>
<p><strong>PCI DSS Requirements for PKI</strong>
- PCI Security Standards Council. "PCI DSS v4.0 - Requirement 4: Protect Cardholder Data Transmission with Strong Cryptography."
- CA hierarchy requirements for PCI compliance
- Key management requirements</p>









  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/axonsecurity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var sidebar = document.querySelector('.md-sidebar--secondary .md-sidebar__scrollwrap');
      if (sidebar) {
        var disclaimer = document.createElement('div');
        disclaimer.className = 'md-sidebar-disclaimer';
        disclaimer.innerHTML = `
          <div class="md-typeset">
            <div class="admonition tip">
              <p class="admonition-title">Our Books</p>
              <p><a href="https://axonshield.com/book"><strong>The Invisible Certificate Management Tax and How Automation Eliminates 94% of It</strong></a></p>
            </div>
            <div class="admonition warning">
              <p class="admonition-title">Disclaimer</p>
              <p><small>This documentation is based on "best practices". We've observed these ignore 
                unique organizational needs and often prove ineffective for long-term, sustainable 
                operations and ignore strategic advanteges of building infrastructure intelligence.</small></p>
            </div>
          </div>
        `;
        sidebar.insertBefore(disclaimer, sidebar.firstChild);
      }
    });
  </script>
  

  </body>
</html>