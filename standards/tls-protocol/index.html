
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://vault.axonshield.com/standards/tls-protocol/">
      
      
        <link rel="prev" href="../pkcs-standards/">
      
      
        <link rel="next" href="../x509-standard/">
      
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>TLS Protocol - Shield Vault</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
    
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WJXPDRF2');</script>
  <!-- End Google Tag Manager -->
  
  <!-- Apollo Tracking -->
  <script>
    (function() {
      var apolloScript = document.createElement('script');
      apolloScript.type = 'text/javascript';
      apolloScript.async = true;
      apolloScript.src = 'https://cdn.apollo.io/v1/apollo.js';
      apolloScript.setAttribute('data-apollo-id', '68b8b91c5e883f0021f7f7aa');
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(apolloScript, s);
    })();
  </script>
  <!-- End Apollo Tracking -->

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tls-protocol" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Shield Vault" class="md-header__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Shield Vault
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              TLS Protocol
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Foundations for Infrastructure Intelligence - Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../book/" class="md-tabs__link">
        
  
  
    
  
  Book

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../architecture/case-studies/" class="md-tabs__link">
          
  
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../foundations/certificate-anatomy/" class="md-tabs__link">
          
  
  
  Foundations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../implementation/acme-protocol-implementation/" class="md-tabs__link">
          
  
  
  Implementation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../operations/certificate-lifecycle-management/" class="md-tabs__link">
          
  
  
  Operations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../patterns/ca-hierarchies/" class="md-tabs__link">
          
  
  
  Patterns

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../security/ca-compromise-scenarios/" class="md-tabs__link">
          
  
  
  Security

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../acme-protocol/" class="md-tabs__link">
          
  
  
  Standards

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../troubleshooting/chain-validation-errors/" class="md-tabs__link">
          
  
  
  Troubleshooting

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../vendors/digicert-certcentral/" class="md-tabs__link">
          
  
  
  Vendors

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Shield Vault" class="md-nav__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    Shield Vault
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Foundations for Infrastructure Intelligence - Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../book/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Book
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/case-studies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Case Studies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/certificate-as-code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate-as-Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/mutual-tls-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mutual TLS Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/service-mesh-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service Mesh Certificates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/zero-trust-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zero-Trust Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Foundations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Foundations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/certificate-anatomy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Anatomy
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/cryptographic-primitives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cryptographic Primitives
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/public-private-key-pairs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Public-Private Key Pairs
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/trust-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trust Models
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/what-is-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is PKI?
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Implementation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/acme-protocol-implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/ca-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Architecture
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/certificate-issuance-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Issuance Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/hsm-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HSM Integration
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/multi-cloud-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Cloud PKI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/certificate-lifecycle-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Lifecycle Management
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/certificate-rotation-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Rotation Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/inventory-and-discovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inventory and Discovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/monitoring-and-alerting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring and Alerting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/renewal-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Renewal Automation
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Patterns
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/ca-hierarchies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Hierarchies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/cloud-vs-on-premises/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud vs On-Premises
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/high-availability-disaster-recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    High Availability and Disaster Recovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/multi-tenancy-considerations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Tenancy Considerations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/ca-compromise-scenarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Compromise Scenarios
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/certificate-pinning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Pinning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/common-vulnerabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Vulnerabilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/compliance-and-audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compliance and Audit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/incident-response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Incident Response
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/key-management-best-practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Key Management Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/private-key-protection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Private Key Protection
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/threat-models-and-attack-vectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threat Models and Attack Vectors
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Standards
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Standards
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../acme-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ocsp-and-crl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OCSP and CRL
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pkcs-standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PKCS Standards
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    TLS Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    TLS Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Key Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#protocol-versions-and-evolution" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Versions and Evolution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Protocol Versions and Evolution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ssl-20-and-30-deprecated" class="md-nav__link">
    <span class="md-ellipsis">
      SSL 2.0 and 3.0 (Deprecated)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-10-deprecated" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.0 (Deprecated)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-11-deprecated" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.1 (Deprecated)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-12-current-standard" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.2 (Current Standard)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-13-modern-standard" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.3 (Modern Standard)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-tls-handshake" class="md-nav__link">
    <span class="md-ellipsis">
      The TLS Handshake
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The TLS Handshake">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tls-12-handshake-simplified" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.2 Handshake (Simplified)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-13-handshake-simplified" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.3 Handshake (Simplified)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-13-0-rtt-resumption" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.3 0-RTT Resumption
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-validation-in-tls" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Validation in TLS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Certificate Validation in TLS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validation-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-validation-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Common Validation Failures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cipher-suites" class="md-nav__link">
    <span class="md-ellipsis">
      Cipher Suites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cipher Suites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tls-12-cipher-suite-format" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.2 Cipher Suite Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-13-cipher-suite-format" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.3 Cipher Suite Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommended-cipher-suites-2024" class="md-nav__link">
    <span class="md-ellipsis">
      Recommended Cipher Suites (2024)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecated-cipher-suites" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecated Cipher Suites
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forward-secrecy" class="md-nav__link">
    <span class="md-ellipsis">
      Forward Secrecy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Forward Secrecy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#without-forward-secrecy-rsa-key-exchange" class="md-nav__link">
    <span class="md-ellipsis">
      Without Forward Secrecy (RSA Key Exchange)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-forward-secrecy-dheecdhe" class="md-nav__link">
    <span class="md-ellipsis">
      With Forward Secrecy (DHE/ECDHE)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-resumption" class="md-nav__link">
    <span class="md-ellipsis">
      Session Resumption
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session Resumption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-ids-tls-12" class="md-nav__link">
    <span class="md-ellipsis">
      Session IDs (TLS 1.2)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-tickets-tls-12" class="md-nav__link">
    <span class="md-ellipsis">
      Session Tickets (TLS 1.2+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-13-psk-resumption" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.3 PSK Resumption
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practical Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-tls-servers" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring TLS Servers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring TLS Servers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nginx-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Nginx Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apache-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Apache Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-tls-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Testing TLS Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing TLS Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-openssl-s_client" class="md-nav__link">
    <span class="md-ellipsis">
      Using OpenSSL s_client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-nmap" class="md-nav__link">
    <span class="md-ellipsis">
      Using nmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ssl-labs" class="md-nav__link">
    <span class="md-ellipsis">
      Using SSL Labs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-tls-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting TLS Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting TLS Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ssl-handshake-failed" class="md-nav__link">
    <span class="md-ellipsis">
      "SSL Handshake Failed"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-verification-failed" class="md-nav__link">
    <span class="md-ellipsis">
      "Certificate Verification Failed"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutual-tls-mtls" class="md-nav__link">
    <span class="md-ellipsis">
      Mutual TLS (mTLS)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mutual TLS (mTLS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#server-configuration-nginx" class="md-nav__link">
    <span class="md-ellipsis">
      Server Configuration (Nginx)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-configuration-curl" class="md-nav__link">
    <span class="md-ellipsis">
      Client Configuration (curl)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Use Cases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-pitfalls" class="md-nav__link">
    <span class="md-ellipsis">
      Common Pitfalls
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Security Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#known-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Known Vulnerabilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Known Vulnerabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beast-browser-exploit-against-ssltls-2011" class="md-nav__link">
    <span class="md-ellipsis">
      BEAST (Browser Exploit Against SSL/TLS) - 2011
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crime-compression-ratio-info-leak-made-easy-2012" class="md-nav__link">
    <span class="md-ellipsis">
      CRIME (Compression Ratio Info-leak Made Easy) - 2012
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heartbleed-2014" class="md-nav__link">
    <span class="md-ellipsis">
      Heartbleed - 2014
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#poodle-padding-oracle-on-downgraded-legacy-encryption-2014" class="md-nav__link">
    <span class="md-ellipsis">
      POODLE (Padding Oracle On Downgraded Legacy Encryption) - 2014
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#freak-factoring-rsa-export-keys-2015" class="md-nav__link">
    <span class="md-ellipsis">
      FREAK (Factoring RSA Export Keys) - 2015
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logjam-2015" class="md-nav__link">
    <span class="md-ellipsis">
      Logjam - 2015
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drown-decrypting-rsa-with-obsolete-and-weakened-encryption-2016" class="md-nav__link">
    <span class="md-ellipsis">
      DROWN (Decrypting RSA with Obsolete and Weakened eNcryption) - 2016
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downgrade-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Downgrade Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-pinning" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Pinning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#man-in-the-middle-mitm-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Man-in-the-Middle (MitM) Detection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Real-World Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-study-tls-13-adoption-at-cloudflare" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: TLS 1.3 Adoption at Cloudflare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-heartbleed-global-impact-2014" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: Heartbleed Global Impact (2014)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-ssltls-stripping-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: SSL/TLS Stripping Attacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      Further Reading
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Further Reading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#essential-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Essential Resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Topics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-history" class="md-nav__link">
    <span class="md-ellipsis">
      Change History
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../x509-standard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    X.509 Standard
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Troubleshooting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/chain-validation-errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chain Validation Errors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/common-misconfigurations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Misconfigurations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/expired-certificate-outages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Expired Certificate Outages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/performance-bottlenecks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Bottlenecks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Vendors
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Vendors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/digicert-certcentral/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DigiCert CertCentral
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/hashicorp-vault-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HashiCorp Vault PKI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/keyfactor-command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Keyfactor Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/venafi-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Venafi Platform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/vendor-comparison-matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vendor Comparison Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Key Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#protocol-versions-and-evolution" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Versions and Evolution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Protocol Versions and Evolution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ssl-20-and-30-deprecated" class="md-nav__link">
    <span class="md-ellipsis">
      SSL 2.0 and 3.0 (Deprecated)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-10-deprecated" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.0 (Deprecated)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-11-deprecated" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.1 (Deprecated)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-12-current-standard" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.2 (Current Standard)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-13-modern-standard" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.3 (Modern Standard)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-tls-handshake" class="md-nav__link">
    <span class="md-ellipsis">
      The TLS Handshake
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The TLS Handshake">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tls-12-handshake-simplified" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.2 Handshake (Simplified)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-13-handshake-simplified" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.3 Handshake (Simplified)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-13-0-rtt-resumption" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.3 0-RTT Resumption
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-validation-in-tls" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Validation in TLS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Certificate Validation in TLS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validation-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-validation-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Common Validation Failures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cipher-suites" class="md-nav__link">
    <span class="md-ellipsis">
      Cipher Suites
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cipher Suites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tls-12-cipher-suite-format" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.2 Cipher Suite Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-13-cipher-suite-format" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.3 Cipher Suite Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommended-cipher-suites-2024" class="md-nav__link">
    <span class="md-ellipsis">
      Recommended Cipher Suites (2024)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecated-cipher-suites" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecated Cipher Suites
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forward-secrecy" class="md-nav__link">
    <span class="md-ellipsis">
      Forward Secrecy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Forward Secrecy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#without-forward-secrecy-rsa-key-exchange" class="md-nav__link">
    <span class="md-ellipsis">
      Without Forward Secrecy (RSA Key Exchange)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-forward-secrecy-dheecdhe" class="md-nav__link">
    <span class="md-ellipsis">
      With Forward Secrecy (DHE/ECDHE)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-resumption" class="md-nav__link">
    <span class="md-ellipsis">
      Session Resumption
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Session Resumption">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-ids-tls-12" class="md-nav__link">
    <span class="md-ellipsis">
      Session IDs (TLS 1.2)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-tickets-tls-12" class="md-nav__link">
    <span class="md-ellipsis">
      Session Tickets (TLS 1.2+)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tls-13-psk-resumption" class="md-nav__link">
    <span class="md-ellipsis">
      TLS 1.3 PSK Resumption
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practical Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-tls-servers" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring TLS Servers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring TLS Servers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nginx-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Nginx Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apache-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Apache Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-tls-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Testing TLS Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing TLS Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-openssl-s_client" class="md-nav__link">
    <span class="md-ellipsis">
      Using OpenSSL s_client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-nmap" class="md-nav__link">
    <span class="md-ellipsis">
      Using nmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ssl-labs" class="md-nav__link">
    <span class="md-ellipsis">
      Using SSL Labs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-tls-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting TLS Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting TLS Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ssl-handshake-failed" class="md-nav__link">
    <span class="md-ellipsis">
      "SSL Handshake Failed"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-verification-failed" class="md-nav__link">
    <span class="md-ellipsis">
      "Certificate Verification Failed"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mutual-tls-mtls" class="md-nav__link">
    <span class="md-ellipsis">
      Mutual TLS (mTLS)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mutual TLS (mTLS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#server-configuration-nginx" class="md-nav__link">
    <span class="md-ellipsis">
      Server Configuration (Nginx)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#client-configuration-curl" class="md-nav__link">
    <span class="md-ellipsis">
      Client Configuration (curl)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Use Cases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-pitfalls" class="md-nav__link">
    <span class="md-ellipsis">
      Common Pitfalls
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Security Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#known-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Known Vulnerabilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Known Vulnerabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beast-browser-exploit-against-ssltls-2011" class="md-nav__link">
    <span class="md-ellipsis">
      BEAST (Browser Exploit Against SSL/TLS) - 2011
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crime-compression-ratio-info-leak-made-easy-2012" class="md-nav__link">
    <span class="md-ellipsis">
      CRIME (Compression Ratio Info-leak Made Easy) - 2012
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heartbleed-2014" class="md-nav__link">
    <span class="md-ellipsis">
      Heartbleed - 2014
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#poodle-padding-oracle-on-downgraded-legacy-encryption-2014" class="md-nav__link">
    <span class="md-ellipsis">
      POODLE (Padding Oracle On Downgraded Legacy Encryption) - 2014
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#freak-factoring-rsa-export-keys-2015" class="md-nav__link">
    <span class="md-ellipsis">
      FREAK (Factoring RSA Export Keys) - 2015
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logjam-2015" class="md-nav__link">
    <span class="md-ellipsis">
      Logjam - 2015
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drown-decrypting-rsa-with-obsolete-and-weakened-encryption-2016" class="md-nav__link">
    <span class="md-ellipsis">
      DROWN (Decrypting RSA with Obsolete and Weakened eNcryption) - 2016
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downgrade-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Downgrade Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-pinning" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Pinning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#man-in-the-middle-mitm-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Man-in-the-Middle (MitM) Detection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Real-World Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-study-tls-13-adoption-at-cloudflare" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: TLS 1.3 Adoption at Cloudflare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-heartbleed-global-impact-2014" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: Heartbleed Global Impact (2014)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-ssltls-stripping-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: SSL/TLS Stripping Attacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      Further Reading
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Further Reading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#essential-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Essential Resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Topics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-history" class="md-nav__link">
    <span class="md-ellipsis">
      Change History
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WJXPDRF2"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
  <!-- Right sidebar with disclaimer above TOC -->
  
    <style>
      @media screen and (min-width: 76.25em) {
        .md-sidebar--secondary {
          order: 1;
        }
        .md-sidebar--secondary::before {
          content: '';
          display: block;
          margin-bottom: 1rem;
        }
      }
    </style>
  
  
  
                  



<h1 id="tls-protocol">TLS Protocol</h1>
<blockquote>
<p><strong>TL;DR</strong>: Transport Layer Security (TLS) is the protocol that secures internet communications, providing encryption, authentication, and integrity for connections between clients and servers. TLS uses certificates for server authentication and establishes encrypted channels for data transmission. Understanding TLS is essential for securing web applications, APIs, and any network communication requiring confidentiality.</p>
</blockquote>
<h2 id="overview">Overview</h2>
<p>TLS (Transport Layer Security) and its predecessor SSL (Secure Sockets Layer) are the cryptographic protocols that enable HTTPS, secure email, VPNs, and virtually all secure internet communications. When you see the padlock icon in your browser, TLS is working behind the scenes to protect your connection.</p>
<p>The protocol evolved from SSL 2.0 (1995) through SSL 3.0 (1996) to TLS 1.0 (1999), with major improvements in TLS 1.2 (2008) and a complete redesign in TLS 1.3 (2018). Each version addressed security vulnerabilities and improved performance. As of 2024, TLS 1.2 and 1.3 are the only versions considered secureSSL and TLS 1.0/1.1 are deprecated due to known vulnerabilities<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.</p>
<p>TLS provides three critical security properties: authentication (proving server identity via certificates), confidentiality (encrypting data in transit), and integrity (detecting tampering). Understanding TLS is crucial for anyone implementing secure communications, troubleshooting connection issues, or assessing security posture.</p>
<p><strong>Related Pages</strong>: <a href="../x509-standard/">X509 Standard</a>, <a href="../../foundations/certificate-anatomy/">Certificate Anatomy</a>, <a href="../../foundations/cryptographic-primitives/">Cryptographic Primitives</a>, <a href="../../foundations/what-is-pki/">What Is Pki</a></p>
<h2 id="key-concepts">Key Concepts</h2>
<h3 id="protocol-versions-and-evolution">Protocol Versions and Evolution</h3>
<h4 id="ssl-20-and-30-deprecated">SSL 2.0 and 3.0 (Deprecated)</h4>
<p><strong>SSL 2.0</strong> (1995):</p>
<ul>
<li>Netscape's original protocol</li>
<li>Numerous security flaws</li>
<li>No longer supported anywhere</li>
<li><strong>Status</strong>: Completely broken, never use</li>
</ul>
<p><strong>SSL 3.0</strong> (1996):</p>
<ul>
<li>Complete redesign addressing SSL 2.0 flaws</li>
<li>POODLE attack (2014) demonstrated practical vulnerability<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup></li>
<li><strong>Status</strong>: Deprecated, RFC 7568 prohibits use</li>
</ul>
<h4 id="tls-10-deprecated">TLS 1.0 (Deprecated)</h4>
<p><strong>Released</strong>: 1999 (RFC 2246)
- Minor upgrade from SSL 3.0
- BEAST attack (2011) exploited CBC mode weakness
- Browser-side mitigations developed
- <strong>Status</strong>: Deprecated by major browsers in 2020
- <strong>Use</strong>: Only for legacy system compatibility (not recommended)</p>
<h4 id="tls-11-deprecated">TLS 1.1 (Deprecated)</h4>
<p><strong>Released</strong>: 2006 (RFC 4346)
- Fixed BEAST attack vulnerability
- Added protection against CBC attacks
- Limited adoption (skipped by many implementations)
- <strong>Status</strong>: Deprecated alongside TLS 1.0 in 2020
- <strong>Use</strong>: No longer supported by modern browsers</p>
<h4 id="tls-12-current-standard">TLS 1.2 (Current Standard)</h4>
<p><strong>Released</strong>: 2008 (RFC 5246<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup>)
- Added SHA-256 support (replacing SHA-1)
- Flexible cipher suite negotiation
- AEAD cipher modes (GCM, CCM)
- Widely deployed and supported
- <strong>Status</strong>: Current standard, will remain supported for years
- <strong>Use</strong>: Default for most implementations</p>
<p><strong>Key Features</strong>:</p>
<ul>
<li>Authenticated encryption with GCM mode</li>
<li>SHA-256 and SHA-384 hash functions</li>
<li>Elliptic curve cryptography support</li>
<li>Session resumption via session tickets</li>
<li>Application layer protocol negotiation (ALPN)</li>
</ul>
<h4 id="tls-13-modern-standard">TLS 1.3 (Modern Standard)</h4>
<p><strong>Released</strong>: 2018 (RFC 8446<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup>)
- Complete redesign focused on security and performance
- Reduced handshake latency (1-RTT, 0-RTT)
- Mandatory forward secrecy
- Removed obsolete cryptography
- Simplified cipher suite selection
- <strong>Status</strong>: Modern standard, increasing adoption
- <strong>Use</strong>: Preferred when both client and server support</p>
<p><strong>Major Changes from TLS 1.2</strong>:</p>
<ul>
<li><strong>Removed</strong>: RSA key exchange, static DH, CBC mode ciphers, compression, renegotiation</li>
<li><strong>Added</strong>: Only AEAD ciphers, mandatory perfect forward secrecy, encrypted handshake</li>
<li><strong>Improved</strong>: Faster handshake (0-RTT resumption), simpler cipher suite selection</li>
</ul>
<p><strong>Security Improvements</strong>:</p>
<ul>
<li>All handshake messages except ClientHello encrypted</li>
<li>Removed known-vulnerable algorithms</li>
<li>No algorithm downgrade attacks possible</li>
<li>Better resistance to timing attacks</li>
</ul>
<h3 id="the-tls-handshake">The TLS Handshake</h3>
<p>The handshake establishes a secure connection before application data transmission.</p>
<h4 id="tls-12-handshake-simplified">TLS 1.2 Handshake (Simplified)</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Client                                          Server
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>ClientHello            --------&gt;
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>                                          ServerHello
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>                                         Certificate*
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                                   ServerKeyExchange*
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                                  CertificateRequest*
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>                       &lt;--------      ServerHelloDone
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>Certificate*
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>ClientKeyExchange
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>CertificateVerify*
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>[ChangeCipherSpec]
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>Finished               --------&gt;
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>                                   [ChangeCipherSpec]
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>                       &lt;--------             Finished
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>Application Data       &lt;-------&gt;     Application Data
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>* Optional or situation-dependent messages
</code></pre></div>
<p><strong>Steps</strong>:</p>
<ol>
<li><strong>ClientHello</strong>: Client sends supported cipher suites, TLS versions, random value, session ID</li>
<li><strong>ServerHello</strong>: Server selects cipher suite, TLS version, sends random value</li>
<li><strong>Certificate</strong>: Server sends its certificate chain</li>
<li><strong>ServerKeyExchange</strong>: Server sends key exchange parameters (for DHE/ECDHE)</li>
<li><strong>CertificateRequest</strong>: Server requests client certificate (optional, for mutual TLS)</li>
<li><strong>ServerHelloDone</strong>: Server indicates hello phase complete</li>
<li><strong>Certificate</strong>: Client sends certificate (if requested)</li>
<li><strong>ClientKeyExchange</strong>: Client sends key exchange information</li>
<li><strong>CertificateVerify</strong>: Client proves possession of private key</li>
<li><strong>ChangeCipherSpec</strong>: Switch to encrypted communication</li>
<li><strong>Finished</strong>: Verify handshake integrity</li>
<li><strong>Application Data</strong>: Encrypted application data transmission begins</li>
</ol>
<p><strong>Round Trips</strong>: 2-RTT (two round-trip times)
<strong>Key Exchange Methods</strong>: RSA, DHE, ECDHE</p>
<h4 id="tls-13-handshake-simplified">TLS 1.3 Handshake (Simplified)</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Client                                          Server
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>ClientHello
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>+ key_share            --------&gt;
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>                                          ServerHello
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>                                          + key_share
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>                                {EncryptedExtensions}
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>                                {CertificateRequest*}
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>                                       {Certificate*}
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>                                 {CertificateVerify*}
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>                       &lt;--------           {Finished}
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>{Certificate*}
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>{CertificateVerify*}
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>{Finished}             --------&gt;
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>[Application Data]     &lt;-------&gt;     [Application Data]
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>* Optional or situation-dependent
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>{} Encrypted messages
</code></pre></div>
<p><strong>Major Differences</strong>:</p>
<ul>
<li><strong>1-RTT</strong>: Client sends key share in first message, reducing latency</li>
<li><strong>0-RTT</strong>: Resumption can send data in first packet (with replay risk)</li>
<li><strong>Encrypted</strong>: All handshake messages after ServerHello encrypted</li>
<li><strong>Simplified</strong>: No separate ChangeCipherSpec, cleaner state machine</li>
</ul>
<p><strong>Performance</strong>: ~40% faster than TLS 1.2 (1-RTT vs 2-RTT)</p>
<h4 id="tls-13-0-rtt-resumption">TLS 1.3 0-RTT Resumption</h4>
<p>For resumed connections, TLS 1.3 allows 0-RTT data:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Client                                          Server
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>ClientHello
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>+ early_data
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>+ key_share
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>(Application Data)     --------&gt;
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>                                          ServerHello
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>                                          + key_share
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>                                {EncryptedExtensions}
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>                       &lt;--------           {Finished}
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>[Application Data]     &lt;-------&gt;     [Application Data]
</code></pre></div>
<p><strong>Advantages</strong>: Eliminates handshake latency completely
<strong>Risks</strong>: Replay attacks possible (application must be idempotent)
<strong>Use Case</strong>: Non-state-changing requests (GET requests, not POST)</p>
<h3 id="certificate-validation-in-tls">Certificate Validation in TLS</h3>
<p>The server certificate is validated during the handshake:</p>
<h4 id="validation-steps">Validation Steps</h4>
<ol>
<li><strong>Build Certificate Chain</strong>: From server certificate to trusted root</li>
<li>Use intermediate certificates provided by server</li>
<li>
<p>Use Authority Information Access extension if intermediates missing</p>
</li>
<li>
<p><strong>Verify Signatures</strong>: Each certificate signed by next in chain</p>
</li>
<li>Verify cryptographic signature using issuer's public key</li>
<li>
<p>Ensure signature algorithm is acceptable (no SHA-1)</p>
</li>
<li>
<p><strong>Check Validity Dates</strong>: All certificates must be currently valid</p>
</li>
<li>Current time between notBefore and notAfter</li>
<li>
<p>Check entire chain, including intermediates</p>
</li>
<li>
<p><strong>Verify Hostname</strong>: Certificate must match server hostname</p>
</li>
<li>Check Subject Alternative Name extension for DNS names</li>
<li>Perform wildcard matching if applicable (*.example.com)</li>
<li>
<p>Common Name (CN) field deprecated, not checked by modern browsers</p>
</li>
<li>
<p><strong>Check Revocation Status</strong>: Verify no certificates revoked</p>
</li>
<li>OCSP query to certificate authority</li>
<li>Or CRL download and check</li>
<li>
<p>Or OCSP stapling (server provides OCSP response)</p>
</li>
<li>
<p><strong>Verify Trust</strong>: Root certificate must be in trust store</p>
</li>
<li>Operating system or browser trust store</li>
<li>Enterprise-managed trust stores</li>
<li>
<p>Explicitly trusted roots</p>
</li>
<li>
<p><strong>Check Extended Validation</strong>: For EV certificates</p>
</li>
<li>Verify EV policies in certificate</li>
<li>Display organization name in browser UI</li>
</ol>
<h4 id="common-validation-failures">Common Validation Failures</h4>
<p><strong>Hostname Mismatch</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Connecting to: www.example.com
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>Certificate Subject Alternative Name: api.example.com
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>Error: Hostname mismatch
</code></pre></div></p>
<p><strong>Expired Certificate</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>Certificate Valid: 2023-01-01 to 2024-01-01
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>Current Date: 2024-06-01
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>Error: Certificate expired
</code></pre></div></p>
<p><strong>Untrusted Root</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>Certificate Chain:
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>  www.example.com (leaf)
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>  Intermediate CA
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>  Root CA (not in trust store)
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>Error: Unable to verify certificate chain
</code></pre></div></p>
<p><strong>Revoked Certificate</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>OCSP Response: Revoked
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>Revocation Date: 2024-05-15
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>Error: Certificate has been revoked
</code></pre></div></p>
<h3 id="cipher-suites">Cipher Suites</h3>
<p>Cipher suites define the cryptographic algorithms used for key exchange, authentication, encryption, and integrity.</p>
<h4 id="tls-12-cipher-suite-format">TLS 1.2 Cipher Suite Format</h4>
<p>Format: <code>TLS_&lt;KeyExchange&gt;_WITH_&lt;Encryption&gt;_&lt;MAC&gt;</code></p>
<p><strong>Example</strong>: <code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code></p>
<ul>
<li><strong>Key Exchange</strong>: ECDHE (Elliptic Curve Diffie-Hellman Ephemeral)</li>
<li><strong>Authentication</strong>: RSA (server certificate signature algorithm)</li>
<li><strong>Encryption</strong>: AES_128_GCM (128-bit AES in Galois/Counter Mode)</li>
<li><strong>MAC</strong>: SHA256 (GCM includes authentication, SHA256 for handshake)</li>
</ul>
<h4 id="tls-13-cipher-suite-format">TLS 1.3 Cipher Suite Format</h4>
<p>Simplified: <code>TLS_&lt;Encryption&gt;_&lt;Hash&gt;</code></p>
<p><strong>Example</strong>: <code>TLS_AES_128_GCM_SHA256</code></p>
<ul>
<li><strong>Encryption</strong>: AES_128_GCM</li>
<li><strong>Hash</strong>: SHA256</li>
</ul>
<p><strong>Note</strong>: Key exchange and authentication are negotiated separately (always ECDHE, always ECDSA or RSA)</p>
<h4 id="recommended-cipher-suites-2024">Recommended Cipher Suites (2024)</h4>
<p><strong>TLS 1.3</strong> (Preferred):
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>TLS_AES_256_GCM_SHA384
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>TLS_CHACHA20_POLY1305_SHA256
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>TLS_AES_128_GCM_SHA256
</code></pre></div></p>
<p><strong>TLS 1.2</strong> (Fallback):
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
</code></pre></div></p>
<h4 id="deprecated-cipher-suites">Deprecated Cipher Suites</h4>
<p><strong>Never Use</strong>:</p>
<ul>
<li>Any cipher with <code>RC4</code> (broken stream cipher)</li>
<li>Any cipher with <code>MD5</code> (broken hash function)</li>
<li>Any cipher with <code>DES</code> or <code>3DES</code> (weak encryption)</li>
<li>Any cipher with <code>EXPORT</code> (intentionally weakened)</li>
<li>Any cipher with <code>NULL</code> (no encryption)</li>
<li>Any cipher with <code>CBC</code> mode in TLS 1.2 without proper mitigations (BEAST, Lucky13)</li>
</ul>
<p><strong>Example Bad Ciphers</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>TLS_RSA_WITH_RC4_128_MD5
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>TLS_RSA_EXPORT_WITH_DES40_CBC_SHA
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>TLS_RSA_WITH_NULL_SHA
</code></pre></div></p>
<h3 id="forward-secrecy">Forward Secrecy</h3>
<p>Forward secrecy (also called perfect forward secrecy, PFS) ensures that compromise of long-term keys doesn't compromise past session keys.</p>
<h4 id="without-forward-secrecy-rsa-key-exchange">Without Forward Secrecy (RSA Key Exchange)</h4>
<p><strong>TLS 1.2 RSA Key Exchange</strong>:
1. Client encrypts session key with server's RSA public key
2. Server decrypts session key with RSA private key
3. Both parties use session key for symmetric encryption</p>
<p><strong>Problem</strong>: Attacker who records encrypted traffic can decrypt it later if they obtain the server's RSA private key.</p>
<p><strong>Attack Scenario</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>2024: Attacker captures encrypted TLS traffic (can&#39;t decrypt)
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>2025: Attacker compromises server, steals RSA private key
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>2025: Attacker decrypts all captured 2024 traffic
</code></pre></div></p>
<h4 id="with-forward-secrecy-dheecdhe">With Forward Secrecy (DHE/ECDHE)</h4>
<p><strong>TLS 1.2+ with ECDHE</strong>:
1. Client and server perform Diffie-Hellman key exchange with ephemeral keys
2. Ephemeral keys are temporary, destroyed after session
3. Session key derived from DH exchange, never transmitted</p>
<p><strong>Protection</strong>: Even if long-term private key compromised, past session keys remain secure (ephemeral keys destroyed).</p>
<p><strong>TLS 1.3 Mandate</strong>: All TLS 1.3 cipher suites provide forward secrecy (DHE/ECDHE only).</p>
<h3 id="session-resumption">Session Resumption</h3>
<p>Resumption allows skipping expensive handshake for repeat connections.</p>
<h4 id="session-ids-tls-12">Session IDs (TLS 1.2)</h4>
<p><strong>Process</strong>:
1. Full handshake, server assigns session ID
2. Client caches session ID and master secret
3. Subsequent connection: Client sends session ID
4. Server looks up session, resumes if found
5. Abbreviated handshake (skip certificate exchange)</p>
<p><strong>Limitations</strong>:</p>
<ul>
<li>Server must maintain session cache</li>
<li>Not practical for load-balanced servers</li>
<li>Session cache requires memory</li>
</ul>
<h4 id="session-tickets-tls-12">Session Tickets (TLS 1.2+)</h4>
<p><strong>Process</strong>:
1. Full handshake completes
2. Server encrypts session state, sends as ticket to client
3. Client stores ticket
4. Subsequent connection: Client sends ticket
5. Server decrypts ticket, resumes session</p>
<p><strong>Advantages</strong>:</p>
<ul>
<li>Server doesn't maintain state (stateless)</li>
<li>Works across load-balanced servers</li>
<li>Client stores encrypted session state</li>
</ul>
<p><strong>Security</strong>: Ticket encryption key must be rotated regularly and shared securely across servers.</p>
<h4 id="tls-13-psk-resumption">TLS 1.3 PSK Resumption</h4>
<p><strong>Pre-Shared Key</strong> mode:</p>
<ul>
<li>Server sends PSK after handshake</li>
<li>Client uses PSK for future connections</li>
<li>Enables 1-RTT or 0-RTT resumption</li>
</ul>
<p><strong>Security Considerations</strong>:</p>
<ul>
<li>0-RTT vulnerable to replay attacks</li>
<li>PSK should expire after reasonable time</li>
<li>Not forward secret (PSK compromise affects resumed sessions)</li>
</ul>
<h2 id="practical-guidance">Practical Guidance</h2>
<h3 id="configuring-tls-servers">Configuring TLS Servers</h3>
<h4 id="nginx-configuration">Nginx Configuration</h4>
<p><strong>Modern, Secure Configuration</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="s">ssl</span><span class="w"> </span><span class="s">http2</span><span class="p">;</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="kn">server_name</span><span class="w"> </span><span class="s">example.com</span><span class="p">;</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="c1"># Certificates</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="kn">ssl_certificate</span><span class="w"> </span><span class="s">/etc/ssl/certs/example.com.crt</span><span class="p">;</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">    </span><span class="kn">ssl_certificate_key</span><span class="w"> </span><span class="s">/etc/ssl/private/example.com.key</span><span class="p">;</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">    </span><span class="kn">ssl_trusted_certificate</span><span class="w"> </span><span class="s">/etc/ssl/certs/ca-chain.crt</span><span class="p">;</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">    </span><span class="c1"># Protocols</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">    </span><span class="kn">ssl_protocols</span><span class="w"> </span><span class="s">TLSv1.2</span><span class="w"> </span><span class="s">TLSv1.3</span><span class="p">;</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">    </span><span class="c1"># TLS 1.3 cipher suites (automatically preferred)</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">    </span><span class="c1"># TLS 1.2 cipher suites</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">    </span><span class="kn">ssl_ciphers</span><span class="w"> </span><span class="s">&#39;ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-CHACHA20-POLY1305&#39;</span><span class="p">;</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">    </span><span class="kn">ssl_prefer_server_ciphers</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">    </span><span class="c1"># OCSP Stapling</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">    </span><span class="kn">ssl_stapling</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">    </span><span class="kn">ssl_stapling_verify</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">    </span><span class="kn">resolver</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.8.8</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.4.4</span><span class="w"> </span><span class="s">valid=300s</span><span class="p">;</span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a>
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">    </span><span class="c1"># Session resumption</span>
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="w">    </span><span class="kn">ssl_session_cache</span><span class="w"> </span><span class="s">shared:SSL:10m</span><span class="p">;</span>
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="w">    </span><span class="kn">ssl_session_timeout</span><span class="w"> </span><span class="mi">10m</span><span class="p">;</span>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="w">    </span><span class="kn">ssl_session_tickets</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="w">    </span><span class="c1"># HSTS (optional but recommended)</span>
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a><span class="w">    </span><span class="kn">add_header</span><span class="w"> </span><span class="s">Strict-Transport-Security</span><span class="w"> </span><span class="s">&quot;max-age=31536000</span><span class="p">;</span><span class="w"> </span><span class="kn">includeSubDomains&quot;</span><span class="w"> </span><span class="s">always</span><span class="p">;</span>
<a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a>
<a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a><span class="w">    </span><span class="c1"># Diffie-Hellman parameters (TLS 1.2)</span>
<a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="w">    </span><span class="kn">ssl_dhparam</span><span class="w"> </span><span class="s">/etc/ssl/certs/dhparam.pem</span><span class="p">;</span>
<a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a><span class="p">}</span>
</code></pre></div></p>
<p><strong>Generate DH Parameters</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>openssl<span class="w"> </span>dhparam<span class="w"> </span>-out<span class="w"> </span>/etc/ssl/certs/dhparam.pem<span class="w"> </span><span class="m">2048</span>
</code></pre></div></p>
<h4 id="apache-configuration">Apache Configuration</h4>
<p><strong>Modern Configuration</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nt">&lt;VirtualHost</span><span class="w"> </span><span class="s">*:443</span><span class="nt">&gt;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">    </span><span class="nb">ServerName</span><span class="w"> </span>example.com
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">    </span><span class="c"># Certificates</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="nb">SSLCertificateFile</span><span class="w"> </span><span class="sx">/etc/ssl/certs/example.com.crt</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span><span class="nb">SSLCertificateKeyFile</span><span class="w"> </span><span class="sx">/etc/ssl/private/example.com.key</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">    </span><span class="nb">SSLCertificateChainFile</span><span class="w"> </span><span class="sx">/etc/ssl/certs/ca-chain.crt</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">    </span><span class="c"># Protocols</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">    </span><span class="nb">SSLProtocol</span><span class="w"> </span>-all<span class="w"> </span>+TLSv1.2<span class="w"> </span>+TLSv1.3
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">    </span><span class="c"># Cipher suites</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="w">    </span><span class="nb">SSLCipherSuite</span><span class="w"> </span>ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-CHACHA20-POLY1305
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="w">    </span><span class="nb">SSLHonorCipherOrder</span><span class="w"> </span><span class="k">on</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="w">    </span><span class="c"># OCSP Stapling</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">    </span><span class="nb">SSLUseStapling</span><span class="w"> </span><span class="k">on</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="w">    </span><span class="nb">SSLStaplingCache</span><span class="w"> </span><span class="s2">&quot;shmcb:logs/ssl_stapling(32768)&quot;</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="w">    </span><span class="c"># Session cache</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="w">    </span><span class="nb">SSLSessionCache</span><span class="w"> </span><span class="s2">&quot;shmcb:logs/ssl_scache(512000)&quot;</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="w">    </span><span class="nb">SSLSessionCacheTimeout</span><span class="w"> </span><span class="m">300</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="w">    </span><span class="c"># HSTS</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="w">    </span><span class="nb">Header</span><span class="w"> </span>always<span class="w"> </span>set<span class="w"> </span>Strict-Transport-Security<span class="w"> </span><span class="s2">&quot;max-age=31536000; includeSubDomains&quot;</span>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="nt">&lt;/VirtualHost&gt;</span>
</code></pre></div></p>
<h3 id="testing-tls-configuration">Testing TLS Configuration</h3>
<h4 id="using-openssl-s_client">Using OpenSSL s_client</h4>
<p><strong>Test Connection</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-servername<span class="w"> </span>example.com
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1"># Output shows:</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="c1"># - TLS version negotiated</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1"># - Cipher suite selected</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c1"># - Certificate chain</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="c1"># - Verification result</span>
</code></pre></div></p>
<p><strong>Test Specific TLS Version</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Test TLS 1.3</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-tls1_3
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1"># Test TLS 1.2</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-tls1_2
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="c1"># Should fail - deprecated</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-tls1_1
</code></pre></div></p>
<p><strong>Test Specific Cipher</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-cipher<span class="w"> </span><span class="s1">&#39;ECDHE-RSA-AES256-GCM-SHA384&#39;</span>
</code></pre></div></p>
<p><strong>Extract Certificate</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="nb">echo</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-servername<span class="w"> </span>example.com<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>x509<span class="w"> </span>-text
</code></pre></div></p>
<h4 id="using-nmap">Using nmap</h4>
<p><strong>Scan TLS Configuration</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>nmap<span class="w"> </span>--script<span class="w"> </span>ssl-enum-ciphers<span class="w"> </span>-p<span class="w"> </span><span class="m">443</span><span class="w"> </span>example.com
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c1"># Shows:</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c1"># - Supported TLS versions</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c1"># - Cipher suites per version</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="c1"># - Strength ratings</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c1"># - Warnings about weak ciphers</span>
</code></pre></div></p>
<h4 id="using-ssl-labs">Using SSL Labs</h4>
<p><strong>Online Testing</strong>:</p>
<ul>
<li>Visit: <a href="https://www.ssllabs.com/ssltest/">Ssllabs - Ssltest</a></li>
<li>Enter domain name</li>
<li>Comprehensive report includes:</li>
<li>Protocol support</li>
<li>Cipher suite evaluation</li>
<li>Certificate validation</li>
<li>Known vulnerability checks</li>
<li>Grade (A+ to F)</li>
</ul>
<p><strong>Automated Testing</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Install ssllabs-scan tool</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>go<span class="w"> </span>install<span class="w"> </span>github.com/ssllabs/ssllabs-scan/v3@latest
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="c1"># Run scan</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>ssllabs-scan<span class="w"> </span>example.com
</code></pre></div></p>
<h3 id="troubleshooting-tls-issues">Troubleshooting TLS Issues</h3>
<h4 id="ssl-handshake-failed">"SSL Handshake Failed"</h4>
<p><strong>Diagnosis</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-servername<span class="w"> </span>example.com<span class="w"> </span>-debug
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="c1"># Check for:</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="c1"># - No shared cipher suites</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="c1"># - Protocol version mismatch</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="c1"># - Certificate validation failure</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="c1"># - Network connectivity issues</span>
</code></pre></div></p>
<p><strong>Common Causes</strong>:
1. <strong>No Shared Ciphers</strong>: Client and server have no common cipher suites
   - <strong>Fix</strong>: Update cipher suite configuration on server or client</p>
<ol>
<li><strong>Protocol Mismatch</strong>: Client only supports TLS 1.3, server only TLS 1.2</li>
<li>
<p><strong>Fix</strong>: Enable appropriate protocols on both sides</p>
</li>
<li>
<p><strong>Certificate Issues</strong>: Expired, hostname mismatch, untrusted</p>
</li>
<li><strong>Fix</strong>: Renew certificate, fix Subject Alternative Names, ensure trust chain</li>
</ol>
<h4 id="certificate-verification-failed">"Certificate Verification Failed"</h4>
<p><strong>Check Certificate</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># View certificate details</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-servername<span class="w"> </span>example.com<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>x509<span class="w"> </span>-noout<span class="w"> </span>-text
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c1"># Check dates</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-servername<span class="w"> </span>example.com<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>x509<span class="w"> </span>-noout<span class="w"> </span>-dates
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c1"># Check subject alternative names</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-servername<span class="w"> </span>example.com<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>x509<span class="w"> </span>-noout<span class="w"> </span>-ext<span class="w"> </span>subjectAltName
</code></pre></div></p>
<p><strong>Verify Chain</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># Verify full chain</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-servername<span class="w"> </span>example.com<span class="w"> </span>-showcerts
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c1"># Save certificates to files, then verify</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>openssl<span class="w"> </span>verify<span class="w"> </span>-CAfile<span class="w"> </span>root.pem<span class="w"> </span>-untrusted<span class="w"> </span>intermediate.pem<span class="w"> </span>server.pem
</code></pre></div></p>
<h4 id="performance-issues">Performance Issues</h4>
<p><strong>Enable HTTP/2</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="s">ssl</span><span class="w"> </span><span class="s">http2</span><span class="p">;</span><span class="w">  </span><span class="c1"># Nginx</span>
</code></pre></div></p>
<p><strong>Optimize Session Resumption</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">ssl_session_cache</span><span class="w"> </span><span class="s">shared:SSL:50m</span><span class="p">;</span><span class="w">  </span><span class="c1"># Larger cache</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="k">ssl_session_timeout</span><span class="w"> </span><span class="s">1d</span><span class="p">;</span><span class="w">            </span><span class="c1"># Longer timeout</span>
</code></pre></div></p>
<p><strong>Enable OCSP Stapling</strong> (reduces client-side OCSP queries):
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="k">ssl_stapling</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="k">ssl_stapling_verify</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
</code></pre></div></p>
<p><strong>Use TLS 1.3</strong> (faster handshake):</p>
<ul>
<li>Ensure client and server both support TLS 1.3</li>
<li>1-RTT handshake vs 2-RTT in TLS 1.2</li>
</ul>
<h3 id="mutual-tls-mtls">Mutual TLS (mTLS)</h3>
<p>Client authentication using certificates.</p>
<h4 id="server-configuration-nginx">Server Configuration (Nginx)</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="s">ssl</span><span class="p">;</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">    </span><span class="c1"># Server certificate</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">    </span><span class="kn">ssl_certificate</span><span class="w"> </span><span class="s">/etc/ssl/certs/server.crt</span><span class="p">;</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">    </span><span class="kn">ssl_certificate_key</span><span class="w"> </span><span class="s">/etc/ssl/private/server.key</span><span class="p">;</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="w">    </span><span class="c1"># Client certificate validation</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="w">    </span><span class="kn">ssl_client_certificate</span><span class="w"> </span><span class="s">/etc/ssl/certs/client-ca.crt</span><span class="p">;</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="w">    </span><span class="kn">ssl_verify_client</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="w">    </span><span class="kn">ssl_verify_depth</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="w">    </span><span class="c1"># Optional: make certain locations require client cert</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a><span class="w">    </span><span class="kn">location</span><span class="w"> </span><span class="s">/api/</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="w">        </span><span class="kn">if</span><span class="w"> </span><span class="s">(</span><span class="nv">$ssl_client_verify</span><span class="w"> </span><span class="s">!=</span><span class="w"> </span><span class="s">SUCCESS)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a><span class="w">            </span><span class="kn">return</span><span class="w"> </span><span class="mi">403</span><span class="p">;</span>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a><span class="p">}</span>
</code></pre></div>
<h4 id="client-configuration-curl">Client Configuration (curl)</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>curl<span class="w"> </span>https://example.com/api<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">  </span>--cert<span class="w"> </span>client.crt<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">  </span>--key<span class="w"> </span>client.key<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">  </span>--cacert<span class="w"> </span>server-ca.crt
</code></pre></div>
<h4 id="use-cases">Use Cases</h4>
<ul>
<li><strong>B2B APIs</strong>: Partner authentication</li>
<li><strong>Service Mesh</strong>: Inter-service authentication (Istio, Linkerd)</li>
<li><strong>IoT</strong>: Device authentication</li>
<li><strong>Zero Trust</strong>: Every connection authenticated</li>
<li><strong>VPN</strong>: Certificate-based VPN authentication</li>
</ul>
<h2 id="common-pitfalls">Common Pitfalls</h2>
<ul>
<li><strong>Using deprecated TLS versions</strong>: Enabling SSL 3.0, TLS 1.0, or TLS 1.1</li>
<li><strong>Why it happens</strong>: Legacy compatibility requirements; outdated documentation</li>
<li><strong>How to avoid</strong>: TLS 1.2 minimum, prefer TLS 1.3; reject connections from old clients</li>
<li>
<p><strong>How to fix</strong>: Update server configuration; notify clients to upgrade; set deprecation timeline</p>
</li>
<li>
<p><strong>Weak cipher suites enabled</strong>: Allowing RC4, DES, or CBC-mode ciphers</p>
</li>
<li><strong>Why it happens</strong>: Default configurations; compatibility concerns</li>
<li><strong>How to avoid</strong>: Explicitly configure strong ciphers; use cipher suite scanning tools</li>
<li>
<p><strong>How to fix</strong>: Update cipher suite list; restart server; test with SSL Labs</p>
</li>
<li>
<p><strong>Missing intermediate certificates</strong>: Server not sending full certificate chain</p>
</li>
<li><strong>Why it happens</strong>: Misconfiguration; only installing leaf certificate</li>
<li><strong>How to avoid</strong>: Install complete chain; verify with openssl s_client -showcerts</li>
<li>
<p><strong>How to fix</strong>: Concatenate intermediate and leaf certificates; update server configuration</p>
</li>
<li>
<p><strong>OCSP stapling not enabled</strong>: Client must query OCSP responder directly</p>
</li>
<li><strong>Why it happens</strong>: Not aware of stapling; complexity of configuration</li>
<li><strong>How to avoid</strong>: Enable OCSP stapling in server configuration; verify with SSL Labs</li>
<li>
<p><strong>How to fix</strong>: Configure stapling; ensure OCSP responder reachable; test</p>
</li>
<li>
<p><strong>Inadequate session cache</strong>: Poor performance due to full handshakes</p>
</li>
<li><strong>Why it happens</strong>: Default cache too small; cache not shared across workers</li>
<li><strong>How to avoid</strong>: Configure appropriate cache size; use shared memory cache</li>
<li><strong>How to fix</strong>: Increase cache size; enable session tickets; monitor cache hit rate</li>
</ul>
<h2 id="security-considerations">Security Considerations</h2>
<h3 id="known-vulnerabilities">Known Vulnerabilities</h3>
<h4 id="beast-browser-exploit-against-ssltls-2011">BEAST (Browser Exploit Against SSL/TLS) - 2011</h4>
<p><strong>Affected</strong>: TLS 1.0, SSL 3.0 with CBC-mode ciphers
<strong>Attack</strong>: Exploits CBC IV predictability to decrypt encrypted data
<strong>Mitigation</strong>: TLS 1.1+ (fixes IV handling), or RC4 (later found vulnerable itself)
<strong>Status</strong>: Mitigated in browsers, TLS 1.0 deprecated</p>
<h4 id="crime-compression-ratio-info-leak-made-easy-2012">CRIME (Compression Ratio Info-leak Made Easy) - 2012</h4>
<p><strong>Affected</strong>: TLS with compression enabled
<strong>Attack</strong>: Uses compression ratio to guess secret data (e.g., session cookies)
<strong>Mitigation</strong>: Disable TLS compression
<strong>Status</strong>: Compression disabled by default in modern implementations</p>
<h4 id="heartbleed-2014">Heartbleed - 2014</h4>
<p><strong>Affected</strong>: OpenSSL 1.0.1 through 1.0.1f
<strong>Attack</strong>: Buffer over-read in heartbeat extension allows memory disclosure
<strong>Mitigation</strong>: Update OpenSSL, regenerate keys and certificates
<strong>Status</strong>: Fixed in OpenSSL 1.0.1g, but demonstrated need for memory safety</p>
<h4 id="poodle-padding-oracle-on-downgraded-legacy-encryption-2014">POODLE (Padding Oracle On Downgraded Legacy Encryption) - 2014</h4>
<p><strong>Affected</strong>: SSL 3.0
<strong>Attack</strong>: Padding oracle attack against CBC mode in SSL 3.0
<strong>Mitigation</strong>: Disable SSL 3.0 completely (RFC 7568)
<strong>Status</strong>: SSL 3.0 completely deprecated</p>
<h4 id="freak-factoring-rsa-export-keys-2015">FREAK (Factoring RSA Export Keys) - 2015</h4>
<p><strong>Affected</strong>: Implementations accepting EXPORT cipher suites
<strong>Attack</strong>: Downgrade attack to 512-bit RSA (easily factored)
<strong>Mitigation</strong>: Disable EXPORT cipher suites
<strong>Status</strong>: EXPORT ciphers removed from modern configurations</p>
<h4 id="logjam-2015">Logjam - 2015</h4>
<p><strong>Affected</strong>: DHE key exchange with weak DH parameters
<strong>Attack</strong>: Precomputation attack on commonly used 512-bit and 1024-bit DH primes
<strong>Mitigation</strong>: Use 2048-bit+ DH parameters, prefer ECDHE
<strong>Status</strong>: Modern configs use strong DH parameters or ECDHE</p>
<h4 id="drown-decrypting-rsa-with-obsolete-and-weakened-encryption-2016">DROWN (Decrypting RSA with Obsolete and Weakened eNcryption) - 2016</h4>
<p><strong>Affected</strong>: Servers supporting both SSLv2 and modern TLS
<strong>Attack</strong>: SSLv2 weakness used to decrypt TLS sessions using same RSA key
<strong>Mitigation</strong>: Disable SSLv2 completely
<strong>Status</strong>: SSLv2 removed from all modern implementations</p>
<h3 id="downgrade-attacks">Downgrade Attacks</h3>
<p><strong>Problem</strong>: Attacker manipulates handshake to force use of weaker protocols/ciphers</p>
<p><strong>Example</strong>: Man-in-the-middle removes TLS 1.3 from ClientHello, forcing TLS 1.2</p>
<p><strong>Mitigations</strong>:</p>
<ul>
<li><strong>TLS_FALLBACK_SCSV</strong>: Signaling cipher suite value prevents version rollback</li>
<li><strong>TLS 1.3 Design</strong>: Downgrade protection built into protocol</li>
<li><strong>Certificate Transparency</strong>: Monitor for unexpected certificate issuance</li>
</ul>
<p><strong>Server Configuration</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1"># Don&#39;t support old protocols that enable downgrade</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="k">ssl_protocols</span><span class="w"> </span><span class="s">TLSv1.2</span><span class="w"> </span><span class="s">TLSv1.3</span><span class="p">;</span>
</code></pre></div></p>
<h3 id="certificate-pinning">Certificate Pinning</h3>
<p><strong>Concept</strong>: Application only accepts specific certificates or public keys</p>
<p><strong>Types</strong>:</p>
<ul>
<li><strong>Certificate Pinning</strong>: Pin entire certificate</li>
<li><strong>Public Key Pinning</strong>: Pin public key (survives certificate renewal)</li>
<li><strong>CA Pinning</strong>: Pin intermediate or root CA</li>
</ul>
<p><strong>HTTP Public Key Pinning (HPKP)</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>Public-Key-Pins: pin-sha256=&quot;base64==&quot;; max-age=5184000; includeSubDomains
</code></pre></div></p>
<p><strong>Status</strong>: HPKP deprecated due to operational risks (pin mismatch bricks site)</p>
<p><strong>Modern Alternative</strong>: Certificate Transparency monitoring instead of pinning</p>
<p><strong>Mobile Apps</strong>: Still use certificate/public key pinning for additional security</p>
<h3 id="man-in-the-middle-mitm-detection">Man-in-the-Middle (MitM) Detection</h3>
<p><strong>Indicators</strong>:</p>
<ul>
<li>Certificate hostname mismatch</li>
<li>Untrusted root certificate</li>
<li>Self-signed certificate warnings</li>
<li>Certificate with suspicious issuance date</li>
<li>Different certificate than expected (compare fingerprints)</li>
</ul>
<p><strong>Protection</strong>:</p>
<ul>
<li>Never ignore certificate warnings</li>
<li>Verify certificate fingerprints out-of-band</li>
<li>Use Certificate Transparency monitoring</li>
<li>Implement certificate pinning in controlled environments</li>
</ul>
<h2 id="real-world-examples">Real-World Examples</h2>
<h3 id="case-study-tls-13-adoption-at-cloudflare">Case Study: TLS 1.3 Adoption at Cloudflare</h3>
<p><strong>Implementation</strong>: Cloudflare enabled TLS 1.3 for all customers in 2018</p>
<p><strong>Results</strong>:</p>
<ul>
<li>40% reduction in handshake latency</li>
<li>Improved mobile performance (fewer round trips)</li>
<li>Enhanced security (mandatory forward secrecy)</li>
<li>No compatibility issues with major browsers</li>
</ul>
<p><strong>Key Takeaway</strong>: TLS 1.3 provides significant performance and security benefits with minimal deployment complexity.</p>
<h3 id="case-study-heartbleed-global-impact-2014">Case Study: Heartbleed Global Impact (2014)</h3>
<p><strong>Vulnerability</strong>: OpenSSL buffer over-read allowed memory disclosure</p>
<p><strong>Impact</strong>:</p>
<ul>
<li>17% of secure web servers vulnerable</li>
<li>Private keys, session keys, user credentials exposed</li>
<li>Required certificate regeneration and revocation</li>
<li>Demonstrated critical infrastructure dependency on OpenSSL</li>
</ul>
<p><strong>Response</strong>:</p>
<ul>
<li>Immediate patching of OpenSSL</li>
<li>Mass certificate revocation and reissuance</li>
<li>Increased funding for OpenSSL development</li>
<li>Birth of alternative TLS libraries (BoringSSL, LibreSSL)</li>
</ul>
<p><strong>Key Takeaway</strong>: Critical cryptographic libraries need proper funding, auditing, and architectural review.</p>
<h3 id="case-study-ssltls-stripping-attacks">Case Study: SSL/TLS Stripping Attacks</h3>
<p><strong>Attack</strong>: Moxie Marlinspike's sslstrip (2009) demonstrated converting HTTPS to HTTP</p>
<p><strong>Process</strong>:
1. Attacker performs MitM on network
2. Rewrites HTTPS links to HTTP
3. User thinks they're secure but connection is plaintext
4. Attacker sees all traffic</p>
<p><strong>Mitigation</strong>: HTTP Strict Transport Security (HSTS)
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
</code></pre></div></p>
<p><strong>HSTS Preload</strong>: Browsers ship with list of domains that must use HTTPS</p>
<p><strong>Key Takeaway</strong>: HTTPS alone isn't enough; HSTS enforcement prevents downgrade attacks.</p>
<h2 id="further-reading">Further Reading</h2>
<h3 id="essential-resources">Essential Resources</h3>
<ul>
<li><a href="https://www.rfc-editor.org/rfc/rfc8446">RFC 8446 - TLS 1.3</a> - Current TLS standard</li>
<li><a href="https://www.rfc-editor.org/rfc/rfc5246">RFC 5246 - TLS 1.2</a> - Previous TLS standard</li>
<li><a href="https://ssl-config.mozilla.org/">Mozilla SSL Configuration Generator</a> - Recommended server configurations</li>
<li><a href="https://www.ssllabs.com/ssltest/">SSL Labs Server Test</a> - Comprehensive TLS testing</li>
</ul>
<h3 id="advanced-topics">Advanced Topics</h3>
<ul>
<li><a href="../ocsp-and-crl/">Ocsp And Crl</a> - Certificate revocation in TLS</li>
<li><a href="../../foundations/certificate-anatomy/">Certificate Anatomy</a> - Certificates used in TLS</li>
<li><a href="../../foundations/cryptographic-primitives/">Cryptographic Primitives</a> - Algorithms used by TLS</li>
<li><a href="../../architecture/mutual-tls-patterns/">Mutual Tls Patterns</a> - Client certificate authentication</li>
</ul>
<h2 id="references">References</h2>
<h2 id="change-history">Change History</h2>
<table>
<thead>
<tr>
<th>Date</th>
<th>Version</th>
<th>Changes</th>
<th>Reason</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-11-09</td>
<td>1.0</td>
<td>Initial creation</td>
<td>Core protocol standard documentation</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Quality Checks</strong>: </p>
<ul>
<li>[x] All claims cited from authoritative sources</li>
<li>[x] Cross-references validated</li>
<li>[x] Practical guidance included</li>
<li>[x] Examples are current and relevant</li>
<li>[x] Security considerations addressed</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>IETF. "Deprecating TLS 1.0 and TLS 1.1." RFC 8996, March 2021. <a href="https://www.rfc-editor.org/rfc/rfc8996">Rfc-editor - Rfc8996</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Mller, B., et al. "This POODLE Bites: Exploiting the SSL 3.0 Fallback." Security Advisory, October 2014.&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>Dierks, T. and Rescorla, E. "The Transport Layer Security (TLS) Protocol Version 1.2." RFC 5246, August 2008. <a href="https://www.rfc-editor.org/rfc/rfc5246">Rfc-editor - Rfc5246</a>&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>Rescorla, E. "The Transport Layer Security (TLS) Protocol Version 1.3." RFC 8446, August 2018. <a href="https://www.rfc-editor.org/rfc/rfc8446">Rfc-editor - Rfc8446</a>&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
  



  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/axonsecurity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var sidebar = document.querySelector('.md-sidebar--secondary .md-sidebar__scrollwrap');
      if (sidebar) {
        var disclaimer = document.createElement('div');
        disclaimer.className = 'md-sidebar-disclaimer';
        disclaimer.innerHTML = `
          <div class="md-typeset">
            <div class="admonition info">
              <p class="admonition-title"> Our Books</p>
              <p><a href="https://axonshield.com/book"><strong>The Invisible Certificate Management Tax and How Automation Eliminates 94% of It</strong></a></p>
            </div>
            <div class="admonition warning">
              <p class="admonition-title"> Disclaimer</p>
              <p><small>This documentation is based on "best practices". We've observed these ignore 
                unique organizational needs and often prove ineffective for long-term, sustainable 
                operations and ignore strategic advanteges of building infrastructure intelligence.</small></p>
            </div>
          </div>
        `;
        sidebar.insertBefore(disclaimer, sidebar.firstChild);
      }
    });
  </script>
  

  </body>
</html>