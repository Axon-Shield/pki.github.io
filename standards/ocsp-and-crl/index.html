
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://vault.axonshield.com/standards/ocsp-and-crl/">
      
      
        <link rel="prev" href="../acme-protocol/">
      
      
        <link rel="next" href="../pkcs-standards/">
      
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>OCSP and CRL - Shield Vault</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
    
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WJXPDRF2');</script>
  <!-- End Google Tag Manager -->
  
  <!-- Apollo Tracking -->
  <script>
    (function() {
      var apolloScript = document.createElement('script');
      apolloScript.type = 'text/javascript';
      apolloScript.async = true;
      apolloScript.src = 'https://cdn.apollo.io/v1/apollo.js';
      apolloScript.setAttribute('data-apollo-id', '68b8b91c5e883f0021f7f7aa');
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(apolloScript, s);
    })();
  </script>
  <!-- End Apollo Tracking -->

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ocsp-and-crl" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Shield Vault" class="md-header__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Shield Vault
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OCSP and CRL
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Why Certificate Management Matters

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../quick-start/" class="md-tabs__link">
        
  
  
    
  
  Quick Start Guide

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../technical-guide/" class="md-tabs__link">
        
  
  
    
  
  Foundations for Infrastructure Intelligence - Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../architecture/case-studies/" class="md-tabs__link">
          
  
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../business/cost_of_certificate_management/" class="md-tabs__link">
          
  
  
  Business

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../foundations/certificate-anatomy/" class="md-tabs__link">
          
  
  
  Foundations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../implementation/acme-protocol-implementation/" class="md-tabs__link">
          
  
  
  Implementation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../operations/certificate-lifecycle-management/" class="md-tabs__link">
          
  
  
  Operations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../patterns/ca-hierarchies/" class="md-tabs__link">
          
  
  
  Patterns

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../security/ca-compromise-scenarios/" class="md-tabs__link">
          
  
  
  Security

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../acme-protocol/" class="md-tabs__link">
          
  
  
  Standards

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../strategy/success-metrics/" class="md-tabs__link">
          
  
  
  Strategy

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../troubleshooting/chain-validation-errors/" class="md-tabs__link">
          
  
  
  Troubleshooting

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../vendors/digicert-certcentral/" class="md-tabs__link">
          
  
  
  Vendors

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Shield Vault" class="md-nav__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    Shield Vault
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why Certificate Management Matters
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technical-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Foundations for Infrastructure Intelligence - Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/case-studies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Case Studies - Certificate Management at Scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/certificate-as-code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate-as-Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/mutual-tls-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mutual TLS Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/service-mesh-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service Mesh Certificates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/zero-trust-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zero-Trust Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Business
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Business
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../business/cost_of_certificate_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The $67 Million Risk: Hidden Costs of Manual Certificate Management
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Foundations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Foundations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/certificate-anatomy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Anatomy
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/cryptographic-primitives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cryptographic Primitives
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/public-private-key-pairs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Public-Private Key Pairs
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/trust-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trust Models
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/what-is-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is PKI?
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Implementation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/acme-protocol-implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/ca-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Architecture
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/certificate-issuance-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Issuance Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/hsm-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HSM Integration
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/hsm-operational-failures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HSM Operational Failures
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/multi-cloud-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Cloud PKI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/onprem-vs-cloud-hsm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    On-Premises vs Cloud HSM
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/certificate-lifecycle-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Lifecycle Management
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/certificate-rotation-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Rotation Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/inventory-and-discovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inventory and Discovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/monitoring-and-alerting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring and Alerting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/renewal-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Renewal Automation
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Patterns
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/ca-hierarchies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Hierarchies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/cloud-vs-on-premises/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud vs On-Premises
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/high-availability-disaster-recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    High Availability and Disaster Recovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/multi-tenancy-considerations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Tenancy Considerations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/ca-compromise-scenarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Compromise Scenarios
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/certificate-pinning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Pinning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/common-vulnerabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Vulnerabilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/compliance-and-audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compliance and Audit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/incident-response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Incident Response
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/key-management-best-practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Key Management Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/private-key-protection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Private Key Protection
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/threat-models-and-attack-vectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Threat Models and Attack Vectors
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" checked>
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Standards
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Standards
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../acme-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    OCSP and CRL
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    OCSP and CRL
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Key Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#certificate-revocation-lists-crls" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Revocation Lists (CRLs)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Certificate Revocation Lists (CRLs)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crl-structure" class="md-nav__link">
    <span class="md-ellipsis">
      CRL Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#revocation-reason-codes" class="md-nav__link">
    <span class="md-ellipsis">
      Revocation Reason Codes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crl-types" class="md-nav__link">
    <span class="md-ellipsis">
      CRL Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crl-distribution-points-cdp" class="md-nav__link">
    <span class="md-ellipsis">
      CRL Distribution Points (CDP)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crl-advantages-and-disadvantages" class="md-nav__link">
    <span class="md-ellipsis">
      CRL Advantages and Disadvantages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#online-certificate-status-protocol-ocsp" class="md-nav__link">
    <span class="md-ellipsis">
      Online Certificate Status Protocol (OCSP)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Online Certificate Status Protocol (OCSP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ocsp-request-response-flow" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Request-Response Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-request-format" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Request Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-response-format" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Response Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-advantages-and-disadvantages" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Advantages and Disadvantages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-stapling" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Stapling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OCSP Stapling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-ocsp-stapling-works" class="md-nav__link">
    <span class="md-ellipsis">
      How OCSP Stapling Works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-stapling-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Stapling Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-must-staple" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Must-Staple
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soft-fail-vs-hard-fail" class="md-nav__link">
    <span class="md-ellipsis">
      Soft-Fail vs. Hard-Fail
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Soft-Fail vs. Hard-Fail">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#soft-fail-default-in-most-browsers" class="md-nav__link">
    <span class="md-ellipsis">
      Soft-Fail (Default in Most Browsers)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hard-fail" class="md-nav__link">
    <span class="md-ellipsis">
      Hard-Fail
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-revocation-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Revocation Problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Revocation Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Key Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proposed-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      Proposed Solutions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practical Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing-revocation-checking" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Revocation Checking
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing Revocation Checking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openssl-certificate-verification" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSSL Certificate Verification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#programming-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Programming Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operating-an-ocsp-responder" class="md-nav__link">
    <span class="md-ellipsis">
      Operating an OCSP Responder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operating an OCSP Responder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture Considerations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-responder-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Responder Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response-caching-and-pre-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Response Caching and Pre-Generation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-revocation-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Revocation Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting Revocation Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unable-to-get-crl" class="md-nav__link">
    <span class="md-ellipsis">
      "Unable to Get CRL"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-responder-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      "OCSP Responder Timeout"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-response-verification-failed" class="md-nav__link">
    <span class="md-ellipsis">
      "OCSP Response Verification Failed"
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-pitfalls" class="md-nav__link">
    <span class="md-ellipsis">
      Common Pitfalls
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Security Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#revocation-check-bypass" class="md-nav__link">
    <span class="md-ellipsis">
      Revocation Check Bypass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#revocation-timing" class="md-nav__link">
    <span class="md-ellipsis">
      Revocation Timing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#privacy-vs-security" class="md-nav__link">
    <span class="md-ellipsis">
      Privacy vs. Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Real-World Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-study-symantec-certificate-revocation-2017" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: Symantec Certificate Revocation (2017)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-lets-encrypt-ocsp-capacity" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: Let's Encrypt OCSP Capacity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-crl-distribution-point-outages" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: CRL Distribution Point Outages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      Further Reading
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Further Reading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#essential-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Essential Resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Topics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-history" class="md-nav__link">
    <span class="md-ellipsis">
      Change History
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pkcs-standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PKCS Standards
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tls-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TLS Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../x509-standard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    X.509 Standard
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Strategy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Strategy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategy/success-metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Success Metrics and KPIs for Certificate Automation
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Troubleshooting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/chain-validation-errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chain Validation Errors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/common-misconfigurations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Misconfigurations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/expired-certificate-outages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Expired Certificate Outages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/performance-bottlenecks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Bottlenecks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Vendors
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Vendors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/digicert-certcentral/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DigiCert CertCentral
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/hashicorp-vault-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HashiCorp Vault PKI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/keyfactor-command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Keyfactor Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/venafi-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Venafi Platform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/vendor-comparison-matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vendor Comparison Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Key Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#certificate-revocation-lists-crls" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Revocation Lists (CRLs)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Certificate Revocation Lists (CRLs)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#crl-structure" class="md-nav__link">
    <span class="md-ellipsis">
      CRL Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#revocation-reason-codes" class="md-nav__link">
    <span class="md-ellipsis">
      Revocation Reason Codes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crl-types" class="md-nav__link">
    <span class="md-ellipsis">
      CRL Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crl-distribution-points-cdp" class="md-nav__link">
    <span class="md-ellipsis">
      CRL Distribution Points (CDP)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crl-advantages-and-disadvantages" class="md-nav__link">
    <span class="md-ellipsis">
      CRL Advantages and Disadvantages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#online-certificate-status-protocol-ocsp" class="md-nav__link">
    <span class="md-ellipsis">
      Online Certificate Status Protocol (OCSP)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Online Certificate Status Protocol (OCSP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ocsp-request-response-flow" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Request-Response Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-request-format" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Request Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-response-format" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Response Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-advantages-and-disadvantages" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Advantages and Disadvantages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-stapling" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Stapling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OCSP Stapling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-ocsp-stapling-works" class="md-nav__link">
    <span class="md-ellipsis">
      How OCSP Stapling Works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-stapling-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Stapling Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-must-staple" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Must-Staple
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#soft-fail-vs-hard-fail" class="md-nav__link">
    <span class="md-ellipsis">
      Soft-Fail vs. Hard-Fail
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Soft-Fail vs. Hard-Fail">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#soft-fail-default-in-most-browsers" class="md-nav__link">
    <span class="md-ellipsis">
      Soft-Fail (Default in Most Browsers)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hard-fail" class="md-nav__link">
    <span class="md-ellipsis">
      Hard-Fail
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-revocation-problem" class="md-nav__link">
    <span class="md-ellipsis">
      The Revocation Problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Revocation Problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Key Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proposed-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      Proposed Solutions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-guidance" class="md-nav__link">
    <span class="md-ellipsis">
      Practical Guidance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Practical Guidance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing-revocation-checking" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Revocation Checking
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing Revocation Checking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#openssl-certificate-verification" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSSL Certificate Verification
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#programming-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Programming Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operating-an-ocsp-responder" class="md-nav__link">
    <span class="md-ellipsis">
      Operating an OCSP Responder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operating an OCSP Responder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture Considerations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-responder-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      OCSP Responder Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response-caching-and-pre-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Response Caching and Pre-Generation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting-revocation-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting Revocation Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting Revocation Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unable-to-get-crl" class="md-nav__link">
    <span class="md-ellipsis">
      "Unable to Get CRL"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-responder-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      "OCSP Responder Timeout"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ocsp-response-verification-failed" class="md-nav__link">
    <span class="md-ellipsis">
      "OCSP Response Verification Failed"
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-pitfalls" class="md-nav__link">
    <span class="md-ellipsis">
      Common Pitfalls
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Security Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#revocation-check-bypass" class="md-nav__link">
    <span class="md-ellipsis">
      Revocation Check Bypass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#revocation-timing" class="md-nav__link">
    <span class="md-ellipsis">
      Revocation Timing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#privacy-vs-security" class="md-nav__link">
    <span class="md-ellipsis">
      Privacy vs. Security
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Real-World Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-study-symantec-certificate-revocation-2017" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: Symantec Certificate Revocation (2017)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-lets-encrypt-ocsp-capacity" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: Let's Encrypt OCSP Capacity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-crl-distribution-point-outages" class="md-nav__link">
    <span class="md-ellipsis">
      Case Study: CRL Distribution Point Outages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      Further Reading
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Further Reading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#essential-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Essential Resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-topics" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Topics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-history" class="md-nav__link">
    <span class="md-ellipsis">
      Change History
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WJXPDRF2"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
  <!-- Right sidebar with disclaimer above TOC -->
  
    <style>
      @media screen and (min-width: 76.25em) {
        .md-sidebar--secondary {
          order: 1;
        }
        .md-sidebar--secondary::before {
          content: '';
          display: block;
          margin-bottom: 1rem;
        }
      }
    </style>
  
  
  
                  



<h1 id="ocsp-and-crl">OCSP and CRL</h1>
<blockquote>
<p><strong>TL;DR</strong>: Certificate Revocation Lists (CRLs) and Online Certificate Status Protocol (OCSP) are mechanisms for checking if certificates have been revoked before expiration. CRLs are periodically published lists of revoked certificates, while OCSP provides real-time status queries. Understanding revocation is critical for PKI securitya compromised certificate must be revoked to prevent ongoing misuse.</p>
</blockquote>
<h2 id="overview">Overview</h2>
<p>Certificate revocation solves a fundamental PKI problem: what happens when a certificate must be invalidated before its expiration date? Private key compromise, organizational changes, certificate misissuance, and other events require immediate certificate invalidation. Without revocation mechanisms, compromised certificates remain trusted until expirationpotentially years.</p>
<p>The PKI community has developed two primary revocation mechanisms with different trade-offs. Certificate Revocation Lists (CRLs), standardized in X.509 since the beginning, provide a periodically updated list of revoked certificates. Online Certificate Status Protocol (OCSP), defined in RFC 6960<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>, enables real-time revocation queries. Modern implementations often use OCSP Stapling, where servers provide OCSP responses directly, improving performance and privacy.</p>
<p>Understanding revocation is essential for: operating secure PKI systems, troubleshooting certificate validation failures, implementing proper revocation checking, and assessing PKI security posture. The gap between revocation theory and practiceoften called the "revocation problem"remains one of PKI's persistent challenges.</p>
<p><strong>Related Pages</strong>: <a href="../../foundations/certificate-anatomy/">Certificate Anatomy</a>, <a href="../x509-standard/">X509 Standard</a>, <a href="../tls-protocol/">Tls Protocol</a>, <a href="../../operations/certificate-lifecycle-management/">Certificate Lifecycle Management</a></p>
<h2 id="key-concepts">Key Concepts</h2>
<h3 id="certificate-revocation-lists-crls">Certificate Revocation Lists (CRLs)</h3>
<p>CRLs are signed data structures listing revoked certificates, published periodically by Certificate Authorities.</p>
<h4 id="crl-structure">CRL Structure</h4>
<p><strong>Basic Fields</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Version: v2
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Signature Algorithm: sha256WithRSAEncryption
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>Issuer: CN=Example CA, O=Example Corp
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>This Update: Nov 9 00:00:00 2024 GMT
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>Next Update: Nov 16 00:00:00 2024 GMT
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>Revoked Certificates:
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    Serial Number: 1A2B3C4D5E6F7890
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>        Revocation Date: Nov 1 12:34:56 2024 GMT
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        Reason Code: keyCompromise (1)
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    Serial Number: 9F8E7D6C5B4A3210
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        Revocation Date: Nov 5 08:22:14 2024 GMT
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        Reason Code: cessationOfOperation (5)
</code></pre></div></p>
<p><strong>Critical Fields</strong>:</p>
<p><strong>This Update</strong>: When CRL was issued
- Validators should reject CRLs older than expected update frequency
- Indicates CRL staleness</p>
<p><strong>Next Update</strong>: When next CRL will be published
- Validators may accept CRL until this time
- Provides grace period for CRL distribution</p>
<p><strong>Revoked Certificates</strong>: List of serial numbers with revocation metadata
- <strong>Serial Number</strong>: Unique identifier of revoked certificate
- <strong>Revocation Date</strong>: When certificate was revoked
- <strong>Reason Code</strong>: Why certificate was revoked (optional)</p>
<p><strong>Extensions</strong>:</p>
<ul>
<li><strong>CRL Number</strong>: Monotonically increasing number for tracking</li>
<li><strong>Authority Key Identifier</strong>: Identifies CA that signed CRL</li>
<li><strong>Issuing Distribution Point</strong>: Scope of CRL (which certificates it covers)</li>
</ul>
<h4 id="revocation-reason-codes">Revocation Reason Codes</h4>
<p>Defined in RFC 5280<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>, reasons explain why certificate revoked:</p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Value</th>
<th>Meaning</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td>unspecified</td>
<td>0</td>
<td>No reason provided</td>
<td>Default</td>
</tr>
<tr>
<td>keyCompromise</td>
<td>1</td>
<td>Private key exposed</td>
<td>Security incident</td>
</tr>
<tr>
<td>cACompromise</td>
<td>2</td>
<td>CA key exposed</td>
<td>Catastrophic failure</td>
</tr>
<tr>
<td>affiliationChanged</td>
<td>3</td>
<td>Subject changed</td>
<td>Employee left organization</td>
</tr>
<tr>
<td>superseded</td>
<td>4</td>
<td>Certificate replaced</td>
<td>Renewal with new key</td>
</tr>
<tr>
<td>cessationOfOperation</td>
<td>5</td>
<td>Service decommissioned</td>
<td>Server retired</td>
</tr>
<tr>
<td>certificateHold</td>
<td>6</td>
<td>Temporary suspension</td>
<td>Investigation ongoing</td>
</tr>
<tr>
<td>removeFromCRL</td>
<td>8</td>
<td>Unrevoke (only for hold)</td>
<td>Investigation cleared</td>
</tr>
<tr>
<td>privilegeWithdrawn</td>
<td>9</td>
<td>Authorization removed</td>
<td>Access revoked</td>
</tr>
<tr>
<td>aACompromise</td>
<td>10</td>
<td>Attribute authority compromised</td>
<td>Attribute certificates</td>
</tr>
</tbody>
</table>
<p><strong>Note</strong>: <code>certificateHold</code> (6) is the only reversible revocation. Once a certificate is revoked with any other reason, it cannot be un-revoked.</p>
<h4 id="crl-types">CRL Types</h4>
<p><strong>Base CRL</strong>:</p>
<ul>
<li>Complete list of all revoked certificates</li>
<li>Issued periodically (daily, weekly)</li>
<li>Can grow very large for CAs with many revocations</li>
</ul>
<p><strong>Delta CRL</strong>:</p>
<ul>
<li>Contains only changes since last base CRL</li>
<li>Smaller size, more frequent updates</li>
<li>References base CRL via Base CRL Number extension</li>
<li>Client must obtain both base and delta</li>
</ul>
<p><strong>Indirect CRL</strong>:</p>
<ul>
<li>Published by entity other than certificate issuer</li>
<li>Certificate Issuer extension identifies actual issuer</li>
<li>Enables centralized CRL distribution</li>
</ul>
<p><strong>Partitioned CRL</strong>:</p>
<ul>
<li>CRL divided into multiple segments</li>
<li>Issuing Distribution Point extension specifies partition</li>
<li>Reduces download size for clients</li>
</ul>
<h4 id="crl-distribution-points-cdp">CRL Distribution Points (CDP)</h4>
<p>Certificates include CRL Distribution Points extension indicating where to obtain CRLs:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>X509v3 CRL Distribution Points:
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    Full Name:
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>      URI:http://crl.example.com/ExampleCA.crl
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>      URI:ldap://ldap.example.com/cn=ExampleCA,ou=CAs,o=Example?certificateRevocationList
</code></pre></div>
<p><strong>Protocol Support</strong>:</p>
<ul>
<li><strong>HTTP</strong>: Most common, simple download</li>
<li><strong>LDAP</strong>: Directory service access</li>
<li><strong>FTP</strong>: Rarely used</li>
<li><strong>File</strong>: Local file system (internal use only)</li>
</ul>
<h4 id="crl-advantages-and-disadvantages">CRL Advantages and Disadvantages</h4>
<p><strong>Advantages</strong>:</p>
<ul>
<li><strong>Simple</strong>: Easy to implement and understand</li>
<li><strong>Offline</strong>: Can download and cache for offline validation</li>
<li><strong>Privacy</strong>: No per-certificate queries reveal which sites visited</li>
<li><strong>Deterministic</strong>: Same CRL for all validators at same time</li>
</ul>
<p><strong>Disadvantages</strong>:</p>
<ul>
<li><strong>Latency</strong>: Revocations not visible until next CRL published</li>
<li><strong>Size</strong>: Can grow to megabytes for large CAs</li>
<li><strong>Bandwidth</strong>: Every client downloads entire list</li>
<li><strong>Scalability</strong>: Doesn't scale well for high-revocation-rate CAs</li>
</ul>
<h3 id="online-certificate-status-protocol-ocsp">Online Certificate Status Protocol (OCSP)</h3>
<p>OCSP provides real-time certificate status queries via request-response protocol.</p>
<h4 id="ocsp-request-response-flow">OCSP Request-Response Flow</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Client                                    OCSP Responder
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>1. Build OCSP Request
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>   - Certificate serial number
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>   - Issuer name hash
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>   - Issuer key hash
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>2. Send OCSP Request  --------&gt;
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>3.                              Lookup certificate status
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>                                in CA database
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>4.                    &lt;--------  Send OCSP Response
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>                                 - Status (good/revoked/unknown)
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>                                 - This Update time
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>                                 - Next Update time
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>                                 - Revocation details (if revoked)
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>5. Validate OCSP Response
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>   - Check signature
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>   - Verify timing
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>   - Check response matches request
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>6. Make trust decision based on status
</code></pre></div>
<h4 id="ocsp-request-format">OCSP Request Format</h4>
<p><strong>Request Structure</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>OCSP Request:
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>  Version: 1 (0x0)
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>  Requestor List:
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>      Certificate ID:
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>        Hash Algorithm: sha256
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>        Issuer Name Hash: A1B2C3D4...
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>        Issuer Key Hash: E5F6A7B8...
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>        Serial Number: 1A2B3C4D5E6F7890
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>  Request Extensions:
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>      Nonce: F1E2D3C4B5A69788... (optional)
</code></pre></div></p>
<p><strong>Key Components</strong>:</p>
<ul>
<li><strong>Issuer Name Hash</strong>: SHA-256 hash of certificate issuer DN</li>
<li><strong>Issuer Key Hash</strong>: SHA-256 hash of CA public key</li>
<li><strong>Serial Number</strong>: Certificate to check</li>
<li><strong>Nonce</strong>: Random value to prevent replay attacks (optional)</li>
</ul>
<h4 id="ocsp-response-format">OCSP Response Format</h4>
<p><strong>Response Structure</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>OCSP Response:
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>  Response Status: successful (0x0)
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>  Response Type: Basic OCSP Response
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>  Version: 1 (0x0)
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>  Responder ID: CN=OCSP Responder, O=Example Corp
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>  Produced At: Nov 9 12:34:56 2024 GMT
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>  Responses:
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>      Certificate ID: (matches request)
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>      Cert Status: good
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>      This Update: Nov 9 12:30:00 2024 GMT
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>      Next Update: Nov 9 13:30:00 2024 GMT
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>      Response Extensions:
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>          Nonce: F1E2D3C4B5A69788... (matches request)
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>  Signature Algorithm: sha256WithRSAEncryption
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>  Signature: A1B2C3D4E5F6... (signed by OCSP responder)
</code></pre></div></p>
<p><strong>Certificate Status Values</strong>:</p>
<p><strong>Good</strong>: Certificate is valid and not revoked
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>Cert Status: good
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>This Update: Nov 9 12:30:00 2024 GMT
</code></pre></div></p>
<p><strong>Revoked</strong>: Certificate has been revoked
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>Cert Status: revoked
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>Revocation Time: Nov 1 08:15:30 2024 GMT
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>Revocation Reason: keyCompromise (1)
</code></pre></div></p>
<p><strong>Unknown</strong>: Responder doesn't know about this certificate
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>Cert Status: unknown
</code></pre></div></p>
<p><strong>Response Status Codes</strong>:</p>
<ul>
<li><strong>successful (0)</strong>: Valid response included</li>
<li><strong>malformedRequest (1)</strong>: Request syntax error</li>
<li><strong>internalError (2)</strong>: Responder internal error</li>
<li><strong>tryLater (3)</strong>: Service temporarily unavailable</li>
<li><strong>sigRequired (5)</strong>: Request must be signed</li>
<li><strong>unauthorized (6)</strong>: Requestor not authorized</li>
</ul>
<h4 id="ocsp-advantages-and-disadvantages">OCSP Advantages and Disadvantages</h4>
<p><strong>Advantages</strong>:</p>
<ul>
<li><strong>Real-time</strong>: Near-instant revocation visibility</li>
<li><strong>Efficient</strong>: Only query status of certificates actually needed</li>
<li><strong>Smaller</strong>: Responses much smaller than CRLs</li>
<li><strong>Dynamic</strong>: Can implement custom policies per request</li>
</ul>
<p><strong>Disadvantages</strong>:</p>
<ul>
<li><strong>Privacy</strong>: CA sees which certificates clients are validating</li>
<li><strong>Availability</strong>: Requires network connection and OCSP responder availability</li>
<li><strong>Performance</strong>: Network round-trip adds latency to TLS handshake</li>
<li><strong>Reliability</strong>: OCSP responder failure can prevent certificate validation</li>
</ul>
<h3 id="ocsp-stapling">OCSP Stapling</h3>
<p>OCSP Stapling (formally "TLS Certificate Status Request extension") addresses OCSP privacy and performance concerns.</p>
<h4 id="how-ocsp-stapling-works">How OCSP Stapling Works</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>Server                                     OCSP Responder
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>1. Server queries OCSP responder periodically
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>   for its own certificate status  ---------&gt;
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>2.                                   &lt;---------  OCSP Response
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>3. Server caches OCSP response
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>Client                                     Server
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>4. ClientHello with
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>   status_request extension        ---------&gt;
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>5.                                   &lt;---------  ServerHello
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>                                                Certificate
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>                                                CertificateStatus
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>                                                  (OCSP Response)
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>6. Client validates OCSP response
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>   - Check signature
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>   - Verify timing (not expired)
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>   - Check status
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>7. TLS connection continues
</code></pre></div>
<p><strong>Key Benefits</strong>:</p>
<p><strong>Privacy</strong>: Client doesn't contact OCSP responder
- CA doesn't see which sites user visits
- Reduces tracking opportunities</p>
<p><strong>Performance</strong>: No client-side OCSP query latency
- Server provides cached response
- No additional round-trip during TLS handshake</p>
<p><strong>Reliability</strong>: Cached response available even if OCSP responder down
- Improves availability
- Reduces dependency on OCSP infrastructure</p>
<p><strong>Server Responsibility</strong>: Server must keep OCSP responses fresh
- Query OCSP responder periodically (e.g., hourly)
- Refresh before response expires
- Handle responder failures gracefully</p>
<h4 id="ocsp-stapling-configuration">OCSP Stapling Configuration</h4>
<p><strong>Nginx</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">server</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span><span class="kn">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="s">ssl</span><span class="p">;</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span><span class="kn">ssl_certificate</span><span class="w"> </span><span class="s">/etc/ssl/certs/server.crt</span><span class="p">;</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="kn">ssl_certificate_key</span><span class="w"> </span><span class="s">/etc/ssl/private/server.key</span><span class="p">;</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">    </span><span class="kn">ssl_trusted_certificate</span><span class="w"> </span><span class="s">/etc/ssl/certs/ca-chain.crt</span><span class="p">;</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">    </span><span class="c1"># Enable OCSP Stapling</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">    </span><span class="kn">ssl_stapling</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">    </span><span class="kn">ssl_stapling_verify</span><span class="w"> </span><span class="no">on</span><span class="p">;</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">    </span><span class="c1"># DNS resolver for OCSP responder lookup</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">    </span><span class="kn">resolver</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.8.8</span><span class="w"> </span><span class="mi">8</span><span class="s">.8.4.4</span><span class="w"> </span><span class="s">valid=300s</span><span class="p">;</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">    </span><span class="kn">resolver_timeout</span><span class="w"> </span><span class="s">5s</span><span class="p">;</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">    </span><span class="c1"># OCSP response cache</span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">    </span><span class="kn">ssl_stapling_file</span><span class="w"> </span><span class="s">/var/cache/nginx/ocsp_response.der</span><span class="p">;</span><span class="w">  </span><span class="c1"># Optional</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="p">}</span>
</code></pre></div></p>
<p><strong>Apache</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nt">&lt;VirtualHost</span><span class="w"> </span><span class="s">*:443</span><span class="nt">&gt;</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="nb">SSLEngine</span><span class="w"> </span><span class="k">on</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">    </span><span class="nb">SSLCertificateFile</span><span class="w"> </span><span class="sx">/etc/ssl/certs/server.crt</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="nb">SSLCertificateKeyFile</span><span class="w"> </span><span class="sx">/etc/ssl/private/server.key</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="nb">SSLCertificateChainFile</span><span class="w"> </span><span class="sx">/etc/ssl/certs/ca-chain.crt</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">    </span><span class="c"># Enable OCSP Stapling</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">    </span><span class="nb">SSLUseStapling</span><span class="w"> </span><span class="k">on</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">    </span><span class="nb">SSLStaplingCache</span><span class="w"> </span><span class="s2">&quot;shmcb:logs/ssl_stapling(32768)&quot;</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">    </span><span class="nb">SSLStaplingStandardCacheTimeout</span><span class="w"> </span><span class="m">3600</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">    </span><span class="nb">SSLStaplingErrorCacheTimeout</span><span class="w"> </span><span class="m">600</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="nt">&lt;/VirtualHost&gt;</span>
</code></pre></div></p>
<p><strong>Testing</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Test OCSP stapling with OpenSSL</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>openssl<span class="w"> </span>s_client<span class="w"> </span>-connect<span class="w"> </span>example.com:443<span class="w"> </span>-status<span class="w"> </span>-servername<span class="w"> </span>example.com
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="c1"># Look for:</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="c1"># OCSP Response Status: successful (0x0)</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="c1"># Cert Status: good</span>
</code></pre></div></p>
<h4 id="ocsp-must-staple">OCSP Must-Staple</h4>
<p>Certificate extension requiring OCSP stapling:</p>
<p><strong>X.509 Extension</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>TLS Feature: status_request (5)
</code></pre></div></p>
<p><strong>Effect</strong>: Clients must fail validation if server doesn't provide stapled OCSP response</p>
<p><strong>Security Benefit</strong>: Prevents downgrade to soft-fail mode</p>
<p><strong>Risk</strong>: Server OCSP failures become hard failures (impacts availability)</p>
<h3 id="soft-fail-vs-hard-fail">Soft-Fail vs. Hard-Fail</h3>
<p>Critical decision: what happens when revocation check fails?</p>
<h4 id="soft-fail-default-in-most-browsers">Soft-Fail (Default in Most Browsers)</h4>
<p><strong>Behavior</strong>: If revocation check fails, proceed anyway</p>
<p><strong>Rationale</strong>:</p>
<ul>
<li>OCSP responders frequently have availability issues</li>
<li>Hard-fail would break many legitimate sites</li>
<li>Balance security against usability</li>
</ul>
<p><strong>Example Scenarios</strong>:</p>
<ul>
<li>OCSP responder timeout: <strong>Accept certificate</strong></li>
<li>CRL download fails: <strong>Accept certificate</strong></li>
<li>OCSP response indicates "tryLater": <strong>Accept certificate</strong></li>
</ul>
<p><strong>Security Trade-off</strong>: Attackers can cause revocation check failures (DoS OCSP responder) to make revoked certificates accepted</p>
<h4 id="hard-fail">Hard-Fail</h4>
<p><strong>Behavior</strong>: If revocation check fails, reject certificate</p>
<p><strong>Rationale</strong>:</p>
<ul>
<li>Security over availability</li>
<li>Don't trust certificates if can't verify revocation status</li>
</ul>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>High-security environments</li>
<li>Internal PKI with reliable infrastructure</li>
<li>Certificate pinning scenarios</li>
<li>OCSP Must-Staple certificates</li>
</ul>
<p><strong>Example Scenarios</strong>:</p>
<ul>
<li>OCSP responder timeout: <strong>Reject certificate</strong></li>
<li>CRL download fails: <strong>Reject certificate</strong></li>
<li>OCSP response indicates "tryLater": <strong>Reject certificate</strong></li>
</ul>
<p><strong>Configuration</strong> (Example):
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># OpenSSL hard-fail verification</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>openssl<span class="w"> </span>verify<span class="w"> </span>-CRLfile<span class="w"> </span>crl.pem<span class="w"> </span>-crl_check_all<span class="w"> </span>server.crt
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># Fails if CRL not available or revocation detected</span>
</code></pre></div></p>
<h3 id="the-revocation-problem">The Revocation Problem</h3>
<p>The persistent challenge of effective certificate revocation.</p>
<h4 id="key-issues">Key Issues</h4>
<p><strong>Browser Soft-Fail</strong>:</p>
<ul>
<li>Most browsers default to soft-fail</li>
<li>Attackers can exploit by blocking revocation checks</li>
<li>Security vs. availability trade-off</li>
</ul>
<p><strong>CRL Scalability</strong>:</p>
<ul>
<li>CRLs can grow to many megabytes</li>
<li>Clients must download entire list</li>
<li>Inefficient for CAs with many certificates</li>
</ul>
<p><strong>OCSP Privacy</strong>:</p>
<ul>
<li>Every certificate validation reveals sites visited</li>
<li>Without stapling, CA tracks user browsing</li>
<li>Privacy-conscious users may disable OCSP</li>
</ul>
<p><strong>OCSP Performance</strong>:</p>
<ul>
<li>Network latency for each TLS connection</li>
<li>OCSP responder must handle high query volume</li>
<li>Failures impact certificate validation</li>
</ul>
<p><strong>Incomplete Checking</strong>:</p>
<ul>
<li>Many applications don't check revocation at all</li>
<li>Legacy systems lack OCSP support</li>
<li>Configuration errors disable checking</li>
</ul>
<h4 id="proposed-solutions">Proposed Solutions</h4>
<p><strong>Certificate Transparency</strong>:</p>
<ul>
<li>Public logs of all issued certificates</li>
<li>Domain owners monitor for unexpected certificates</li>
<li>Detects misissuance, doesn't prevent it</li>
<li>Complementary to revocation</li>
</ul>
<p><strong>Short-Lived Certificates</strong>:</p>
<ul>
<li>Issue certificates with short validity (hours/days)</li>
<li>No need for revocation (expires quickly)</li>
<li>Requires reliable automation</li>
<li>Let's Encrypt model: 90-day certificates</li>
</ul>
<p><strong>CRLite</strong> (Mozilla):</p>
<ul>
<li>Compressed, space-efficient revocation data</li>
<li>Aggregates CRL data from all CAs</li>
<li>Ships with Firefox updates</li>
<li>Enables hard-fail without performance penalty</li>
</ul>
<p><strong>OCSP Stapling + Must-Staple</strong>:</p>
<ul>
<li>Mandatory stapling prevents soft-fail exploitation</li>
<li>Server responsible for OCSP queries</li>
<li>Requires careful operational planning</li>
</ul>
<h2 id="practical-guidance">Practical Guidance</h2>
<h3 id="implementing-revocation-checking">Implementing Revocation Checking</h3>
<h4 id="openssl-certificate-verification">OpenSSL Certificate Verification</h4>
<p><strong>Basic Verification</strong> (No Revocation):
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>openssl<span class="w"> </span>verify<span class="w"> </span>-CAfile<span class="w"> </span>ca-cert.pem<span class="w"> </span>server.crt
</code></pre></div></p>
<p><strong>CRL Checking</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Download CRL</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>curl<span class="w"> </span>-o<span class="w"> </span>crl.pem<span class="w"> </span>http://crl.example.com/ExampleCA.crl
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1"># Convert to PEM if needed</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>openssl<span class="w"> </span>crl<span class="w"> </span>-inform<span class="w"> </span>DER<span class="w"> </span>-in<span class="w"> </span>crl.der<span class="w"> </span>-out<span class="w"> </span>crl.pem
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="c1"># Verify with CRL</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>openssl<span class="w"> </span>verify<span class="w"> </span>-CAfile<span class="w"> </span>ca-cert.pem<span class="w"> </span>-CRLfile<span class="w"> </span>crl.pem<span class="w"> </span>-crl_check<span class="w"> </span>server.crt
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="c1"># Check entire chain</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>openssl<span class="w"> </span>verify<span class="w"> </span>-CAfile<span class="w"> </span>ca-cert.pem<span class="w"> </span>-CRLfile<span class="w"> </span>crl.pem<span class="w"> </span>-crl_check_all<span class="w"> </span>server.crt
</code></pre></div></p>
<p><strong>OCSP Checking</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># Extract OCSP responder URL from certificate</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>openssl<span class="w"> </span>x509<span class="w"> </span>-in<span class="w"> </span>server.crt<span class="w"> </span>-noout<span class="w"> </span>-ocsp_uri
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c1"># Output: http://ocsp.example.com</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c1"># Perform OCSP query</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>openssl<span class="w"> </span>ocsp<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">  </span>-CAfile<span class="w"> </span>ca-cert.pem<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">  </span>-issuer<span class="w"> </span>issuer-cert.pem<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">  </span>-cert<span class="w"> </span>server.crt<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">  </span>-url<span class="w"> </span>http://ocsp.example.com<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="w">  </span>-resp_text
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="c1"># Output includes:</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="c1"># Response: successful (0x0)</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="c1"># Cert Status: good</span>
</code></pre></div></p>
<h4 id="programming-examples">Programming Examples</h4>
<p><strong>Python (cryptography library)</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography</span><span class="w"> </span><span class="kn">import</span> <span class="n">x509</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.backends</span><span class="w"> </span><span class="kn">import</span> <span class="n">default_backend</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.x509</span><span class="w"> </span><span class="kn">import</span> <span class="n">ocsp</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_ocsp_status</span><span class="p">(</span><span class="n">cert</span><span class="p">,</span> <span class="n">issuer_cert</span><span class="p">):</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>    <span class="c1"># Build OCSP request</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    <span class="n">builder</span> <span class="o">=</span> <span class="n">ocsp</span><span class="o">.</span><span class="n">OCSPRequestBuilder</span><span class="p">()</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>    <span class="n">builder</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">add_certificate</span><span class="p">(</span><span class="n">cert</span><span class="p">,</span> <span class="n">issuer_cert</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">())</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>    <span class="n">req</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>    <span class="c1"># Get OCSP responder URL from certificate</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>    <span class="n">aia</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">get_extension_for_oid</span><span class="p">(</span>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">ExtensionOID</span><span class="o">.</span><span class="n">AUTHORITY_INFORMATION_ACCESS</span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>    <span class="p">)</span>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>    <span class="n">ocsp_url</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>    <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">aia</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>        <span class="k">if</span> <span class="n">desc</span><span class="o">.</span><span class="n">access_method</span> <span class="o">==</span> <span class="n">x509</span><span class="o">.</span><span class="n">AuthorityInformationAccessOID</span><span class="o">.</span><span class="n">OCSP</span><span class="p">:</span>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>            <span class="n">ocsp_url</span> <span class="o">=</span> <span class="n">desc</span><span class="o">.</span><span class="n">access_location</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>            <span class="k">break</span>
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">ocsp_url</span><span class="p">:</span>
<a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a>
<a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a>    <span class="c1"># Send OCSP request</span>
<a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
<a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a>        <span class="n">ocsp_url</span><span class="p">,</span>
<a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a>        <span class="n">data</span><span class="o">=</span><span class="n">req</span><span class="o">.</span><span class="n">public_bytes</span><span class="p">(</span><span class="n">serialization</span><span class="o">.</span><span class="n">Encoding</span><span class="o">.</span><span class="n">DER</span><span class="p">),</span>
<a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a>        <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/ocsp-request&#39;</span><span class="p">}</span>
<a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a>    <span class="p">)</span>
<a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a>
<a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a>    <span class="c1"># Parse OCSP response</span>
<a id="__codelineno-17-34" name="__codelineno-17-34" href="#__codelineno-17-34"></a>    <span class="n">ocsp_resp</span> <span class="o">=</span> <span class="n">ocsp</span><span class="o">.</span><span class="n">load_der_ocsp_response</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<a id="__codelineno-17-35" name="__codelineno-17-35" href="#__codelineno-17-35"></a>
<a id="__codelineno-17-36" name="__codelineno-17-36" href="#__codelineno-17-36"></a>    <span class="c1"># Check status</span>
<a id="__codelineno-17-37" name="__codelineno-17-37" href="#__codelineno-17-37"></a>    <span class="k">if</span> <span class="n">ocsp_resp</span><span class="o">.</span><span class="n">certificate_status</span> <span class="o">==</span> <span class="n">ocsp</span><span class="o">.</span><span class="n">OCSPCertStatus</span><span class="o">.</span><span class="n">GOOD</span><span class="p">:</span>
<a id="__codelineno-17-38" name="__codelineno-17-38" href="#__codelineno-17-38"></a>        <span class="k">return</span> <span class="s2">&quot;good&quot;</span>
<a id="__codelineno-17-39" name="__codelineno-17-39" href="#__codelineno-17-39"></a>    <span class="k">elif</span> <span class="n">ocsp_resp</span><span class="o">.</span><span class="n">certificate_status</span> <span class="o">==</span> <span class="n">ocsp</span><span class="o">.</span><span class="n">OCSPCertStatus</span><span class="o">.</span><span class="n">REVOKED</span><span class="p">:</span>
<a id="__codelineno-17-40" name="__codelineno-17-40" href="#__codelineno-17-40"></a>        <span class="k">return</span> <span class="s2">&quot;revoked&quot;</span>
<a id="__codelineno-17-41" name="__codelineno-17-41" href="#__codelineno-17-41"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-17-42" name="__codelineno-17-42" href="#__codelineno-17-42"></a>        <span class="k">return</span> <span class="s2">&quot;unknown&quot;</span>
</code></pre></div></p>
<h3 id="operating-an-ocsp-responder">Operating an OCSP Responder</h3>
<h4 id="architecture-considerations">Architecture Considerations</h4>
<p><strong>High Availability</strong>:</p>
<ul>
<li>Multiple responder instances behind load balancer</li>
<li>Geographic distribution for low latency</li>
<li>Database replication for revocation status</li>
</ul>
<p><strong>Performance Requirements</strong>:</p>
<ul>
<li>Handle thousands of queries per second</li>
<li>Millisecond response times</li>
<li>Minimal memory and CPU overhead</li>
</ul>
<p><strong>Security</strong>:</p>
<ul>
<li>Dedicated OCSP signing key (not CA key)</li>
<li>Responder key access controls</li>
<li>Rate limiting and DoS protection</li>
<li>Audit logging of all queries</li>
</ul>
<h4 id="ocsp-responder-implementation">OCSP Responder Implementation</h4>
<p><strong>Using OpenSSL ocsp</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Generate OCSP responder certificate</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-nodes<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">  </span>-keyout<span class="w"> </span>ocsp_key.pem<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">  </span>-out<span class="w"> </span>ocsp_req.pem<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">  </span>-subj<span class="w"> </span><span class="s2">&quot;/CN=OCSP Responder/O=Example Corp&quot;</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c1"># CA signs OCSP responder certificate with id-kp-OCSPSigning EKU</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>openssl<span class="w"> </span>ca<span class="w"> </span>-config<span class="w"> </span>ca.conf<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">  </span>-extensions<span class="w"> </span>ocsp_ext<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">  </span>-in<span class="w"> </span>ocsp_req.pem<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">  </span>-out<span class="w"> </span>ocsp_cert.pem
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="c1"># Run OCSP responder</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>openssl<span class="w"> </span>ocsp<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="w">  </span>-index<span class="w"> </span>index.txt<span class="w"> </span><span class="se">\ </span><span class="w">     </span><span class="c1"># CA&#39;s certificate database</span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="w">  </span>-CA<span class="w"> </span>ca_cert.pem<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="w">  </span>-rsigner<span class="w"> </span>ocsp_cert.pem<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="w">  </span>-rkey<span class="w"> </span>ocsp_key.pem<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="w">  </span>-port<span class="w"> </span><span class="m">8080</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="w">  </span>-text
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a><span class="c1"># Responder listens on http://localhost:8080</span>
</code></pre></div></p>
<p><strong>Production OCSP Responders</strong>:</p>
<ul>
<li><strong>Boulder</strong> (Let's Encrypt): High-performance, Go-based</li>
<li><strong>EJBCA</strong>: Enterprise PKI with built-in OCSP</li>
<li><strong>OpenXPKI</strong>: Open-source PKI suite with OCSP</li>
<li><strong>Custom</strong>: Build on top of web frameworks (Flask, Express)</li>
</ul>
<h4 id="response-caching-and-pre-generation">Response Caching and Pre-Generation</h4>
<p><strong>Pre-Generate Responses</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Generate OCSP responses for all valid certificates</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="c1"># Cache to disk or database</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="c1"># Serve from cache (no database query per request)</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">valid_certificates</span><span class="p">:</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">generate_ocsp_response</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>    <span class="n">cache</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">serial_number</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>Benefits</strong>:</p>
<ul>
<li>Faster response times (no database query)</li>
<li>Reduced load on backend database</li>
<li>Better scalability</li>
</ul>
<p><strong>Refresh Strategy</strong>:</p>
<ul>
<li>Regenerate responses periodically (e.g., every hour)</li>
<li>Update immediately on revocation</li>
<li>Include reasonable Next Update time</li>
</ul>
<h3 id="troubleshooting-revocation-issues">Troubleshooting Revocation Issues</h3>
<h4 id="unable-to-get-crl">"Unable to Get CRL"</h4>
<p><strong>Diagnosis</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># Check CRL Distribution Points in certificate</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>openssl<span class="w"> </span>x509<span class="w"> </span>-in<span class="w"> </span>server.crt<span class="w"> </span>-noout<span class="w"> </span>-ext<span class="w"> </span>crlDistributionPoints
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="c1"># Try downloading CRL</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>curl<span class="w"> </span>-I<span class="w"> </span>http://crl.example.com/ExampleCA.crl
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="c1"># Check CRL is valid</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>openssl<span class="w"> </span>crl<span class="w"> </span>-in<span class="w"> </span>downloaded.crl<span class="w"> </span>-noout<span class="w"> </span>-text
</code></pre></div></p>
<p><strong>Common Causes</strong>:
1. <strong>CRL URL not accessible</strong>: Firewall, DNS issues
2. <strong>CRL expired</strong>: Next Update in past
3. <strong>CRL not published</strong>: CA operational issue</p>
<p><strong>Fixes</strong>:</p>
<ul>
<li>Ensure network access to CRL URL</li>
<li>Configure CA to publish CRLs regularly</li>
<li>Check Next Update time in CRL</li>
</ul>
<h4 id="ocsp-responder-timeout">"OCSP Responder Timeout"</h4>
<p><strong>Diagnosis</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># Test OCSP directly</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="nb">time</span><span class="w"> </span>openssl<span class="w"> </span>ocsp<span class="w"> </span>-CAfile<span class="w"> </span>ca.pem<span class="w"> </span>-issuer<span class="w"> </span>issuer.pem<span class="w"> </span>-cert<span class="w"> </span>server.crt<span class="w"> </span>-url<span class="w"> </span>http://ocsp.example.com
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c1"># Check DNS resolution</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>nslookup<span class="w"> </span>ocsp.example.com
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c1"># Check network connectivity</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>curl<span class="w"> </span>-v<span class="w"> </span>http://ocsp.example.com
</code></pre></div></p>
<p><strong>Common Causes</strong>:
1. <strong>Network issues</strong>: Firewall blocking OCSP traffic
2. <strong>Responder overloaded</strong>: Too many queries
3. <strong>Responder down</strong>: Service failure</p>
<p><strong>Fixes</strong>:</p>
<ul>
<li>Enable OCSP stapling (server-side caching)</li>
<li>Increase OCSP responder capacity</li>
<li>Implement responder redundancy</li>
<li>Consider soft-fail policies</li>
</ul>
<h4 id="ocsp-response-verification-failed">"OCSP Response Verification Failed"</h4>
<p><strong>Diagnosis</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># Verbose OCSP query</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>openssl<span class="w"> </span>ocsp<span class="w"> </span>-CAfile<span class="w"> </span>ca.pem<span class="w"> </span>-issuer<span class="w"> </span>issuer.pem<span class="w"> </span>-cert<span class="w"> </span>server.crt<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">  </span>-url<span class="w"> </span>http://ocsp.example.com<span class="w"> </span>-resp_text
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="c1"># Check:</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="c1"># - Signature validation</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="c1"># - Response timing (This Update, Next Update)</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="c1"># - Nonce validation</span>
</code></pre></div></p>
<p><strong>Common Causes</strong>:
1. <strong>Wrong OCSP signing certificate</strong>: Not trusted by CA
2. <strong>Clock skew</strong>: Server/client time mismatch
3. <strong>Expired response</strong>: Next Update in past</p>
<p><strong>Fixes</strong>:</p>
<ul>
<li>Verify OCSP responder certificate properly signed</li>
<li>Sync system clocks (NTP)</li>
<li>Configure responder to issue fresh responses</li>
</ul>
<h2 id="common-pitfalls">Common Pitfalls</h2>
<ul>
<li><strong>Not checking revocation at all</strong>: Applications validating certificates without revocation checking</li>
<li><strong>Why it happens</strong>: Complexity; performance concerns; default configurations don't enable it</li>
<li><strong>How to avoid</strong>: Enable CRL or OCSP checking explicitly; test revocation validation</li>
<li>
<p><strong>How to fix</strong>: Configure revocation checking; verify with test revoked certificates</p>
</li>
<li>
<p><strong>Soft-fail without understanding implications</strong>: Accepting certificates when revocation check fails</p>
</li>
<li><strong>Why it happens</strong>: Default browser behavior; not understanding security trade-off</li>
<li><strong>How to avoid</strong>: Understand soft-fail vs hard-fail trade-offs; implement hard-fail for high-security</li>
<li>
<p><strong>How to fix</strong>: Configure hard-fail where appropriate; implement fallback strategies</p>
</li>
<li>
<p><strong>Stale CRLs</strong>: Publishing CRLs infrequently or not updating Next Update time</p>
</li>
<li><strong>Why it happens</strong>: CA operational issues; insufficient automation</li>
<li><strong>How to avoid</strong>: Automate CRL generation; monitor CRL freshness; alert on stale CRLs</li>
<li>
<p><strong>How to fix</strong>: Generate CRLs more frequently; fix CA automation; ensure reliable publication</p>
</li>
<li>
<p><strong>OCSP responder single point of failure</strong>: No redundancy for OCSP responder</p>
</li>
<li><strong>Why it happens</strong>: Underestimating OCSP criticality; cost concerns</li>
<li><strong>How to avoid</strong>: Deploy multiple OCSP responders; use load balancers; enable OCSP stapling</li>
<li>
<p><strong>How to fix</strong>: Add responder redundancy; implement stapling; monitor responder availability</p>
</li>
<li>
<p><strong>Ignoring OCSP privacy concerns</strong>: Not implementing OCSP stapling when privacy matters</p>
</li>
<li><strong>Why it happens</strong>: Lack of awareness; configuration complexity</li>
<li><strong>How to avoid</strong>: Enable OCSP stapling by default; understand privacy implications</li>
<li><strong>How to fix</strong>: Configure stapling; test with OpenSSL; monitor stapling rate</li>
</ul>
<h2 id="security-considerations">Security Considerations</h2>
<h3 id="revocation-check-bypass">Revocation Check Bypass</h3>
<p><strong>Attack Scenarios</strong>:</p>
<p><strong>OCSP Responder DoS</strong>:</p>
<ul>
<li>Attacker blocks access to OCSP responder</li>
<li>Soft-fail allows revoked certificate acceptance</li>
<li><strong>Mitigation</strong>: OCSP stapling (server caches responses)</li>
</ul>
<p><strong>CRL Download Prevention</strong>:</p>
<ul>
<li>Attacker blocks CRL download</li>
<li>Client cannot verify revocation status</li>
<li><strong>Mitigation</strong>: Local CRL caching; alternative verification methods</li>
</ul>
<p><strong>Clock Manipulation</strong>:</p>
<ul>
<li>Attacker manipulates system clock</li>
<li>OCSP response appears expired or not yet valid</li>
<li><strong>Mitigation</strong>: Secure time synchronization (NTP); detect clock skew</li>
</ul>
<h3 id="revocation-timing">Revocation Timing</h3>
<p><strong>Key Challenge</strong>: Revocation takes time to propagate</p>
<p><strong>CRL Propagation Delay</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>T0: Certificate compromised
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>T1: CA revokes certificate (updates database)
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>T2: Next CRL published (could be hours/days later)
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>T3: Clients download new CRL
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>T4: All clients have updated CRL
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>Exposure window: T0 to T4
</code></pre></div></p>
<p><strong>OCSP Propagation Delay</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>T0: Certificate compromised
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>T1: CA revokes certificate (updates database)
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>T2: OCSP responder queries database (typically near-instant)
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>T3: Clients query OCSP responder
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>Exposure window: T0 to T3 (minutes typically)
</code></pre></div></p>
<p><strong>Mitigation Strategies</strong>:</p>
<ul>
<li>Minimize exposure windows with frequent updates</li>
<li>Use OCSP for time-critical revocations</li>
<li>Consider short-lived certificates eliminating revocation need</li>
<li>Implement Certificate Transparency monitoring</li>
</ul>
<h3 id="privacy-vs-security">Privacy vs. Security</h3>
<p><strong>Privacy Concerns</strong>:</p>
<ul>
<li>OCSP queries reveal which certificates (and therefore sites) users validate</li>
<li>CA can track user browsing behavior</li>
<li>ISPs or network observers see OCSP queries</li>
</ul>
<p><strong>Privacy-Preserving Approaches</strong>:</p>
<ul>
<li><strong>OCSP Stapling</strong>: Server queries, client doesn't contact CA</li>
<li><strong>CRLite</strong>: Pre-fetched revocation data, no per-certificate queries</li>
<li><strong>Short-Lived Certificates</strong>: No revocation checking needed</li>
</ul>
<h2 id="real-world-examples">Real-World Examples</h2>
<h3 id="case-study-symantec-certificate-revocation-2017">Case Study: Symantec Certificate Revocation (2017)</h3>
<p><strong>Event</strong>: Google Chrome announced distrust of Symantec CA certificates</p>
<p><strong>Revocation Challenge</strong>:</p>
<ul>
<li>Thousands of certificates needed revocation/replacement</li>
<li>Immediate revocation would break many websites</li>
<li>Phased approach over 18 months</li>
</ul>
<p><strong>Process</strong>:
1. Announce deprecation timeline
2. Issue warnings in Chrome
3. Gradual increase in warning severity
4. Final distrust deadline</p>
<p><strong>Key Takeaway</strong>: Mass revocation requires careful planning. Immediate revocation of many certificates is operationally challenging.</p>
<h3 id="case-study-lets-encrypt-ocsp-capacity">Case Study: Let's Encrypt OCSP Capacity</h3>
<p><strong>Challenge</strong>: Let's Encrypt issues over 200 million certificates</p>
<p><strong>OCSP Requirements</strong>:</p>
<ul>
<li>Billions of OCSP queries per day</li>
<li>Sub-100ms response times</li>
<li>99.99% availability</li>
</ul>
<p><strong>Solution</strong>:</p>
<ul>
<li>Pre-generated OCSP responses</li>
<li>CDN distribution of responses</li>
<li>Minimal response sizes (no certificates in response)</li>
<li>Aggressive caching strategies</li>
</ul>
<p><strong>Key Takeaway</strong>: OCSP at scale requires architectural optimization. Pre-generation and caching critical for performance.</p>
<h3 id="case-study-crl-distribution-point-outages">Case Study: CRL Distribution Point Outages</h3>
<p><strong>Common Issue</strong>: CRL servers going down breaking certificate validation</p>
<p><strong>Example Incidents</strong>:</p>
<ul>
<li>Corporate firewall blocking CRL access</li>
<li>CRL server capacity exceeded</li>
<li>DNS issues preventing CRL resolution</li>
</ul>
<p><strong>Impact</strong>:</p>
<ul>
<li>Applications fail to validate certificates</li>
<li>Soft-fail browsers continue working</li>
<li>Hard-fail applications break</li>
</ul>
<p><strong>Key Takeaway</strong>: CRL infrastructure must be as reliable as CA infrastructure. Redundancy and monitoring essential.</p>
<h2 id="further-reading">Further Reading</h2>
<h3 id="essential-resources">Essential Resources</h3>
<ul>
<li><a href="https://www.rfc-editor.org/rfc/rfc6960">RFC 6960 - Online Certificate Status Protocol</a> - OCSP standard</li>
<li><a href="https://www.rfc-editor.org/rfc/rfc5280">RFC 5280 - X.509 Certificate and CRL Profile</a> - CRL specification</li>
<li><a href="https://www.rfc-editor.org/rfc/rfc6066">RFC 6066 - TLS Extensions (OCSP Stapling)</a> - OCSP stapling standard</li>
<li><a href="https://blog.mozilla.org/security/2020/01/09/crlite-part-1-all-web-pki-revocations-compressed/">Mozilla CRLite</a> - Modern revocation approach</li>
</ul>
<h3 id="advanced-topics">Advanced Topics</h3>
<ul>
<li><a href="../../operations/certificate-lifecycle-management/">Certificate Lifecycle Management</a> - Managing certificate revocation operationally</li>
<li><a href="../tls-protocol/">Tls Protocol</a> - How revocation checking fits into TLS</li>
<li><a href="../../foundations/certificate-anatomy/">Certificate Anatomy</a> - CRL Distribution Points extension</li>
<li><a href="../../troubleshooting/chain-validation-errors/">Chain Validation Errors</a> - Debugging revocation failures</li>
</ul>
<h2 id="references">References</h2>
<h2 id="change-history">Change History</h2>
<table>
<thead>
<tr>
<th>Date</th>
<th>Version</th>
<th>Changes</th>
<th>Reason</th>
</tr>
</thead>
<tbody>
<tr>
<td>2025-11-09</td>
<td>1.0</td>
<td>Initial creation</td>
<td>Essential revocation standard documentation</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Quality Checks</strong>: </p>
<ul>
<li>[x] All claims cited from authoritative sources</li>
<li>[x] Cross-references validated</li>
<li>[x] Practical guidance included</li>
<li>[x] Examples are current and relevant</li>
<li>[x] Security considerations addressed</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Santesson, S., et al. "X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP." RFC 6960, June 2013. <a href="https://www.rfc-editor.org/rfc/rfc6960">Rfc-editor - Rfc6960</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Cooper, D., et al. "Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile." RFC 5280, May 2008. <a href="https://www.rfc-editor.org/rfc/rfc5280">Rfc-editor - Rfc5280</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
  



  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/axonsecurity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var sidebar = document.querySelector('.md-sidebar--secondary .md-sidebar__scrollwrap');
      if (sidebar) {
        var disclaimer = document.createElement('div');
        disclaimer.className = 'md-sidebar-disclaimer';
        disclaimer.innerHTML = `
          <div class="md-typeset">
            <div class="admonition tip">
              <p class="admonition-title">Our Books</p>
              <p><a href="https://axonshield.com/book"><strong>The Invisible Certificate Management Tax and How Automation Eliminates 94% of It</strong></a></p>
            </div>
            <div class="admonition warning">
              <p class="admonition-title">Disclaimer</p>
              <p><small>This documentation is based on "best practices". We've observed these ignore 
                unique organizational needs and often prove ineffective for long-term, sustainable 
                operations and ignore strategic advanteges of building infrastructure intelligence.</small></p>
            </div>
          </div>
        `;
        sidebar.insertBefore(disclaimer, sidebar.firstChild);
      }
    });
  </script>
  

  </body>
</html>