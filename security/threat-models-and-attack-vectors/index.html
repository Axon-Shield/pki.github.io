
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://vault.axonshield.com/security/threat-models-and-attack-vectors/">
      
      
        <link rel="prev" href="../private-key-protection/">
      
      
        <link rel="next" href="../../standards/acme-protocol/">
      
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Threat Models and Attack Vectors - Shield Vault</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


    
    
    
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WJXPDRF2');</script>
  <!-- End Google Tag Manager -->
  
  <!-- Apollo Tracking -->
  <script>
    (function() {
      var apolloScript = document.createElement('script');
      apolloScript.type = 'text/javascript';
      apolloScript.async = true;
      apolloScript.src = 'https://cdn.apollo.io/v1/apollo.js';
      apolloScript.setAttribute('data-apollo-id', '68b8b91c5e883f0021f7f7aa');
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(apolloScript, s);
    })();
  </script>
  <!-- End Apollo Tracking -->
  
  <!-- Organization Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "ProfessionalService",
    "name": "Axon Shield",
    "url": "https://vault.axonshield.com",
    "logo": "https://vault.axonshield.com/logo.png",
    "description": "Enterprise PKI and certificate automation consulting. Cambridge postdoctoral expertise with implementations at Barclays, Deutsche Bank, Sky UK, and Comcast. Specializing in HSM integration, multi-tenant PKI architecture, and certificate management for fintech and healthcare.",
    "priceRange": "$$$",
    "areaServed": {
      "@type": "Country",
      "name": "Worldwide"
    },
    "serviceType": [
      "PKI Architecture Consulting",
      "Certificate Automation Implementation", 
      "HSM Integration",
      "Multi-Tenant PKI Design",
      "Certificate Management Strategy",
      "Post-Quantum Cryptography Planning"
    ],
    "founder": {
      "@type": "Person",
      "name": "Dan Cvrcek",
      "jobTitle": "Founder and Principal Consultant",
      "description": "Cambridge postdoctoral researcher specializing in PKI and cryptography. Black Hat and DEF CON conference speaker with 20+ years implementing certificate infrastructure for Fortune 500 companies.",
      "alumniOf": {
        "@type": "CollegeOrUniversity",
        "name": "University of Cambridge",
        "sameAs": "https://www.cam.ac.uk"
      },
      "honorificPrefix": "Dr.",
      "knowsAbout": [
        {
          "@type": "Thing",
          "name": "Public Key Infrastructure",
          "sameAs": "https://en.wikipedia.org/wiki/Public_key_infrastructure"
        },
        {
          "@type": "Thing", 
          "name": "Hardware Security Module",
          "sameAs": "https://en.wikipedia.org/wiki/Hardware_security_module"
        },
        {
          "@type": "Thing",
          "name": "Certificate Automation"
        },
        {
          "@type": "Thing",
          "name": "PKCS#11"
        },
        {
          "@type": "Thing",
          "name": "Zero Trust Architecture"
        },
        {
          "@type": "Thing",
          "name": "Operational Models"
        }
      ],
      "award": [
        "Black Hat USA Conference Speaker",
        "DEF CON Conference Speaker"
      ],
      "workExample": [
        {
          "@type": "Organization",
          "name": "Barclays",
          "sameAs": "https://en.wikipedia.org/wiki/Barclays"
        },
        {
          "@type": "Organization",
          "name": "Deutsche Bank",
          "sameAs": "https://en.wikipedia.org/wiki/Deutsche_Bank"
        },
        {
          "@type": "Organization",
          "name": "Sky UK",
          "sameAs": "https://en.wikipedia.org/wiki/Sky_UK"
        },
        {
          "@type": "Organization",
          "name": "TSB Bank PLC (part of Banco Sabadell)",
          "sameAs": "https://en.wikipedia.org/wiki/TSB"
        },
        {
          "@type": "Organization",
          "name": "Comcast",
          "sameAs": "https://en.wikipedia.org/wiki/Comcast"
        }
      ],
      "hasCredential": [
        {
          "@type": "EducationalOccupationalCredential",
          "credentialCategory": "Postdoctoral Research",
          "recognizedBy": {
            "@type": "CollegeOrUniversity",
            "name": "University of Cambridge"
          }
        },
        {
          "@type": "EducationalOccupationalCredential",
          "credentialCategory": "Professor (Docent)",
          "recognizedBy": {
            "@type": "CollegeOrUniversity",
            "name": "Brno University of Technology"
          }
        }
      ]
    },
    "hasOfferCatalog": {
      "@type": "OfferCatalog",
      "name": "Consulting Services",
      "itemListElement": [
        {
          "@type": "Offer",
          "itemOffered": {
            "@type": "Service",
            "name": "PKI Architecture Assessment",
            "description": "Comprehensive evaluation of PKI readiness, architecture design, and implementation planning"
          }
        },
        {
          "@type": "Offer",
          "itemOffered": {
            "@type": "Service", 
            "name": "HSM Integration Implementation",
            "description": "End-to-end HSM deployment including vendor selection, PKCS#11 integration, and operational procedures"
          }
        },
        {
          "@type": "Offer",
          "itemOffered": {
            "@type": "Service",
            "name": "Certificate Automation Strategy",
            "description": "Multi-tenant PKI design, ACME implementation, and certificate lifecycle automation"
          }
        },
        {
          "@type": "Offer",
          "itemOffered": {
            "@type": "Service",
            "name": "Infrastructure Intelligence - Operational Model",
            "description": "Integration with Asset Management, CMDB, Runbooks, Integrated Network Perimeter (WAF, DoS, DNS, PKI)", 
          }
        },
        {
          "@type": "Offer",
          "itemOffered": {
            "@type": "Service",
            "name": "PKI Rescue Consulting",
            "description": "Emergency response for certificate outages, HSM failures, and PKI implementation problems"
          }
        }
      ]
    },
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "5.0",
      "reviewCount": "12",
      "bestRating": "5"
    }
  }
  </script>
  <!-- End Organization Schema -->

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#threat-models-and-attack-vectors" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Shield Vault" class="md-header__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Shield Vault
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Threat Models and Attack Vectors
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Why Certificate Management Matters

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../quick-start/" class="md-tabs__link">
        
  
  
    
  
  Quick Start Guide

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../technical-guide/" class="md-tabs__link">
        
  
  
    
  
  Foundations for Infrastructure Intelligence - Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../architecture/case-studies/" class="md-tabs__link">
          
  
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../business/cost_of_certificate_management/" class="md-tabs__link">
          
  
  
  Business

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../foundations/certificate-anatomy/" class="md-tabs__link">
          
  
  
  Foundations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../implementation/acme-protocol-implementation/" class="md-tabs__link">
          
  
  
  Implementation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../operations/certificate-lifecycle-management/" class="md-tabs__link">
          
  
  
  Operations

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../patterns/ca-hierarchies/" class="md-tabs__link">
          
  
  
  Patterns

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ca-compromise-scenarios/" class="md-tabs__link">
          
  
  
  Security

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../standards/acme-protocol/" class="md-tabs__link">
          
  
  
  Standards

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../strategy/success-metrics/" class="md-tabs__link">
          
  
  
  Strategy

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../troubleshooting/chain-validation-errors/" class="md-tabs__link">
          
  
  
  Troubleshooting

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../vendors/digicert-certcentral/" class="md-tabs__link">
          
  
  
  Vendors

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Shield Vault" class="md-nav__button md-logo" aria-label="Shield Vault" data-md-component="logo">
      
  <img src="../../assets/axon-logo.png" alt="logo">

    </a>
    Shield Vault
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why Certificate Management Matters
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technical-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Foundations for Infrastructure Intelligence - Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/case-studies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Case Studies - Certificate Management at Scale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/certificate-as-code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate-as-Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/mutual-tls-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mutual TLS Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/service-mesh-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Service Mesh Certificates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/zero-trust-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zero-Trust Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Business
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Business
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../business/cost_of_certificate_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The $67 Million Risk: Hidden Costs of Manual Certificate Management
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Foundations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Foundations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/certificate-anatomy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Anatomy
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/cryptographic-primitives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cryptographic Primitives
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/public-private-key-pairs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Public-Private Key Pairs
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/trust-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trust Models
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../foundations/what-is-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is PKI?
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Implementation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/acme-protocol-implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol Implementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/ca-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Architecture
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/certificate-issuance-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Issuance Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/hsm-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HSM Integration
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/hsm-operational-failures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HSM Operational Failures
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/multi-cloud-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Cloud PKI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/onprem-vs-cloud-hsm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    On-Premises vs Cloud HSM
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/certificate-lifecycle-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Lifecycle Management
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/certificate-rotation-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Rotation Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/inventory-and-discovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inventory and Discovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/monitoring-and-alerting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring and Alerting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/renewal-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Renewal Automation
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Patterns
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/ca-hierarchies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Hierarchies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/cloud-vs-on-premises/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud vs On-Premises
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/high-availability-disaster-recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    High Availability and Disaster Recovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/multi-tenancy-considerations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Tenancy Considerations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" checked>
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ca-compromise-scenarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CA Compromise Scenarios
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate-pinning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certificate Pinning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../common-vulnerabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Vulnerabilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compliance-and-audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compliance and Audit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../incident-response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Incident Response
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../key-management-best-practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Key Management Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../private-key-protection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Private Key Protection
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Threat Models and Attack Vectors
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Threat Models and Attack Vectors
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pki-threat-landscape" class="md-nav__link">
    <span class="md-ellipsis">
      PKI Threat Landscape
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PKI Threat Landscape">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attacker-profiles" class="md-nav__link">
    <span class="md-ellipsis">
      Attacker Profiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-surface-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Surface Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cryptographic-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Cryptographic Attacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cryptographic Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#algorithm-weaknesses" class="md-nav__link">
    <span class="md-ellipsis">
      Algorithm Weaknesses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#side-channel-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Side-Channel Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quantum-computing-threats" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Computing Threats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#certificate-authority-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Authority Attacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Certificate Authority Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ca-compromise" class="md-nav__link">
    <span class="md-ellipsis">
      CA Compromise
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fraudulent-certificate-issuance" class="md-nav__link">
    <span class="md-ellipsis">
      Fraudulent Certificate Issuance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#man-in-the-middle-mitm-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Man-in-the-Middle (MITM) Attacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#private-key-compromise" class="md-nav__link">
    <span class="md-ellipsis">
      Private Key Compromise
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Private Key Compromise">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-theft-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      Key Theft Scenarios
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-compromise-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Key Compromise Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-compromise-response" class="md-nav__link">
    <span class="md-ellipsis">
      Key Compromise Response
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#protocol-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Attacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Protocol Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tlsssl-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      TLS/SSL Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-validation-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Validation Attacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operational-security-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Security Failures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operational Security Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supply-chain-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Supply Chain Attacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defense-in-depth" class="md-nav__link">
    <span class="md-ellipsis">
      Defense in Depth
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Defense in Depth">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#layered-security-controls" class="md-nav__link">
    <span class="md-ellipsis">
      Layered Security Controls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#historical-attacks-and-incidents" class="md-nav__link">
    <span class="md-ellipsis">
      Historical Attacks and Incidents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cryptographic-attack-research" class="md-nav__link">
    <span class="md-ellipsis">
      Cryptographic Attack Research
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protocol-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-transparency" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Transparency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-level-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Network-Level Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threat-modeling-frameworks" class="md-nav__link">
    <span class="md-ellipsis">
      Threat Modeling Frameworks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operational-security" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defense-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Defense Strategies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#standards-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Standards and Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#academic-surveys-and-books" class="md-nav__link">
    <span class="md-ellipsis">
      Academic Surveys and Books
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Standards
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Standards
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/acme-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACME Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/ocsp-and-crl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OCSP and CRL
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/pkcs-standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PKCS Standards
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/tls-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TLS Protocol
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../standards/x509-standard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    X.509 Standard
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Strategy
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Strategy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../strategy/success-metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Success Metrics and KPIs for Certificate Automation
    
  </span>
  
    
  
  
    <span class="md-status md-status--stable"></span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Troubleshooting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/chain-validation-errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chain Validation Errors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/common-misconfigurations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Common Misconfigurations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/expired-certificate-outages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Expired Certificate Outages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/performance-bottlenecks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Bottlenecks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Vendors
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Vendors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/digicert-certcentral/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DigiCert CertCentral
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/hashicorp-vault-pki/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HashiCorp Vault PKI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/keyfactor-command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Keyfactor Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/venafi-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Venafi Platform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/vendor-comparison-matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vendor Comparison Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pki-threat-landscape" class="md-nav__link">
    <span class="md-ellipsis">
      PKI Threat Landscape
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PKI Threat Landscape">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attacker-profiles" class="md-nav__link">
    <span class="md-ellipsis">
      Attacker Profiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attack-surface-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Surface Analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cryptographic-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Cryptographic Attacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cryptographic Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#algorithm-weaknesses" class="md-nav__link">
    <span class="md-ellipsis">
      Algorithm Weaknesses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#side-channel-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Side-Channel Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quantum-computing-threats" class="md-nav__link">
    <span class="md-ellipsis">
      Quantum Computing Threats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#certificate-authority-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Authority Attacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Certificate Authority Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ca-compromise" class="md-nav__link">
    <span class="md-ellipsis">
      CA Compromise
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fraudulent-certificate-issuance" class="md-nav__link">
    <span class="md-ellipsis">
      Fraudulent Certificate Issuance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#man-in-the-middle-mitm-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Man-in-the-Middle (MITM) Attacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#private-key-compromise" class="md-nav__link">
    <span class="md-ellipsis">
      Private Key Compromise
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Private Key Compromise">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-theft-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      Key Theft Scenarios
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-compromise-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Key Compromise Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-compromise-response" class="md-nav__link">
    <span class="md-ellipsis">
      Key Compromise Response
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#protocol-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Attacks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Protocol Attacks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tlsssl-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      TLS/SSL Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-validation-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Validation Attacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operational-security-failures" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Security Failures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operational Security Failures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supply-chain-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Supply Chain Attacks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defense-in-depth" class="md-nav__link">
    <span class="md-ellipsis">
      Defense in Depth
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Defense in Depth">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#layered-security-controls" class="md-nav__link">
    <span class="md-ellipsis">
      Layered Security Controls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#historical-attacks-and-incidents" class="md-nav__link">
    <span class="md-ellipsis">
      Historical Attacks and Incidents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cryptographic-attack-research" class="md-nav__link">
    <span class="md-ellipsis">
      Cryptographic Attack Research
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protocol-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-transparency" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Transparency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-level-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Network-Level Attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-vulnerabilities" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation Vulnerabilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threat-modeling-frameworks" class="md-nav__link">
    <span class="md-ellipsis">
      Threat Modeling Frameworks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operational-security" class="md-nav__link">
    <span class="md-ellipsis">
      Operational Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defense-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Defense Strategies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#standards-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Standards and Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#academic-surveys-and-books" class="md-nav__link">
    <span class="md-ellipsis">
      Academic Surveys and Books
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WJXPDRF2"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
  <!-- Right sidebar with disclaimer above TOC -->
  
    <style>
      @media screen and (min-width: 76.25em) {
        .md-sidebar--secondary {
          order: 1;
        }
        .md-sidebar--secondary::before {
          content: '';
          display: block;
          margin-bottom: 1rem;
        }
      }
    </style>
  
  
  
                  



<h1 id="threat-models-and-attack-vectors">Threat Models and Attack Vectors</h1>
<h2 id="overview">Overview</h2>
<p>Public Key Infrastructure is a critical security foundation, yet it presents a rich attack surface. Understanding PKI threat models isn't about paranoiait's about building resilient systems that fail safely when attacked. Every PKI implementation must consider not just the happy path of certificate issuance and validation, but the adversarial scenarios where attackers exploit weaknesses in cryptography, protocols, implementation, or operations.</p>
<p><strong>Core principle</strong>: Security is achieved not by eliminating all threats, but by understanding threat models and implementing appropriate controls that make attacks impractical, detectable, or contained in their impact.</p>
<h2 id="pki-threat-landscape">PKI Threat Landscape</h2>
<h3 id="attacker-profiles">Attacker Profiles</h3>
<p><strong>Nation-state actors</strong>:</p>
<ul>
<li>Capabilities: Advanced persistent threats, zero-day exploits, supply chain compromise</li>
<li>Motivations: Espionage, sabotage, strategic advantage</li>
<li>Targets: Certificate authorities, root key material, signing infrastructure</li>
<li>Notable examples: Stuxnet (2010), DigiNotar compromise (2011)</li>
</ul>
<p><strong>Organized cybercrime</strong>:</p>
<ul>
<li>Capabilities: Sophisticated tooling, insider recruitment, targeted phishing</li>
<li>Motivations: Financial gain, ransomware, data theft</li>
<li>Targets: Private keys for impersonation, certificate authorities for fraudulent issuance</li>
<li>Notable examples: Comodo CA breach attempt (2011)</li>
</ul>
<p><strong>Insider threats</strong>:</p>
<ul>
<li>Capabilities: Legitimate access, knowledge of internal systems, trust relationships</li>
<li>Motivations: Financial, ideological, coercion, negligence</li>
<li>Targets: Private keys, CA credentials, certificate issuance systems</li>
<li>Risk: 30-40% of security incidents involve insider elements</li>
</ul>
<p><strong>Opportunistic attackers</strong>:</p>
<ul>
<li>Capabilities: Automated scanning, known exploits, social engineering</li>
<li>Motivations: Any available attack surface, broad targeting</li>
<li>Targets: Weak implementations, misconfigurations, expired certificates</li>
<li>Volume: Highest volume but typically lower sophistication</li>
</ul>
<h3 id="attack-surface-analysis">Attack Surface Analysis</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>                    PKI Attack Surface                        
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>                                                              
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>       
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>     Key Storage      CA Operations     Certificate   
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                                        Validation    
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>     HSMs             Issuance         Trust       
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>     Key files        Validation       Revocation  
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>     Memory           Approval         Pinning     
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>       
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>                                                           
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>                    
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>                                                             
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>       
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    Cryptographic     Protocol          Operational   
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    Primitives        Implementation    Processes     
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>                                                      
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>     Algorithms       TLS/SSL          Issuance    
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>     RNG              ACME             Rotation    
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>     Side chan.       SCEP             Incident    
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>       
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
</code></pre></div>
<h2 id="cryptographic-attacks">Cryptographic Attacks</h2>
<h3 id="algorithm-weaknesses">Algorithm Weaknesses</h3>
<p><strong>Collision attacks on hash functions</strong>:</p>
<p>MD5 collision (2008):
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Demonstrated MD5 collision allowing two certificates with same hash</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c1"># but different public keys</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">md5_collision_attack_scenario</span><span class="p">():</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="sd">    How MD5 collisions enable certificate fraud</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    <span class="c1"># Attacker creates two CSRs with carefully crafted content</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="c1"># that produces MD5 collision</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    <span class="n">legitimate_csr</span> <span class="o">=</span> <span class="n">create_csr</span><span class="p">(</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>        <span class="n">common_name</span><span class="o">=</span><span class="s2">&quot;attacker.com&quot;</span><span class="p">,</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>        <span class="n">collision_block</span><span class="o">=</span><span class="n">collision_data_1</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    <span class="p">)</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>    <span class="n">fraudulent_csr</span> <span class="o">=</span> <span class="n">create_csr</span><span class="p">(</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>        <span class="n">common_name</span><span class="o">=</span><span class="s2">&quot;bank.com&quot;</span><span class="p">,</span>  <span class="c1"># Target domain</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>        <span class="n">collision_block</span><span class="o">=</span><span class="n">collision_data_2</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>    <span class="p">)</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>    <span class="c1"># Both CSRs have identical MD5 hash</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>    <span class="k">assert</span> <span class="n">md5</span><span class="p">(</span><span class="n">legitimate_csr</span><span class="p">)</span> <span class="o">==</span> <span class="n">md5</span><span class="p">(</span><span class="n">fraudulent_csr</span><span class="p">)</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>    <span class="c1"># Submit legitimate CSR to CA</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>    <span class="n">cert</span> <span class="o">=</span> <span class="n">ca</span><span class="o">.</span><span class="n">issue_certificate</span><span class="p">(</span><span class="n">legitimate_csr</span><span class="p">)</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>    <span class="c1"># Certificate signature validates for both CSRs!</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>    <span class="c1"># Attacker can now impersonate bank.com</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>    <span class="k">assert</span> <span class="n">verify_signature</span><span class="p">(</span><span class="n">cert</span><span class="p">,</span> <span class="n">legitimate_csr</span><span class="p">)</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>    <span class="k">assert</span> <span class="n">verify_signature</span><span class="p">(</span><span class="n">cert</span><span class="p">,</span> <span class="n">fraudulent_csr</span><span class="p">)</span>
</code></pre></div></p>
<p>Defense:</p>
<ul>
<li><strong>Never use MD5 or SHA-1 for certificate signatures</strong></li>
<li>Minimum: SHA-256</li>
<li>Preferred: SHA-384 or SHA-512</li>
<li>Monitor for deprecated algorithms in use</li>
</ul>
<p><strong>RSA key length attacks</strong>:</p>
<p>Factorization timeline:</p>
<ul>
<li>512-bit RSA: Factored in 1999</li>
<li>768-bit RSA: Factored in 2009</li>
<li>1024-bit RSA: Considered breakable by well-resourced adversaries</li>
<li>2048-bit RSA: Current minimum recommendation</li>
<li>4096-bit RSA: Conservative choice for long-term security</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">KeyStrengthValidator</span><span class="p">:</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="sd">    Validate cryptographic key strength</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    <span class="n">MINIMUM_KEY_SIZES</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>        <span class="s1">&#39;RSA&#39;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>        <span class="s1">&#39;DSA&#39;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>        <span class="s1">&#39;ECDSA&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>        <span class="s1">&#39;EdDSA&#39;</span><span class="p">:</span> <span class="mi">256</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    <span class="p">}</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    <span class="n">RECOMMENDED_KEY_SIZES</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>        <span class="s1">&#39;RSA&#39;</span><span class="p">:</span> <span class="mi">3072</span><span class="p">,</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>        <span class="s1">&#39;DSA&#39;</span><span class="p">:</span> <span class="mi">3072</span><span class="p">,</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>        <span class="s1">&#39;ECDSA&#39;</span><span class="p">:</span> <span class="mi">384</span><span class="p">,</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>        <span class="s1">&#39;EdDSA&#39;</span><span class="p">:</span> <span class="mi">448</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>    <span class="p">}</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_key_strength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValidationResult</span><span class="p">:</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="sd">        Validate certificate key meets minimum requirements</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">ValidationResult</span><span class="p">()</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>        <span class="n">algorithm</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">public_key_algorithm</span>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>        <span class="n">key_size</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">key_size</span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>        <span class="k">if</span> <span class="n">algorithm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">MINIMUM_KEY_SIZES</span><span class="p">:</span>
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>            <span class="n">result</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported algorithm: </span><span class="si">{</span><span class="n">algorithm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>            <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>        <span class="n">minimum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MINIMUM_KEY_SIZES</span><span class="p">[</span><span class="n">algorithm</span><span class="p">]</span>
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>        <span class="n">recommended</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RECOMMENDED_KEY_SIZES</span><span class="p">[</span><span class="n">algorithm</span><span class="p">]</span>
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>        <span class="k">if</span> <span class="n">key_size</span> <span class="o">&lt;</span> <span class="n">minimum</span><span class="p">:</span>
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>            <span class="n">result</span><span class="o">.</span><span class="n">fail</span><span class="p">(</span>
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">algorithm</span><span class="si">}</span><span class="s2"> key size </span><span class="si">{</span><span class="n">key_size</span><span class="si">}</span><span class="s2"> below minimum </span><span class="si">{</span><span class="n">minimum</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>            <span class="p">)</span>
<a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>        <span class="k">elif</span> <span class="n">key_size</span> <span class="o">&lt;</span> <span class="n">recommended</span><span class="p">:</span>
<a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>            <span class="n">result</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">algorithm</span><span class="si">}</span><span class="s2"> key size </span><span class="si">{</span><span class="n">key_size</span><span class="si">}</span><span class="s2"> below recommended </span><span class="si">{</span><span class="n">recommended</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>            <span class="p">)</span>
<a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>            <span class="n">result</span><span class="o">.</span><span class="n">pass_check</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">algorithm</span><span class="si">}</span><span class="s2"> key size adequate: </span><span class="si">{</span><span class="n">key_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>
<a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>        <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
<h3 id="side-channel-attacks">Side-Channel Attacks</h3>
<p><strong>Timing attacks</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Vulnerable: Timing leak in RSA signature verification</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">vulnerable_signature_verify</span><span class="p">(</span><span class="n">signature</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> 
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>                               <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>                               <span class="n">public_key</span><span class="p">:</span> <span class="n">RSAPublicKey</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="sd">    VULNERABLE: Early return leaks information via timing</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="n">expected</span> <span class="o">=</span> <span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="c1"># Early return if lengths differ - timing leak!</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">expected</span><span class="p">):</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>    <span class="c1"># Byte-by-byte comparison - timing leak!</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signature</span><span class="p">)):</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>        <span class="k">if</span> <span class="n">signature</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">expected</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>            <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># Early return leaks position of first difference</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>    <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="c1"># Secure: Constant-time comparison</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="k">def</span><span class="w"> </span><span class="nf">secure_signature_verify</span><span class="p">(</span><span class="n">signature</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>                            <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> 
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>                            <span class="n">public_key</span><span class="p">:</span> <span class="n">RSAPublicKey</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="sd">    SECURE: Constant-time comparison prevents timing attacks</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>    <span class="n">expected</span> <span class="o">=</span> <span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>    <span class="c1"># Use constant-time comparison</span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>    <span class="k">return</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">signature</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</code></pre></div>
<p><strong>Power analysis</strong>:</p>
<p>Physical attacks on cryptographic hardware:</p>
<ul>
<li><strong>Simple Power Analysis (SPA)</strong>: Observing power consumption during crypto operations</li>
<li><strong>Differential Power Analysis (DPA)</strong>: Statistical analysis of power traces</li>
<li><strong>Correlation Power Analysis (CPA)</strong>: Advanced statistical techniques</li>
</ul>
<p>Defense:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">SecureKeyOperations</span><span class="p">:</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="sd">    Guidelines for secure key operations resistant to side-channels</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">secure_key_storage</span><span class="p">():</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="sd">        Recommendations for protecting keys from physical attacks</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>            <span class="s1">&#39;hardware_security_modules&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Tamper-resistant hardware for key storage&#39;</span><span class="p">,</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>                <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>                    <span class="s1">&#39;Zeroization on tampering&#39;</span><span class="p">,</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>                    <span class="s1">&#39;Shielded enclosures&#39;</span><span class="p">,</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>                    <span class="s1">&#39;Active tamper detection&#39;</span><span class="p">,</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>                    <span class="s1">&#39;Power analysis countermeasures&#39;</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>                <span class="p">],</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>                <span class="s1">&#39;certifications&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;FIPS 140-2 Level 3+&#39;</span><span class="p">,</span> <span class="s1">&#39;Common Criteria EAL4+&#39;</span><span class="p">]</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>            <span class="p">},</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>            <span class="s1">&#39;algorithm_hardening&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>                <span class="s1">&#39;blinding&#39;</span><span class="p">:</span> <span class="s1">&#39;Randomize intermediate values&#39;</span><span class="p">,</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>                <span class="s1">&#39;constant_time&#39;</span><span class="p">:</span> <span class="s1">&#39;Fixed execution time regardless of input&#39;</span><span class="p">,</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>                <span class="s1">&#39;masking&#39;</span><span class="p">:</span> <span class="s1">&#39;Split sensitive values across random shares&#39;</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>            <span class="p">},</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>            <span class="s1">&#39;operational_security&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>                <span class="s1">&#39;physical_access_control&#39;</span><span class="p">:</span> <span class="s1">&#39;Restricted access to crypto hardware&#39;</span><span class="p">,</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>                <span class="s1">&#39;environmental_monitoring&#39;</span><span class="p">:</span> <span class="s1">&#39;Detect anomalous power/EM emissions&#39;</span><span class="p">,</span>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>                <span class="s1">&#39;audit_logging&#39;</span><span class="p">:</span> <span class="s1">&#39;Log all key access and operations&#39;</span>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>            <span class="p">}</span>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>        <span class="p">}</span>
</code></pre></div></p>
<h3 id="quantum-computing-threats">Quantum Computing Threats</h3>
<p><strong>Post-quantum cryptography timeline</strong>:</p>
<p>Current status (2025):</p>
<ul>
<li><strong>RSA/ECDSA</strong>: Vulnerable to Shor's algorithm on quantum computers</li>
<li><strong>Timeline</strong>: Large-scale quantum computers 10-20 years away</li>
<li><strong>Action required</strong>: Begin transition planning now</li>
</ul>
<p>NIST post-quantum standards:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">post_quantum_algorithms</span><span class="p">:</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span><span class="nt">digital_signatures</span><span class="p">:</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CRYSTALS-Dilithium&quot;</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NIST</span><span class="nv"> </span><span class="s">standardized</span><span class="nv"> </span><span class="s">(2024)&quot;</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">      </span><span class="nt">security_level</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;High&quot;</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">      </span><span class="nt">performance</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Good&quot;</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;FALCON&quot;</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NIST</span><span class="nv"> </span><span class="s">standardized</span><span class="nv"> </span><span class="s">(2024)&quot;</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">      </span><span class="nt">security_level</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;High&quot;</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">      </span><span class="nt">performance</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Excellent</span><span class="nv"> </span><span class="s">(compact</span><span class="nv"> </span><span class="s">signatures)&quot;</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SPHINCS+&quot;</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NIST</span><span class="nv"> </span><span class="s">standardized</span><span class="nv"> </span><span class="s">(2024)&quot;</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">      </span><span class="nt">security_level</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Very</span><span class="nv"> </span><span class="s">High&quot;</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">      </span><span class="nt">performance</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Slower</span><span class="nv"> </span><span class="s">(stateless</span><span class="nv"> </span><span class="s">hash-based)&quot;</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">  </span><span class="nt">key_exchange</span><span class="p">:</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CRYSTALS-Kyber&quot;</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">      </span><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NIST</span><span class="nv"> </span><span class="s">standardized</span><span class="nv"> </span><span class="s">(2024)&quot;</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">      </span><span class="nt">security_level</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;High&quot;</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">      </span><span class="nt">performance</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Excellent&quot;</span>
</code></pre></div></p>
<p>Migration strategy:
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">QuantumMigrationStrategy</span><span class="p">:</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="sd">    Phased approach to post-quantum cryptography</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">phases</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>            <span class="s1">&#39;phase_1_inventory&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>                <span class="s1">&#39;timeline&#39;</span><span class="p">:</span> <span class="s1">&#39;2025-2026&#39;</span><span class="p">,</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>                <span class="s1">&#39;actions&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>                    <span class="s1">&#39;Inventory all cryptographic systems&#39;</span><span class="p">,</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>                    <span class="s1">&#39;Identify quantum-vulnerable components&#39;</span><span class="p">,</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>                    <span class="s1">&#39;Assess criticality and data sensitivity&#39;</span><span class="p">,</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>                    <span class="s1">&#39;Calculate cryptographic shelf life&#39;</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>                <span class="p">]</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>            <span class="p">},</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>            <span class="s1">&#39;phase_2_hybrid&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>                <span class="s1">&#39;timeline&#39;</span><span class="p">:</span> <span class="s1">&#39;2026-2028&#39;</span><span class="p">,</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>                <span class="s1">&#39;actions&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>                    <span class="s1">&#39;Deploy hybrid classical/post-quantum schemes&#39;</span><span class="p">,</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>                    <span class="s1">&#39;Update TLS to support PQ key exchange&#39;</span><span class="p">,</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>                    <span class="s1">&#39;Test PQ signature schemes in non-critical systems&#39;</span><span class="p">,</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>                    <span class="s1">&#39;Build operational expertise&#39;</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>                <span class="p">]</span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>            <span class="p">},</span>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>            <span class="s1">&#39;phase_3_transition&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>                <span class="s1">&#39;timeline&#39;</span><span class="p">:</span> <span class="s1">&#39;2028-2032&#39;</span><span class="p">,</span>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>                <span class="s1">&#39;actions&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>                    <span class="s1">&#39;Migrate critical systems to PQ crypto&#39;</span><span class="p">,</span>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>                    <span class="s1">&#39;Phase out classical-only systems&#39;</span><span class="p">,</span>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>                    <span class="s1">&#39;Re-issue certificates with PQ signatures&#39;</span><span class="p">,</span>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>                    <span class="s1">&#39;Update root and intermediate CAs&#39;</span>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>                <span class="p">]</span>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>            <span class="p">},</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>            <span class="s1">&#39;phase_4_full_pq&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>                <span class="s1">&#39;timeline&#39;</span><span class="p">:</span> <span class="s1">&#39;2032+&#39;</span><span class="p">,</span>
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>                <span class="s1">&#39;actions&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>                    <span class="s1">&#39;Complete migration to post-quantum&#39;</span><span class="p">,</span>
<a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>                    <span class="s1">&#39;Decommission classical cryptography&#39;</span><span class="p">,</span>
<a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>                    <span class="s1">&#39;Maintain only PQ infrastructure&#39;</span>
<a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>                <span class="p">]</span>
<a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>            <span class="p">}</span>
<a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>        <span class="p">}</span>
<a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>
<a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">assess_quantum_risk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_sensitivity</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>                           <span class="n">retention_period</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a><span class="sd">        Assess quantum computing risk for data</span>
<a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>        <span class="c1"># &quot;Harvest now, decrypt later&quot; threat</span>
<a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a>        <span class="k">if</span> <span class="n">data_sensitivity</span> <span class="o">==</span> <span class="s1">&#39;high&#39;</span> <span class="ow">and</span> <span class="n">retention_period</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
<a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a>            <span class="k">return</span> <span class="s1">&#39;critical&#39;</span>  <span class="c1"># Immediate PQ migration needed</span>
<a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a>        <span class="k">elif</span> <span class="n">data_sensitivity</span> <span class="o">==</span> <span class="s1">&#39;high&#39;</span> <span class="ow">and</span> <span class="n">retention_period</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
<a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a>            <span class="k">return</span> <span class="s1">&#39;high&#39;</span>  <span class="c1"># PQ migration within 2 years</span>
<a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a>        <span class="k">elif</span> <span class="n">retention_period</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
<a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a>            <span class="k">return</span> <span class="s1">&#39;medium&#39;</span>  <span class="c1"># PQ migration within 5 years</span>
<a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a>            <span class="k">return</span> <span class="s1">&#39;low&#39;</span>  <span class="c1"># Standard migration timeline</span>
</code></pre></div></p>
<h2 id="certificate-authority-attacks">Certificate Authority Attacks</h2>
<h3 id="ca-compromise">CA Compromise</h3>
<p><strong>Complete CA compromise scenarios</strong>:</p>
<p>Attack vectors:
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CACompromiseVectors</span><span class="p">:</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="sd">    Ways an attacker can compromise a certificate authority</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>    <span class="n">ATTACK_VECTORS</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>        <span class="s1">&#39;private_key_theft&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>            <span class="s1">&#39;methods&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>                <span class="s1">&#39;Physical access to HSM&#39;</span><span class="p">,</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>                <span class="s1">&#39;Exploitation of key backup procedures&#39;</span><span class="p">,</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>                <span class="s1">&#39;Memory dumping from CA server&#39;</span><span class="p">,</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>                <span class="s1">&#39;Supply chain attack on HSM firmware&#39;</span><span class="p">,</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>                <span class="s1">&#39;Insider theft&#39;</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>            <span class="p">],</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Critical - attacker can issue fraudulent certificates&#39;</span><span class="p">,</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>            <span class="s1">&#39;detection_difficulty&#39;</span><span class="p">:</span> <span class="s1">&#39;Very High&#39;</span><span class="p">,</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>            <span class="s1">&#39;recovery&#39;</span><span class="p">:</span> <span class="s1">&#39;Revoke all issued certificates, re-key CA&#39;</span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>        <span class="p">},</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>        <span class="s1">&#39;credential_compromise&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>            <span class="s1">&#39;methods&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>                <span class="s1">&#39;Phishing CA operators&#39;</span><span class="p">,</span>
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>                <span class="s1">&#39;Exploiting weak passwords&#39;</span><span class="p">,</span>
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>                <span class="s1">&#39;Session hijacking&#39;</span><span class="p">,</span>
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>                <span class="s1">&#39;Malware on operator workstations&#39;</span>
<a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>            <span class="p">],</span>
<a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;High - unauthorized certificate issuance&#39;</span><span class="p">,</span>
<a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>            <span class="s1">&#39;detection_difficulty&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span>
<a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a>            <span class="s1">&#39;recovery&#39;</span><span class="p">:</span> <span class="s1">&#39;Revoke fraudulent certificates, audit all issuance&#39;</span>
<a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>        <span class="p">},</span>
<a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>
<a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a>        <span class="s1">&#39;system_exploitation&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a>            <span class="s1">&#39;methods&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a>                <span class="s1">&#39;Software vulnerabilities in CA application&#39;</span><span class="p">,</span>
<a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a>                <span class="s1">&#39;OS-level exploits&#39;</span><span class="p">,</span>
<a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>                <span class="s1">&#39;Network-based attacks&#39;</span><span class="p">,</span>
<a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a>                <span class="s1">&#39;API authentication bypass&#39;</span>
<a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a>            <span class="p">],</span>
<a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;High - various depending on exploit&#39;</span><span class="p">,</span>
<a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a>            <span class="s1">&#39;detection_difficulty&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span>
<a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a>            <span class="s1">&#39;recovery&#39;</span><span class="p">:</span> <span class="s1">&#39;Patch vulnerability, audit system integrity&#39;</span>
<a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a>        <span class="p">},</span>
<a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a>
<a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a>        <span class="s1">&#39;process_abuse&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a>            <span class="s1">&#39;methods&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a>                <span class="s1">&#39;Social engineering certificate approval&#39;</span><span class="p">,</span>
<a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a>                <span class="s1">&#39;Exploiting weak validation procedures&#39;</span><span class="p">,</span>
<a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a>                <span class="s1">&#39;Domain validation bypass&#39;</span><span class="p">,</span>
<a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a>                <span class="s1">&#39;Insider abuse of issuance privileges&#39;</span>
<a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a>            <span class="p">],</span>
<a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium to High - limited fraudulent issuance&#39;</span><span class="p">,</span>
<a id="__codelineno-7-52" name="__codelineno-7-52" href="#__codelineno-7-52"></a>            <span class="s1">&#39;detection_difficulty&#39;</span><span class="p">:</span> <span class="s1">&#39;Low to Medium&#39;</span><span class="p">,</span>
<a id="__codelineno-7-53" name="__codelineno-7-53" href="#__codelineno-7-53"></a>            <span class="s1">&#39;recovery&#39;</span><span class="p">:</span> <span class="s1">&#39;Revoke fraudulent certificates, improve processes&#39;</span>
<a id="__codelineno-7-54" name="__codelineno-7-54" href="#__codelineno-7-54"></a>        <span class="p">}</span>
<a id="__codelineno-7-55" name="__codelineno-7-55" href="#__codelineno-7-55"></a>    <span class="p">}</span>
</code></pre></div></p>
<p>Real-world examples:</p>
<p><strong>DigiNotar (2011)</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">DigiNotarIncident</span><span class="p">:</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="sd">    Case study: DigiNotar CA compromise</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="sd">    Timeline:</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="sd">    - June 2011: Initial compromise via SQL injection</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="sd">    - July 2011: Fraudulent certificates issued for *.google.com and others</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="sd">    - August 2011: Detection by Iranian users</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="sd">    - September 2011: DigiNotar revoked from trust stores</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="sd">    - September 2011: DigiNotar declared bankrupt</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="sd">    Impact:</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="sd">    - 531 fraudulent certificates issued</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="sd">    - Used for surveillance in Iran</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="sd">    - Complete loss of trust in DigiNotar</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="sd">    - Browser vendors removed DigiNotar root</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>    <span class="n">lessons_learned</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>        <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Certificate Transparency would have detected this faster&#39;</span><span class="p">,</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>        <span class="s1">&#39;isolation&#39;</span><span class="p">:</span> <span class="s1">&#39;Compromise of one system led to complete CA compromise&#39;</span><span class="p">,</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>        <span class="s1">&#39;monitoring&#39;</span><span class="p">:</span> <span class="s1">&#39;Inadequate monitoring failed to detect suspicious issuance&#39;</span><span class="p">,</span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>        <span class="s1">&#39;response&#39;</span><span class="p">:</span> <span class="s1">&#39;Slow incident response allowed extended compromise&#39;</span><span class="p">,</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>        <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Complete CA compromise requires root revocation&#39;</span>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>    <span class="p">}</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">preventive_controls</span><span class="p">():</span>
<a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a>            <span class="s1">&#39;defense_in_depth&#39;</span><span class="p">:</span> <span class="s1">&#39;Multiple security layers&#39;</span><span class="p">,</span>
<a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a>            <span class="s1">&#39;least_privilege&#39;</span><span class="p">:</span> <span class="s1">&#39;Minimal permissions for each role&#39;</span><span class="p">,</span>
<a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a>            <span class="s1">&#39;monitoring&#39;</span><span class="p">:</span> <span class="s1">&#39;Real-time anomaly detection&#39;</span><span class="p">,</span>
<a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a>            <span class="s1">&#39;ct_logging&#39;</span><span class="p">:</span> <span class="s1">&#39;Mandatory Certificate Transparency&#39;</span><span class="p">,</span>
<a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a>            <span class="s1">&#39;hsm_protection&#39;</span><span class="p">:</span> <span class="s1">&#39;Hardware-protected private keys&#39;</span><span class="p">,</span>
<a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>            <span class="s1">&#39;air_gap&#39;</span><span class="p">:</span> <span class="s1">&#39;Offline root CA&#39;</span>
<a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a>        <span class="p">}</span>
</code></pre></div></p>
<p><strong>Comodo (2011)</strong>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ComodoIncident</span><span class="p">:</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="sd">    Case study: Comodo RA compromise</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="sd">    March 2011: Registration Authority compromised</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="sd">    - Attacker obtained RA credentials</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="sd">    - Issued fraudulent certificates for:</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="sd">      * login.live.com (Microsoft)</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="sd">      * mail.google.com (Google)</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="sd">      * login.yahoo.com (Yahoo)</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="sd">      * addons.mozilla.org (Mozilla)</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="sd">    - Attack attributed to Iranian actor</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="sd">    Impact:</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="sd">    - Nine fraudulent certificates issued</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="sd">    - Quick detection and revocation</span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="sd">    - No widespread exploitation detected</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>    <span class="n">lessons_learned</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>        <span class="s1">&#39;ra_security&#39;</span><span class="p">:</span> <span class="s1">&#39;Registration Authorities need strong security&#39;</span><span class="p">,</span>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>        <span class="s1">&#39;monitoring&#39;</span><span class="p">:</span> <span class="s1">&#39;Anomalous issuance patterns should trigger alerts&#39;</span><span class="p">,</span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>        <span class="s1">&#39;rapid_response&#39;</span><span class="p">:</span> <span class="s1">&#39;Quick revocation limited impact&#39;</span><span class="p">,</span>
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>        <span class="s1">&#39;targeted_attack&#39;</span><span class="p">:</span> <span class="s1">&#39;High-profile domains were specifically targeted&#39;</span>
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a>    <span class="p">}</span>
</code></pre></div></p>
<h3 id="fraudulent-certificate-issuance">Fraudulent Certificate Issuance</h3>
<p><strong>Domain validation bypass</strong>:</p>
<p>Attack scenarios:
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">DomainValidationAttacks</span><span class="p">:</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="sd">    Attacks against domain validation in certificate issuance</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dns_hijacking_attack</span><span class="p">():</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="sd">        Attacker compromises DNS to pass validation</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;DNS Hijacking&#39;</span><span class="p">,</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>            <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;Compromise DNS provider or registrar&#39;</span><span class="p">,</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>            <span class="s1">&#39;validation_bypass&#39;</span><span class="p">:</span> <span class="s1">&#39;Control DNS records to pass DCV&#39;</span><span class="p">,</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>                <span class="s1">&#39;DNSSEC to protect DNS integrity&#39;</span><span class="p">,</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>                <span class="s1">&#39;Multi-perspective validation&#39;</span><span class="p">,</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>                <span class="s1">&#39;CAA records to restrict CAs&#39;</span><span class="p">,</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>                <span class="s1">&#39;Monitor DNS changes&#39;</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>            <span class="p">]</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>        <span class="p">}</span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">bgp_hijacking_attack</span><span class="p">():</span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="sd">        BGP hijacking to intercept validation traffic</span>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;BGP Hijacking&#39;</span><span class="p">,</span>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>            <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;Announce false BGP routes&#39;</span><span class="p">,</span>
<a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a>            <span class="s1">&#39;validation_bypass&#39;</span><span class="p">:</span> <span class="s1">&#39;Intercept HTTP-01 or TLS-ALPN-01 challenges&#39;</span><span class="p">,</span>
<a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a>            <span class="s1">&#39;real_world&#39;</span><span class="p">:</span> <span class="s1">&#39;AWS Route53 incident (2018)&#39;</span><span class="p">,</span>
<a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a>                <span class="s1">&#39;RPKI to validate BGP routes&#39;</span><span class="p">,</span>
<a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a>                <span class="s1">&#39;Multi-vantage-point validation&#39;</span><span class="p">,</span>
<a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a>                <span class="s1">&#39;DNS validation instead of HTTP&#39;</span><span class="p">,</span>
<a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a>                <span class="s1">&#39;Monitor BGP announcements&#39;</span>
<a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a>            <span class="p">]</span>
<a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a>        <span class="p">}</span>
<a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a>
<a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">email_validation_attack</span><span class="p">():</span>
<a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a><span class="sd">        Compromise email for domain validation</span>
<a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;Email Account Compromise&#39;</span><span class="p">,</span>
<a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a>            <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;Compromise admin@ or postmaster@ email&#39;</span><span class="p">,</span>
<a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a>            <span class="s1">&#39;validation_bypass&#39;</span><span class="p">:</span> <span class="s1">&#39;Receive validation email&#39;</span><span class="p">,</span>
<a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a>                <span class="s1">&#39;Avoid email validation for high-value domains&#39;</span><span class="p">,</span>
<a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a>                <span class="s1">&#39;Strong email security (2FA, etc.)&#39;</span><span class="p">,</span>
<a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a>                <span class="s1">&#39;CAA records to restrict CAs&#39;</span><span class="p">,</span>
<a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a>                <span class="s1">&#39;Monitor certificate issuance via CT logs&#39;</span>
<a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a>            <span class="p">]</span>
<a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a>        <span class="p">}</span>
</code></pre></div></p>
<p><strong>CAA record bypass</strong>:</p>
<p>DNS Certification Authority Authorization:
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_caa_compliance</span><span class="p">(</span><span class="n">domain</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ca_identity</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="sd">    Check if CA is authorized to issue for domain via CAA records</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    <span class="c1"># Query CAA records</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="n">caa_records</span> <span class="o">=</span> <span class="n">dns</span><span class="o">.</span><span class="n">query_caa_records</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">caa_records</span><span class="p">:</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>        <span class="c1"># No CAA records = any CA can issue (for now)</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>    <span class="c1"># Check if this CA is authorized</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">caa_records</span><span class="p">:</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>        <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;issue&#39;</span> <span class="ow">or</span> <span class="n">record</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;issuewild&#39;</span><span class="p">:</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>            <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">ca_identity</span> <span class="ow">or</span> <span class="n">record</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>    <span class="c1"># CA not authorized</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>    <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="c1"># Attack: CAA records can be bypassed if not properly enforced</span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="k">class</span><span class="w"> </span><span class="nc">CAABypassAttacks</span><span class="p">:</span>
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="sd">    Ways attackers bypass CAA protections</span>
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>    <span class="n">attacks</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>        <span class="s1">&#39;dns_hijacking&#39;</span><span class="p">:</span> <span class="s1">&#39;Modify DNS to remove CAA records&#39;</span><span class="p">,</span>
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>        <span class="s1">&#39;subdomain_takeover&#39;</span><span class="p">:</span> <span class="s1">&#39;Control subdomain without CAA record&#39;</span><span class="p">,</span>
<a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a>        <span class="s1">&#39;ca_non_compliance&#39;</span><span class="p">:</span> <span class="s1">&#39;CA fails to check CAA records&#39;</span><span class="p">,</span>
<a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a>        <span class="s1">&#39;timing_race&#39;</span><span class="p">:</span> <span class="s1">&#39;Issue during CAA record update window&#39;</span>
<a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a>    <span class="p">}</span>
</code></pre></div></p>
<h3 id="man-in-the-middle-mitm-attacks">Man-in-the-Middle (MITM) Attacks</h3>
<p><strong>TLS interception</strong>:</p>
<p>Corporate MITM:
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CorporateTLSInterception</span><span class="p">:</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="sd">    How corporate TLS inspection works (and its risks)</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">corporate_ca</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_corporate_ca</span><span class="p">()</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">intercept_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original_connection</span><span class="p">):</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="sd">        MITM technique used by enterprise proxies</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>        <span class="c1"># Step 1: Terminate client TLS connection</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>        <span class="n">client_tls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminate_tls</span><span class="p">(</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>            <span class="n">connection</span><span class="o">=</span><span class="n">original_connection</span><span class="p">,</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>            <span class="n">certificate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_spoofed_cert</span><span class="p">(</span><span class="n">original_connection</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>        <span class="p">)</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>        <span class="c1"># Step 2: Establish new connection to real server</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>        <span class="n">server_tls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connect_to_server</span><span class="p">(</span><span class="n">original_connection</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>        <span class="c1"># Step 3: Inspect and forward traffic</span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>            <span class="n">client_data</span> <span class="o">=</span> <span class="n">client_tls</span><span class="o">.</span><span class="n">receive</span><span class="p">()</span>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a>            <span class="n">inspected_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inspect_and_log</span><span class="p">(</span><span class="n">client_data</span><span class="p">)</span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a>            <span class="n">server_tls</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">inspected_data</span><span class="p">)</span>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a>            <span class="n">server_response</span> <span class="o">=</span> <span class="n">server_tls</span><span class="o">.</span><span class="n">receive</span><span class="p">()</span>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a>            <span class="n">inspected_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inspect_and_log</span><span class="p">(</span><span class="n">server_response</span><span class="p">)</span>
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a>            <span class="n">client_tls</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">inspected_response</span><span class="p">)</span>
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a>
<a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_spoofed_cert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Certificate</span><span class="p">:</span>
<a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a><span class="sd">        Generate certificate impersonating target</span>
<a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-12-36" name="__codelineno-12-36" href="#__codelineno-12-36"></a>        <span class="c1"># Create certificate for target hostname</span>
<a id="__codelineno-12-37" name="__codelineno-12-37" href="#__codelineno-12-37"></a>        <span class="c1"># Signed by corporate CA (trusted by corporate devices)</span>
<a id="__codelineno-12-38" name="__codelineno-12-38" href="#__codelineno-12-38"></a>        <span class="n">cert</span> <span class="o">=</span> <span class="n">Certificate</span><span class="p">(</span>
<a id="__codelineno-12-39" name="__codelineno-12-39" href="#__codelineno-12-39"></a>            <span class="n">common_name</span><span class="o">=</span><span class="n">hostname</span><span class="p">,</span>
<a id="__codelineno-12-40" name="__codelineno-12-40" href="#__codelineno-12-40"></a>            <span class="n">issuer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">corporate_ca</span><span class="p">,</span>
<a id="__codelineno-12-41" name="__codelineno-12-41" href="#__codelineno-12-41"></a>            <span class="n">validity</span><span class="o">=</span><span class="mi">365</span>
<a id="__codelineno-12-42" name="__codelineno-12-42" href="#__codelineno-12-42"></a>        <span class="p">)</span>
<a id="__codelineno-12-43" name="__codelineno-12-43" href="#__codelineno-12-43"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">corporate_ca</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-12-44" name="__codelineno-12-44" href="#__codelineno-12-44"></a>
<a id="__codelineno-12-45" name="__codelineno-12-45" href="#__codelineno-12-45"></a>    <span class="c1"># Security risks:</span>
<a id="__codelineno-12-46" name="__codelineno-12-46" href="#__codelineno-12-46"></a>    <span class="n">risks</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-12-47" name="__codelineno-12-47" href="#__codelineno-12-47"></a>        <span class="s1">&#39;trust_model_violation&#39;</span><span class="p">:</span> <span class="s1">&#39;Breaks end-to-end encryption&#39;</span><span class="p">,</span>
<a id="__codelineno-12-48" name="__codelineno-12-48" href="#__codelineno-12-48"></a>        <span class="s1">&#39;key_exposure&#39;</span><span class="p">:</span> <span class="s1">&#39;Corporate CA private key is high-value target&#39;</span><span class="p">,</span>
<a id="__codelineno-12-49" name="__codelineno-12-49" href="#__codelineno-12-49"></a>        <span class="s1">&#39;privacy_concerns&#39;</span><span class="p">:</span> <span class="s1">&#39;All TLS traffic visible to corporation&#39;</span><span class="p">,</span>
<a id="__codelineno-12-50" name="__codelineno-12-50" href="#__codelineno-12-50"></a>        <span class="s1">&#39;certificate_pinning_breaks&#39;</span><span class="p">:</span> <span class="s1">&#39;Apps with pinning will fail&#39;</span><span class="p">,</span>
<a id="__codelineno-12-51" name="__codelineno-12-51" href="#__codelineno-12-51"></a>        <span class="s1">&#39;vulnerability_introduction&#39;</span><span class="p">:</span> <span class="s1">&#39;Proxy bugs can create vulnerabilities&#39;</span>
<a id="__codelineno-12-52" name="__codelineno-12-52" href="#__codelineno-12-52"></a>    <span class="p">}</span>
</code></pre></div></p>
<p>Defenses against unwanted MITM:
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MITMDefenses</span><span class="p">:</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="sd">    Protections against TLS interception attacks</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">certificate_pinning</span><span class="p">():</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="sd">        Pin specific certificates or public keys</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>            <span class="s1">&#39;mechanism&#39;</span><span class="p">:</span> <span class="s1">&#39;Hardcode expected certificate fingerprints&#39;</span><span class="p">,</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>            <span class="s1">&#39;effectiveness&#39;</span><span class="p">:</span> <span class="s1">&#39;Prevents MITM even with trusted CA&#39;</span><span class="p">,</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>            <span class="s1">&#39;limitations&#39;</span><span class="p">:</span> <span class="s1">&#39;Requires app updates for certificate rotation&#39;</span><span class="p">,</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>            <span class="s1">&#39;use_case&#39;</span><span class="p">:</span> <span class="s1">&#39;Mobile apps, high-security applications&#39;</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>        <span class="p">}</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">public_key_pinning_http</span><span class="p">():</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="sd">        HTTP Public Key Pinning (deprecated but instructive)</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a>            <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Public-Key-Pins&#39;</span><span class="p">,</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a>            <span class="s1">&#39;mechanism&#39;</span><span class="p">:</span> <span class="s1">&#39;Browser enforces pinned public keys&#39;</span><span class="p">,</span>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a>            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Deprecated due to operational risks&#39;</span><span class="p">,</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>            <span class="s1">&#39;lessons&#39;</span><span class="p">:</span> <span class="s1">&#39;Pinning is powerful but operationally dangerous&#39;</span><span class="p">,</span>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a>            <span class="s1">&#39;successor&#39;</span><span class="p">:</span> <span class="s1">&#39;Certificate Transparency + Expect-CT&#39;</span>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a>        <span class="p">}</span>
<a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a>
<a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">certificate_transparency_monitoring</span><span class="p">():</span>
<a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a><span class="sd">        Monitor CT logs for unexpected certificates</span>
<a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a>            <span class="s1">&#39;mechanism&#39;</span><span class="p">:</span> <span class="s1">&#39;All public certificates logged to CT&#39;</span><span class="p">,</span>
<a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Monitor logs for unexpected issuance&#39;</span><span class="p">,</span>
<a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a>            <span class="s1">&#39;effectiveness&#39;</span><span class="p">:</span> <span class="s1">&#39;Detects fraudulent issuance after-the-fact&#39;</span><span class="p">,</span>
<a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a>            <span class="s1">&#39;tools&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;certstream&#39;</span><span class="p">,</span> <span class="s1">&#39;facebook CT monitor&#39;</span><span class="p">,</span> <span class="s1">&#39;SSLMate&#39;</span><span class="p">]</span>
<a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a>        <span class="p">}</span>
</code></pre></div></p>
<h2 id="private-key-compromise">Private Key Compromise</h2>
<h3 id="key-theft-scenarios">Key Theft Scenarios</h3>
<p><strong>Memory extraction</strong>:</p>
<p>Heartbleed (2014):
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">HeartbleedVulnerability</span><span class="p">:</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="sd">    CVE-2014-0160: OpenSSL memory disclosure</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="sd">    Impact: TLS private keys leaked from memory</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exploit_scenario</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="sd">        How Heartbleed exposed private keys</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>            <span class="s1">&#39;vulnerability&#39;</span><span class="p">:</span> <span class="s1">&#39;Buffer over-read in heartbeat extension&#39;</span><span class="p">,</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>            <span class="s1">&#39;exposed_data&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>                <span class="s1">&#39;Private keys&#39;</span><span class="p">,</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>                <span class="s1">&#39;Session keys&#39;</span><span class="p">,</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>                <span class="s1">&#39;User credentials&#39;</span><span class="p">,</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>                <span class="s1">&#39;Application data&#39;</span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>            <span class="p">],</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>            <span class="s1">&#39;affected_versions&#39;</span><span class="p">:</span> <span class="s1">&#39;OpenSSL 1.0.1 through 1.0.1f&#39;</span><span class="p">,</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Impossible to detect if keys were stolen&#39;</span><span class="p">,</span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>            <span class="s1">&#39;response&#39;</span><span class="p">:</span> <span class="s1">&#39;Assume compromise, rekey all certificates&#39;</span><span class="p">,</span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;17</span><span class="si">% o</span><span class="s1">f internet HTTPS servers affected&#39;</span>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>        <span class="p">}</span>
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a>
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a>    <span class="n">lessons_learned</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>        <span class="s1">&#39;assume_compromise&#39;</span><span class="p">:</span> <span class="s1">&#39;No way to prove keys were not stolen&#39;</span><span class="p">,</span>
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>        <span class="s1">&#39;massive_rekeying&#39;</span><span class="p">:</span> <span class="s1">&#39;Required enterprise-wide certificate rotation&#39;</span><span class="p">,</span>
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a>        <span class="s1">&#39;memory_safety&#39;</span><span class="p">:</span> <span class="s1">&#39;Memory-safe languages prevent this class of bugs&#39;</span><span class="p">,</span>
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a>        <span class="s1">&#39;defense_in_depth&#39;</span><span class="p">:</span> <span class="s1">&#39;HSMs protect keys even if server compromised&#39;</span>
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a>    <span class="p">}</span>
</code></pre></div></p>
<p><strong>Key file exposure</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">PrivateKeyExposure</span><span class="p">:</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="sd">    Common ways private keys are accidentally exposed</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>    <span class="n">exposure_vectors</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>        <span class="s1">&#39;source_control&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="s1">&#39;Private key committed to Git repository&#39;</span><span class="p">,</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;GitHub/GitLab secret scanning&#39;</span><span class="p">,</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>            <span class="s1">&#39;prevalence&#39;</span><span class="p">:</span> <span class="s1">&#39;Very common&#39;</span><span class="p">,</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Public exposure if public repo&#39;</span><span class="p">,</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>                <span class="s1">&#39;Pre-commit hooks to detect secrets&#39;</span><span class="p">,</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>                <span class="s1">&#39;Never commit private keys&#39;</span><span class="p">,</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>                <span class="s1">&#39;Use secret management systems&#39;</span><span class="p">,</span>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>                <span class="s1">&#39;Rotate keys immediately if exposed&#39;</span>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a>            <span class="p">]</span>
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a>        <span class="p">},</span>
<a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a>
<a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a>        <span class="s1">&#39;backups&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="s1">&#39;Keys in unencrypted backups&#39;</span><span class="p">,</span>
<a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Backup compromise&#39;</span><span class="p">,</span>
<a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a>            <span class="s1">&#39;prevalence&#39;</span><span class="p">:</span> <span class="s1">&#39;Common&#39;</span><span class="p">,</span>
<a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Keys accessible to backup system attackers&#39;</span><span class="p">,</span>
<a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a>                <span class="s1">&#39;Encrypt backups&#39;</span><span class="p">,</span>
<a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a>                <span class="s1">&#39;Exclude private keys from backups&#39;</span><span class="p">,</span>
<a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a>                <span class="s1">&#39;Store keys in HSM (not filesystem)&#39;</span><span class="p">,</span>
<a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a>                <span class="s1">&#39;Access control on backup systems&#39;</span>
<a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a>            <span class="p">]</span>
<a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a>        <span class="p">},</span>
<a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a>
<a id="__codelineno-15-33" name="__codelineno-15-33" href="#__codelineno-15-33"></a>        <span class="s1">&#39;configuration_management&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-15-34" name="__codelineno-15-34" href="#__codelineno-15-34"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="s1">&#39;Keys in Ansible/Chef/Puppet&#39;</span><span class="p">,</span>
<a id="__codelineno-15-35" name="__codelineno-15-35" href="#__codelineno-15-35"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Config management system compromise&#39;</span><span class="p">,</span>
<a id="__codelineno-15-36" name="__codelineno-15-36" href="#__codelineno-15-36"></a>            <span class="s1">&#39;prevalence&#39;</span><span class="p">:</span> <span class="s1">&#39;Common&#39;</span><span class="p">,</span>
<a id="__codelineno-15-37" name="__codelineno-15-37" href="#__codelineno-15-37"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Keys distributed to many systems&#39;</span><span class="p">,</span>
<a id="__codelineno-15-38" name="__codelineno-15-38" href="#__codelineno-15-38"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-15-39" name="__codelineno-15-39" href="#__codelineno-15-39"></a>                <span class="s1">&#39;Use secret management (Vault, etc.)&#39;</span><span class="p">,</span>
<a id="__codelineno-15-40" name="__codelineno-15-40" href="#__codelineno-15-40"></a>                <span class="s1">&#39;Encrypt secrets in config management&#39;</span><span class="p">,</span>
<a id="__codelineno-15-41" name="__codelineno-15-41" href="#__codelineno-15-41"></a>                <span class="s1">&#39;Just-in-time key generation&#39;</span><span class="p">,</span>
<a id="__codelineno-15-42" name="__codelineno-15-42" href="#__codelineno-15-42"></a>                <span class="s1">&#39;Limit key distribution scope&#39;</span>
<a id="__codelineno-15-43" name="__codelineno-15-43" href="#__codelineno-15-43"></a>            <span class="p">]</span>
<a id="__codelineno-15-44" name="__codelineno-15-44" href="#__codelineno-15-44"></a>        <span class="p">},</span>
<a id="__codelineno-15-45" name="__codelineno-15-45" href="#__codelineno-15-45"></a>
<a id="__codelineno-15-46" name="__codelineno-15-46" href="#__codelineno-15-46"></a>        <span class="s1">&#39;log_files&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-15-47" name="__codelineno-15-47" href="#__codelineno-15-47"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="s1">&#39;Keys accidentally logged&#39;</span><span class="p">,</span>
<a id="__codelineno-15-48" name="__codelineno-15-48" href="#__codelineno-15-48"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Log review&#39;</span><span class="p">,</span>
<a id="__codelineno-15-49" name="__codelineno-15-49" href="#__codelineno-15-49"></a>            <span class="s1">&#39;prevalence&#39;</span><span class="p">:</span> <span class="s1">&#39;Occasional&#39;</span><span class="p">,</span>
<a id="__codelineno-15-50" name="__codelineno-15-50" href="#__codelineno-15-50"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Keys in centralized logging&#39;</span><span class="p">,</span>
<a id="__codelineno-15-51" name="__codelineno-15-51" href="#__codelineno-15-51"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-15-52" name="__codelineno-15-52" href="#__codelineno-15-52"></a>                <span class="s1">&#39;Sanitize logs before storage&#39;</span><span class="p">,</span>
<a id="__codelineno-15-53" name="__codelineno-15-53" href="#__codelineno-15-53"></a>                <span class="s1">&#39;Never log private keys or credentials&#39;</span><span class="p">,</span>
<a id="__codelineno-15-54" name="__codelineno-15-54" href="#__codelineno-15-54"></a>                <span class="s1">&#39;Secure log storage&#39;</span><span class="p">,</span>
<a id="__codelineno-15-55" name="__codelineno-15-55" href="#__codelineno-15-55"></a>                <span class="s1">&#39;Log retention policies&#39;</span>
<a id="__codelineno-15-56" name="__codelineno-15-56" href="#__codelineno-15-56"></a>            <span class="p">]</span>
<a id="__codelineno-15-57" name="__codelineno-15-57" href="#__codelineno-15-57"></a>        <span class="p">},</span>
<a id="__codelineno-15-58" name="__codelineno-15-58" href="#__codelineno-15-58"></a>
<a id="__codelineno-15-59" name="__codelineno-15-59" href="#__codelineno-15-59"></a>        <span class="s1">&#39;debugging&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-15-60" name="__codelineno-15-60" href="#__codelineno-15-60"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="s1">&#39;Keys in debug output or core dumps&#39;</span><span class="p">,</span>
<a id="__codelineno-15-61" name="__codelineno-15-61" href="#__codelineno-15-61"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Core dump analysis&#39;</span><span class="p">,</span>
<a id="__codelineno-15-62" name="__codelineno-15-62" href="#__codelineno-15-62"></a>            <span class="s1">&#39;prevalence&#39;</span><span class="p">:</span> <span class="s1">&#39;Occasional&#39;</span><span class="p">,</span>
<a id="__codelineno-15-63" name="__codelineno-15-63" href="#__codelineno-15-63"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Keys exposed in crash analysis&#39;</span><span class="p">,</span>
<a id="__codelineno-15-64" name="__codelineno-15-64" href="#__codelineno-15-64"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-15-65" name="__codelineno-15-65" href="#__codelineno-15-65"></a>                <span class="s1">&#39;Disable core dumps in production&#39;</span><span class="p">,</span>
<a id="__codelineno-15-66" name="__codelineno-15-66" href="#__codelineno-15-66"></a>                <span class="s1">&#39;Scrub sensitive data from memory before freeing&#39;</span><span class="p">,</span>
<a id="__codelineno-15-67" name="__codelineno-15-67" href="#__codelineno-15-67"></a>                <span class="s1">&#39;Secure debug output&#39;</span><span class="p">,</span>
<a id="__codelineno-15-68" name="__codelineno-15-68" href="#__codelineno-15-68"></a>                <span class="s1">&#39;Memory encryption&#39;</span>
<a id="__codelineno-15-69" name="__codelineno-15-69" href="#__codelineno-15-69"></a>            <span class="p">]</span>
<a id="__codelineno-15-70" name="__codelineno-15-70" href="#__codelineno-15-70"></a>        <span class="p">}</span>
<a id="__codelineno-15-71" name="__codelineno-15-71" href="#__codelineno-15-71"></a>    <span class="p">}</span>
</code></pre></div>
<h3 id="key-compromise-detection">Key Compromise Detection</h3>
<p><strong>Indicators of compromise</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">KeyCompromiseDetection</span><span class="p">:</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="sd">    Detect potential private key compromise</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_for_compromise_indicators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="sd">        Signals that might indicate key compromise</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>        <span class="n">indicators</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>            <span class="s1">&#39;unauthorized_certificate_issuance&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>                <span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="s1">&#39;Certificate issued without proper authorization&#39;</span><span class="p">,</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>                <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Monitor CA issuance logs&#39;</span><span class="p">,</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>                <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;Critical&#39;</span><span class="p">,</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;Investigate immediately, potentially revoke&#39;</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>            <span class="p">},</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>            <span class="s1">&#39;ct_log_anomalies&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>                <span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="s1">&#39;Unexpected certificates in CT logs&#39;</span><span class="p">,</span>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>                <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Monitor CT logs for domains&#39;</span><span class="p">,</span>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>                <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span>
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;Verify legitimate issuance, revoke if fraudulent&#39;</span>
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>            <span class="p">},</span>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>            <span class="s1">&#39;suspicious_tls_usage&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>                <span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="s1">&#39;Certificate used from unexpected locations&#39;</span><span class="p">,</span>
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>                <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Monitor certificate fingerprints in network traffic&#39;</span><span class="p">,</span>
<a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>                <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span>
<a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;Investigate usage patterns&#39;</span>
<a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>            <span class="p">},</span>
<a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>
<a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>            <span class="s1">&#39;failed_private_key_access&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>                <span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="s1">&#39;Failed attempts to access private key storage&#39;</span><span class="p">,</span>
<a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a>                <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;HSM audit logs&#39;</span><span class="p">,</span>
<a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a>                <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span>
<a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a>                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;Review access attempts, investigate if anomalous&#39;</span>
<a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a>            <span class="p">},</span>
<a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a>
<a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a>            <span class="s1">&#39;key_file_access&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a>                <span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="s1">&#39;Unexpected access to private key files&#39;</span><span class="p">,</span>
<a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a>                <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;File integrity monitoring&#39;</span><span class="p">,</span>
<a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a>                <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span>
<a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a>                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;Audit access, investigate unauthorized access&#39;</span>
<a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a>            <span class="p">}</span>
<a id="__codelineno-16-45" name="__codelineno-16-45" href="#__codelineno-16-45"></a>        <span class="p">}</span>
<a id="__codelineno-16-46" name="__codelineno-16-46" href="#__codelineno-16-46"></a>
<a id="__codelineno-16-47" name="__codelineno-16-47" href="#__codelineno-16-47"></a>        <span class="k">return</span> <span class="n">indicators</span>
<a id="__codelineno-16-48" name="__codelineno-16-48" href="#__codelineno-16-48"></a>
<a id="__codelineno-16-49" name="__codelineno-16-49" href="#__codelineno-16-49"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">automated_compromise_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cert</span><span class="p">:</span> <span class="n">Certificate</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CompromiseAssessment</span><span class="p">:</span>
<a id="__codelineno-16-50" name="__codelineno-16-50" href="#__codelineno-16-50"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-16-51" name="__codelineno-16-51" href="#__codelineno-16-51"></a><span class="sd">        Automated assessment of potential compromise</span>
<a id="__codelineno-16-52" name="__codelineno-16-52" href="#__codelineno-16-52"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-16-53" name="__codelineno-16-53" href="#__codelineno-16-53"></a>        <span class="n">assessment</span> <span class="o">=</span> <span class="n">CompromiseAssessment</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-16-54" name="__codelineno-16-54" href="#__codelineno-16-54"></a>
<a id="__codelineno-16-55" name="__codelineno-16-55" href="#__codelineno-16-55"></a>        <span class="c1"># Check CT logs for unexpected issuance</span>
<a id="__codelineno-16-56" name="__codelineno-16-56" href="#__codelineno-16-56"></a>        <span class="n">ct_certs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_ct_logs</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">subject_domains</span><span class="p">)</span>
<a id="__codelineno-16-57" name="__codelineno-16-57" href="#__codelineno-16-57"></a>        <span class="n">unexpected</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ct_certs</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_certificates</span><span class="p">]</span>
<a id="__codelineno-16-58" name="__codelineno-16-58" href="#__codelineno-16-58"></a>        <span class="k">if</span> <span class="n">unexpected</span><span class="p">:</span>
<a id="__codelineno-16-59" name="__codelineno-16-59" href="#__codelineno-16-59"></a>            <span class="n">assessment</span><span class="o">.</span><span class="n">add_indicator</span><span class="p">(</span>
<a id="__codelineno-16-60" name="__codelineno-16-60" href="#__codelineno-16-60"></a>                <span class="s1">&#39;unexpected_ct_entries&#39;</span><span class="p">,</span>
<a id="__codelineno-16-61" name="__codelineno-16-61" href="#__codelineno-16-61"></a>                <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">,</span>
<a id="__codelineno-16-62" name="__codelineno-16-62" href="#__codelineno-16-62"></a>                <span class="n">details</span><span class="o">=</span><span class="n">unexpected</span>
<a id="__codelineno-16-63" name="__codelineno-16-63" href="#__codelineno-16-63"></a>            <span class="p">)</span>
<a id="__codelineno-16-64" name="__codelineno-16-64" href="#__codelineno-16-64"></a>
<a id="__codelineno-16-65" name="__codelineno-16-65" href="#__codelineno-16-65"></a>        <span class="c1"># Check for usage from unexpected IPs</span>
<a id="__codelineno-16-66" name="__codelineno-16-66" href="#__codelineno-16-66"></a>        <span class="n">usage_logs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_network_logs</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">fingerprint</span><span class="p">)</span>
<a id="__codelineno-16-67" name="__codelineno-16-67" href="#__codelineno-16-67"></a>        <span class="n">unexpected_ips</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-16-68" name="__codelineno-16-68" href="#__codelineno-16-68"></a>            <span class="n">log</span> <span class="k">for</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">usage_logs</span> 
<a id="__codelineno-16-69" name="__codelineno-16-69" href="#__codelineno-16-69"></a>            <span class="k">if</span> <span class="n">log</span><span class="o">.</span><span class="n">source_ip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_ips</span>
<a id="__codelineno-16-70" name="__codelineno-16-70" href="#__codelineno-16-70"></a>        <span class="p">]</span>
<a id="__codelineno-16-71" name="__codelineno-16-71" href="#__codelineno-16-71"></a>        <span class="k">if</span> <span class="n">unexpected_ips</span><span class="p">:</span>
<a id="__codelineno-16-72" name="__codelineno-16-72" href="#__codelineno-16-72"></a>            <span class="n">assessment</span><span class="o">.</span><span class="n">add_indicator</span><span class="p">(</span>
<a id="__codelineno-16-73" name="__codelineno-16-73" href="#__codelineno-16-73"></a>                <span class="s1">&#39;unexpected_usage_location&#39;</span><span class="p">,</span>
<a id="__codelineno-16-74" name="__codelineno-16-74" href="#__codelineno-16-74"></a>                <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
<a id="__codelineno-16-75" name="__codelineno-16-75" href="#__codelineno-16-75"></a>                <span class="n">details</span><span class="o">=</span><span class="n">unexpected_ips</span>
<a id="__codelineno-16-76" name="__codelineno-16-76" href="#__codelineno-16-76"></a>            <span class="p">)</span>
<a id="__codelineno-16-77" name="__codelineno-16-77" href="#__codelineno-16-77"></a>
<a id="__codelineno-16-78" name="__codelineno-16-78" href="#__codelineno-16-78"></a>        <span class="c1"># Check if certificate was recently revoked</span>
<a id="__codelineno-16-79" name="__codelineno-16-79" href="#__codelineno-16-79"></a>        <span class="k">if</span> <span class="n">cert</span><span class="o">.</span><span class="n">revocation_status</span> <span class="o">==</span> <span class="s1">&#39;revoked&#39;</span><span class="p">:</span>
<a id="__codelineno-16-80" name="__codelineno-16-80" href="#__codelineno-16-80"></a>            <span class="n">assessment</span><span class="o">.</span><span class="n">add_indicator</span><span class="p">(</span>
<a id="__codelineno-16-81" name="__codelineno-16-81" href="#__codelineno-16-81"></a>                <span class="s1">&#39;certificate_revoked&#39;</span><span class="p">,</span>
<a id="__codelineno-16-82" name="__codelineno-16-82" href="#__codelineno-16-82"></a>                <span class="n">severity</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">,</span>
<a id="__codelineno-16-83" name="__codelineno-16-83" href="#__codelineno-16-83"></a>                <span class="n">details</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;revocation_date&#39;</span><span class="p">:</span> <span class="n">cert</span><span class="o">.</span><span class="n">revocation_date</span><span class="p">}</span>
<a id="__codelineno-16-84" name="__codelineno-16-84" href="#__codelineno-16-84"></a>            <span class="p">)</span>
<a id="__codelineno-16-85" name="__codelineno-16-85" href="#__codelineno-16-85"></a>
<a id="__codelineno-16-86" name="__codelineno-16-86" href="#__codelineno-16-86"></a>        <span class="k">return</span> <span class="n">assessment</span>
</code></pre></div>
<h3 id="key-compromise-response">Key Compromise Response</h3>
<p><strong>Incident response workflow</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">KeyCompromiseResponse</span><span class="p">:</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="sd">    Incident response procedures for key compromise</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">execute_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compromise</span><span class="p">:</span> <span class="n">CompromiseIncident</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResponseResult</span><span class="p">:</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="sd">        Execute key compromise incident response</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">ResponseResult</span><span class="p">()</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>        <span class="c1"># Phase 1: Containment (immediate)</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>        <span class="n">result</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="s2">&quot;Containment&quot;</span><span class="p">)</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>        <span class="c1"># 1a: Revoke compromised certificate(s)</span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>        <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">compromise</span><span class="o">.</span><span class="n">affected_certificates</span><span class="p">:</span>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emergency_revoke_certificate</span><span class="p">(</span>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>                <span class="n">cert</span><span class="p">,</span>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>                <span class="n">reason</span><span class="o">=</span><span class="s1">&#39;keyCompromise&#39;</span><span class="p">,</span>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>                <span class="n">revocation_date</span><span class="o">=</span><span class="n">compromise</span><span class="o">.</span><span class="n">discovery_time</span>
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>            <span class="p">)</span>
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>        <span class="c1"># 1b: Block key usage</span>
<a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a>        <span class="k">if</span> <span class="n">compromise</span><span class="o">.</span><span class="n">private_key_location</span><span class="p">:</span>
<a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">disable_key</span><span class="p">(</span><span class="n">compromise</span><span class="o">.</span><span class="n">private_key_location</span><span class="p">)</span>
<a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a>
<a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a>        <span class="c1"># 1c: Alert monitoring systems</span>
<a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alert_all_monitoring_systems</span><span class="p">(</span><span class="n">compromise</span><span class="p">)</span>
<a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a>
<a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a>        <span class="c1"># Phase 2: Eradication</span>
<a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a>        <span class="n">result</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="s2">&quot;Eradication&quot;</span><span class="p">)</span>
<a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a>
<a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a>        <span class="c1"># 2a: Remove compromised key material</span>
<a id="__codelineno-17-34" name="__codelineno-17-34" href="#__codelineno-17-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secure_delete_key_material</span><span class="p">(</span><span class="n">compromise</span><span class="o">.</span><span class="n">private_key_location</span><span class="p">)</span>
<a id="__codelineno-17-35" name="__codelineno-17-35" href="#__codelineno-17-35"></a>
<a id="__codelineno-17-36" name="__codelineno-17-36" href="#__codelineno-17-36"></a>        <span class="c1"># 2b: Patch vulnerability if applicable</span>
<a id="__codelineno-17-37" name="__codelineno-17-37" href="#__codelineno-17-37"></a>        <span class="k">if</span> <span class="n">compromise</span><span class="o">.</span><span class="n">vulnerability</span><span class="p">:</span>
<a id="__codelineno-17-38" name="__codelineno-17-38" href="#__codelineno-17-38"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emergency_patch</span><span class="p">(</span><span class="n">compromise</span><span class="o">.</span><span class="n">vulnerability</span><span class="p">)</span>
<a id="__codelineno-17-39" name="__codelineno-17-39" href="#__codelineno-17-39"></a>
<a id="__codelineno-17-40" name="__codelineno-17-40" href="#__codelineno-17-40"></a>        <span class="c1"># 2c: Remove attacker access</span>
<a id="__codelineno-17-41" name="__codelineno-17-41" href="#__codelineno-17-41"></a>        <span class="k">if</span> <span class="n">compromise</span><span class="o">.</span><span class="n">attacker_access</span><span class="p">:</span>
<a id="__codelineno-17-42" name="__codelineno-17-42" href="#__codelineno-17-42"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">remove_attacker_access</span><span class="p">(</span><span class="n">compromise</span><span class="o">.</span><span class="n">attacker_access</span><span class="p">)</span>
<a id="__codelineno-17-43" name="__codelineno-17-43" href="#__codelineno-17-43"></a>
<a id="__codelineno-17-44" name="__codelineno-17-44" href="#__codelineno-17-44"></a>        <span class="c1"># Phase 3: Recovery</span>
<a id="__codelineno-17-45" name="__codelineno-17-45" href="#__codelineno-17-45"></a>        <span class="n">result</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="s2">&quot;Recovery&quot;</span><span class="p">)</span>
<a id="__codelineno-17-46" name="__codelineno-17-46" href="#__codelineno-17-46"></a>
<a id="__codelineno-17-47" name="__codelineno-17-47" href="#__codelineno-17-47"></a>        <span class="c1"># 3a: Generate new key material</span>
<a id="__codelineno-17-48" name="__codelineno-17-48" href="#__codelineno-17-48"></a>        <span class="n">new_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_new_key_pairs</span><span class="p">(</span>
<a id="__codelineno-17-49" name="__codelineno-17-49" href="#__codelineno-17-49"></a>            <span class="n">count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">compromise</span><span class="o">.</span><span class="n">affected_certificates</span><span class="p">)</span>
<a id="__codelineno-17-50" name="__codelineno-17-50" href="#__codelineno-17-50"></a>        <span class="p">)</span>
<a id="__codelineno-17-51" name="__codelineno-17-51" href="#__codelineno-17-51"></a>
<a id="__codelineno-17-52" name="__codelineno-17-52" href="#__codelineno-17-52"></a>        <span class="c1"># 3b: Issue replacement certificates</span>
<a id="__codelineno-17-53" name="__codelineno-17-53" href="#__codelineno-17-53"></a>        <span class="n">replacement_certs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-17-54" name="__codelineno-17-54" href="#__codelineno-17-54"></a>        <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">compromise</span><span class="o">.</span><span class="n">affected_certificates</span><span class="p">:</span>
<a id="__codelineno-17-55" name="__codelineno-17-55" href="#__codelineno-17-55"></a>            <span class="n">replacement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">issue_replacement_certificate</span><span class="p">(</span>
<a id="__codelineno-17-56" name="__codelineno-17-56" href="#__codelineno-17-56"></a>                <span class="n">original</span><span class="o">=</span><span class="n">cert</span><span class="p">,</span>
<a id="__codelineno-17-57" name="__codelineno-17-57" href="#__codelineno-17-57"></a>                <span class="n">new_key</span><span class="o">=</span><span class="n">new_keys</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<a id="__codelineno-17-58" name="__codelineno-17-58" href="#__codelineno-17-58"></a>            <span class="p">)</span>
<a id="__codelineno-17-59" name="__codelineno-17-59" href="#__codelineno-17-59"></a>            <span class="n">replacement_certs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">replacement</span><span class="p">)</span>
<a id="__codelineno-17-60" name="__codelineno-17-60" href="#__codelineno-17-60"></a>
<a id="__codelineno-17-61" name="__codelineno-17-61" href="#__codelineno-17-61"></a>        <span class="c1"># 3c: Deploy replacement certificates</span>
<a id="__codelineno-17-62" name="__codelineno-17-62" href="#__codelineno-17-62"></a>        <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">replacement_certs</span><span class="p">:</span>
<a id="__codelineno-17-63" name="__codelineno-17-63" href="#__codelineno-17-63"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">emergency_deploy_certificate</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-17-64" name="__codelineno-17-64" href="#__codelineno-17-64"></a>
<a id="__codelineno-17-65" name="__codelineno-17-65" href="#__codelineno-17-65"></a>        <span class="c1"># 3d: Verify deployments</span>
<a id="__codelineno-17-66" name="__codelineno-17-66" href="#__codelineno-17-66"></a>        <span class="k">for</span> <span class="n">cert</span> <span class="ow">in</span> <span class="n">replacement_certs</span><span class="p">:</span>
<a id="__codelineno-17-67" name="__codelineno-17-67" href="#__codelineno-17-67"></a>            <span class="n">verification</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verify_certificate_deployment</span><span class="p">(</span><span class="n">cert</span><span class="p">)</span>
<a id="__codelineno-17-68" name="__codelineno-17-68" href="#__codelineno-17-68"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">verification</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
<a id="__codelineno-17-69" name="__codelineno-17-69" href="#__codelineno-17-69"></a>                <span class="n">result</span><span class="o">.</span><span class="n">add_error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deployment verification failed: </span><span class="si">{</span><span class="n">cert</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-17-70" name="__codelineno-17-70" href="#__codelineno-17-70"></a>
<a id="__codelineno-17-71" name="__codelineno-17-71" href="#__codelineno-17-71"></a>        <span class="c1"># Phase 4: Post-Incident</span>
<a id="__codelineno-17-72" name="__codelineno-17-72" href="#__codelineno-17-72"></a>        <span class="n">result</span><span class="o">.</span><span class="n">add_phase</span><span class="p">(</span><span class="s2">&quot;Post-Incident&quot;</span><span class="p">)</span>
<a id="__codelineno-17-73" name="__codelineno-17-73" href="#__codelineno-17-73"></a>
<a id="__codelineno-17-74" name="__codelineno-17-74" href="#__codelineno-17-74"></a>        <span class="c1"># 4a: Forensic analysis</span>
<a id="__codelineno-17-75" name="__codelineno-17-75" href="#__codelineno-17-75"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conduct_forensic_analysis</span><span class="p">(</span><span class="n">compromise</span><span class="p">)</span>
<a id="__codelineno-17-76" name="__codelineno-17-76" href="#__codelineno-17-76"></a>
<a id="__codelineno-17-77" name="__codelineno-17-77" href="#__codelineno-17-77"></a>        <span class="c1"># 4b: Identify root cause</span>
<a id="__codelineno-17-78" name="__codelineno-17-78" href="#__codelineno-17-78"></a>        <span class="n">root_cause</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">identify_root_cause</span><span class="p">(</span><span class="n">compromise</span><span class="p">)</span>
<a id="__codelineno-17-79" name="__codelineno-17-79" href="#__codelineno-17-79"></a>
<a id="__codelineno-17-80" name="__codelineno-17-80" href="#__codelineno-17-80"></a>        <span class="c1"># 4c: Implement preventive controls</span>
<a id="__codelineno-17-81" name="__codelineno-17-81" href="#__codelineno-17-81"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">implement_preventive_controls</span><span class="p">(</span><span class="n">root_cause</span><span class="p">)</span>
<a id="__codelineno-17-82" name="__codelineno-17-82" href="#__codelineno-17-82"></a>
<a id="__codelineno-17-83" name="__codelineno-17-83" href="#__codelineno-17-83"></a>        <span class="c1"># 4d: Post-mortem</span>
<a id="__codelineno-17-84" name="__codelineno-17-84" href="#__codelineno-17-84"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">schedule_post_mortem</span><span class="p">(</span><span class="n">compromise</span><span class="p">)</span>
<a id="__codelineno-17-85" name="__codelineno-17-85" href="#__codelineno-17-85"></a>
<a id="__codelineno-17-86" name="__codelineno-17-86" href="#__codelineno-17-86"></a>        <span class="c1"># 4e: Update documentation</span>
<a id="__codelineno-17-87" name="__codelineno-17-87" href="#__codelineno-17-87"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_runbooks_and_docs</span><span class="p">(</span><span class="n">compromise</span><span class="p">)</span>
<a id="__codelineno-17-88" name="__codelineno-17-88" href="#__codelineno-17-88"></a>
<a id="__codelineno-17-89" name="__codelineno-17-89" href="#__codelineno-17-89"></a>        <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
<h2 id="protocol-attacks">Protocol Attacks</h2>
<h3 id="tlsssl-vulnerabilities">TLS/SSL Vulnerabilities</h3>
<p><strong>Historical protocol attacks</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">TLSProtocolAttacks</span><span class="p">:</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="sd">    Major TLS/SSL protocol attacks and their impact</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="n">ATTACKS</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>        <span class="s1">&#39;BEAST&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2011</span><span class="p">,</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>            <span class="s1">&#39;cve&#39;</span><span class="p">:</span> <span class="s1">&#39;CVE-2011-3389&#39;</span><span class="p">,</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;TLS 1.0 CBC mode&#39;</span><span class="p">,</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Session cookie theft&#39;</span><span class="p">,</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="s1">&#39;Disable TLS 1.0, use TLS 1.2+&#39;</span><span class="p">,</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Mitigated&#39;</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>        <span class="p">},</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>        <span class="s1">&#39;CRIME&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2012</span><span class="p">,</span>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>            <span class="s1">&#39;cve&#39;</span><span class="p">:</span> <span class="s1">&#39;CVE-2012-4929&#39;</span><span class="p">,</span>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;TLS compression&#39;</span><span class="p">,</span>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Session hijacking via compression side-channel&#39;</span><span class="p">,</span>
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="s1">&#39;Disable TLS compression&#39;</span><span class="p">,</span>
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a>            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Mitigated&#39;</span>
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a>        <span class="p">},</span>
<a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a>
<a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a>        <span class="s1">&#39;BREACH&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a>            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2013</span><span class="p">,</span>
<a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a>            <span class="s1">&#39;cve&#39;</span><span class="p">:</span> <span class="s1">&#39;CVE-2013-3587&#39;</span><span class="p">,</span>
<a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a>            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;HTTP compression&#39;</span><span class="p">,</span>
<a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Extract secrets from compressed responses&#39;</span><span class="p">,</span>
<a id="__codelineno-18-30" name="__codelineno-18-30" href="#__codelineno-18-30"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="s1">&#39;Disable HTTP compression for sensitive data&#39;</span><span class="p">,</span>
<a id="__codelineno-18-31" name="__codelineno-18-31" href="#__codelineno-18-31"></a>            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Partial mitigation&#39;</span>
<a id="__codelineno-18-32" name="__codelineno-18-32" href="#__codelineno-18-32"></a>        <span class="p">},</span>
<a id="__codelineno-18-33" name="__codelineno-18-33" href="#__codelineno-18-33"></a>
<a id="__codelineno-18-34" name="__codelineno-18-34" href="#__codelineno-18-34"></a>        <span class="s1">&#39;Heartbleed&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-18-35" name="__codelineno-18-35" href="#__codelineno-18-35"></a>            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2014</span><span class="p">,</span>
<a id="__codelineno-18-36" name="__codelineno-18-36" href="#__codelineno-18-36"></a>            <span class="s1">&#39;cve&#39;</span><span class="p">:</span> <span class="s1">&#39;CVE-2014-0160&#39;</span><span class="p">,</span>
<a id="__codelineno-18-37" name="__codelineno-18-37" href="#__codelineno-18-37"></a>            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;OpenSSL heartbeat extension&#39;</span><span class="p">,</span>
<a id="__codelineno-18-38" name="__codelineno-18-38" href="#__codelineno-18-38"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Memory disclosure including private keys&#39;</span><span class="p">,</span>
<a id="__codelineno-18-39" name="__codelineno-18-39" href="#__codelineno-18-39"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="s1">&#39;Update OpenSSL, rekey all certificates&#39;</span><span class="p">,</span>
<a id="__codelineno-18-40" name="__codelineno-18-40" href="#__codelineno-18-40"></a>            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Mitigated (patched)&#39;</span>
<a id="__codelineno-18-41" name="__codelineno-18-41" href="#__codelineno-18-41"></a>        <span class="p">},</span>
<a id="__codelineno-18-42" name="__codelineno-18-42" href="#__codelineno-18-42"></a>
<a id="__codelineno-18-43" name="__codelineno-18-43" href="#__codelineno-18-43"></a>        <span class="s1">&#39;POODLE&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-18-44" name="__codelineno-18-44" href="#__codelineno-18-44"></a>            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2014</span><span class="p">,</span>
<a id="__codelineno-18-45" name="__codelineno-18-45" href="#__codelineno-18-45"></a>            <span class="s1">&#39;cve&#39;</span><span class="p">:</span> <span class="s1">&#39;CVE-2014-3566&#39;</span><span class="p">,</span>
<a id="__codelineno-18-46" name="__codelineno-18-46" href="#__codelineno-18-46"></a>            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;SSL 3.0 CBC mode&#39;</span><span class="p">,</span>
<a id="__codelineno-18-47" name="__codelineno-18-47" href="#__codelineno-18-47"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Padding oracle attack&#39;</span><span class="p">,</span>
<a id="__codelineno-18-48" name="__codelineno-18-48" href="#__codelineno-18-48"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="s1">&#39;Disable SSL 3.0&#39;</span><span class="p">,</span>
<a id="__codelineno-18-49" name="__codelineno-18-49" href="#__codelineno-18-49"></a>            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Mitigated&#39;</span>
<a id="__codelineno-18-50" name="__codelineno-18-50" href="#__codelineno-18-50"></a>        <span class="p">},</span>
<a id="__codelineno-18-51" name="__codelineno-18-51" href="#__codelineno-18-51"></a>
<a id="__codelineno-18-52" name="__codelineno-18-52" href="#__codelineno-18-52"></a>        <span class="s1">&#39;FREAK&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-18-53" name="__codelineno-18-53" href="#__codelineno-18-53"></a>            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2015</span><span class="p">,</span>
<a id="__codelineno-18-54" name="__codelineno-18-54" href="#__codelineno-18-54"></a>            <span class="s1">&#39;cve&#39;</span><span class="p">:</span> <span class="s1">&#39;CVE-2015-0204&#39;</span><span class="p">,</span>
<a id="__codelineno-18-55" name="__codelineno-18-55" href="#__codelineno-18-55"></a>            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;RSA_EXPORT cipher suites&#39;</span><span class="p">,</span>
<a id="__codelineno-18-56" name="__codelineno-18-56" href="#__codelineno-18-56"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Downgrade to 512-bit RSA&#39;</span><span class="p">,</span>
<a id="__codelineno-18-57" name="__codelineno-18-57" href="#__codelineno-18-57"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="s1">&#39;Disable export cipher suites&#39;</span><span class="p">,</span>
<a id="__codelineno-18-58" name="__codelineno-18-58" href="#__codelineno-18-58"></a>            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Mitigated&#39;</span>
<a id="__codelineno-18-59" name="__codelineno-18-59" href="#__codelineno-18-59"></a>        <span class="p">},</span>
<a id="__codelineno-18-60" name="__codelineno-18-60" href="#__codelineno-18-60"></a>
<a id="__codelineno-18-61" name="__codelineno-18-61" href="#__codelineno-18-61"></a>        <span class="s1">&#39;Logjam&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-18-62" name="__codelineno-18-62" href="#__codelineno-18-62"></a>            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2015</span><span class="p">,</span>
<a id="__codelineno-18-63" name="__codelineno-18-63" href="#__codelineno-18-63"></a>            <span class="s1">&#39;cve&#39;</span><span class="p">:</span> <span class="s1">&#39;CVE-2015-4000&#39;</span><span class="p">,</span>
<a id="__codelineno-18-64" name="__codelineno-18-64" href="#__codelineno-18-64"></a>            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;Diffie-Hellman export cipher suites&#39;</span><span class="p">,</span>
<a id="__codelineno-18-65" name="__codelineno-18-65" href="#__codelineno-18-65"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Downgrade to weak DH parameters&#39;</span><span class="p">,</span>
<a id="__codelineno-18-66" name="__codelineno-18-66" href="#__codelineno-18-66"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="s1">&#39;Disable export DH, use 2048+ bit DH&#39;</span><span class="p">,</span>
<a id="__codelineno-18-67" name="__codelineno-18-67" href="#__codelineno-18-67"></a>            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Mitigated&#39;</span>
<a id="__codelineno-18-68" name="__codelineno-18-68" href="#__codelineno-18-68"></a>        <span class="p">},</span>
<a id="__codelineno-18-69" name="__codelineno-18-69" href="#__codelineno-18-69"></a>
<a id="__codelineno-18-70" name="__codelineno-18-70" href="#__codelineno-18-70"></a>        <span class="s1">&#39;DROWN&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-18-71" name="__codelineno-18-71" href="#__codelineno-18-71"></a>            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2016</span><span class="p">,</span>
<a id="__codelineno-18-72" name="__codelineno-18-72" href="#__codelineno-18-72"></a>            <span class="s1">&#39;cve&#39;</span><span class="p">:</span> <span class="s1">&#39;CVE-2016-0800&#39;</span><span class="p">,</span>
<a id="__codelineno-18-73" name="__codelineno-18-73" href="#__codelineno-18-73"></a>            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;SSLv2&#39;</span><span class="p">,</span>
<a id="__codelineno-18-74" name="__codelineno-18-74" href="#__codelineno-18-74"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Decrypt TLS sessions via SSLv2&#39;</span><span class="p">,</span>
<a id="__codelineno-18-75" name="__codelineno-18-75" href="#__codelineno-18-75"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="s1">&#39;Disable SSLv2&#39;</span><span class="p">,</span>
<a id="__codelineno-18-76" name="__codelineno-18-76" href="#__codelineno-18-76"></a>            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Mitigated&#39;</span>
<a id="__codelineno-18-77" name="__codelineno-18-77" href="#__codelineno-18-77"></a>        <span class="p">},</span>
<a id="__codelineno-18-78" name="__codelineno-18-78" href="#__codelineno-18-78"></a>
<a id="__codelineno-18-79" name="__codelineno-18-79" href="#__codelineno-18-79"></a>        <span class="s1">&#39;ROBOT&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-18-80" name="__codelineno-18-80" href="#__codelineno-18-80"></a>            <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2017</span><span class="p">,</span>
<a id="__codelineno-18-81" name="__codelineno-18-81" href="#__codelineno-18-81"></a>            <span class="s1">&#39;cve&#39;</span><span class="p">:</span> <span class="s1">&#39;CVE-2017-13099&#39;</span><span class="p">,</span>
<a id="__codelineno-18-82" name="__codelineno-18-82" href="#__codelineno-18-82"></a>            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;RSA PKCS#1 v1.5&#39;</span><span class="p">,</span>
<a id="__codelineno-18-83" name="__codelineno-18-83" href="#__codelineno-18-83"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Bleichenbacher padding oracle&#39;</span><span class="p">,</span>
<a id="__codelineno-18-84" name="__codelineno-18-84" href="#__codelineno-18-84"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="s1">&#39;Prefer ECDHE cipher suites&#39;</span><span class="p">,</span>
<a id="__codelineno-18-85" name="__codelineno-18-85" href="#__codelineno-18-85"></a>            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;Partial mitigation&#39;</span>
<a id="__codelineno-18-86" name="__codelineno-18-86" href="#__codelineno-18-86"></a>        <span class="p">}</span>
<a id="__codelineno-18-87" name="__codelineno-18-87" href="#__codelineno-18-87"></a>    <span class="p">}</span>
</code></pre></div>
<p><strong>Current best practices</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">SecureTLSConfiguration</span><span class="p">:</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="sd">    Modern TLS configuration for security</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_recommended_config</span><span class="p">():</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="sd">        Recommended TLS configuration (2025)</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>            <span class="s1">&#39;protocols&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>                <span class="s1">&#39;enabled&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;TLSv1.3&#39;</span><span class="p">,</span> <span class="s1">&#39;TLSv1.2&#39;</span><span class="p">],</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>                <span class="s1">&#39;disabled&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SSLv2&#39;</span><span class="p">,</span> <span class="s1">&#39;SSLv3&#39;</span><span class="p">,</span> <span class="s1">&#39;TLSv1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;TLSv1.1&#39;</span><span class="p">],</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>                <span class="s1">&#39;preferred&#39;</span><span class="p">:</span> <span class="s1">&#39;TLSv1.3&#39;</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>            <span class="p">},</span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>            <span class="s1">&#39;cipher_suites_tls13&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>                <span class="s1">&#39;TLS_AES_256_GCM_SHA384&#39;</span><span class="p">,</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>                <span class="s1">&#39;TLS_AES_128_GCM_SHA256&#39;</span><span class="p">,</span>
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>                <span class="s1">&#39;TLS_CHACHA20_POLY1305_SHA256&#39;</span>
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a>            <span class="p">],</span>
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a>
<a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a>            <span class="s1">&#39;cipher_suites_tls12&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a>                <span class="s1">&#39;ECDHE-RSA-AES256-GCM-SHA384&#39;</span><span class="p">,</span>
<a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a>                <span class="s1">&#39;ECDHE-RSA-AES128-GCM-SHA256&#39;</span><span class="p">,</span>
<a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a>                <span class="s1">&#39;ECDHE-RSA-CHACHA20-POLY1305&#39;</span><span class="p">,</span>
<a id="__codelineno-19-28" name="__codelineno-19-28" href="#__codelineno-19-28"></a>                <span class="s1">&#39;ECDHE-ECDSA-AES256-GCM-SHA384&#39;</span><span class="p">,</span>
<a id="__codelineno-19-29" name="__codelineno-19-29" href="#__codelineno-19-29"></a>                <span class="s1">&#39;ECDHE-ECDSA-AES128-GCM-SHA256&#39;</span><span class="p">,</span>
<a id="__codelineno-19-30" name="__codelineno-19-30" href="#__codelineno-19-30"></a>                <span class="s1">&#39;ECDHE-ECDSA-CHACHA20-POLY1305&#39;</span>
<a id="__codelineno-19-31" name="__codelineno-19-31" href="#__codelineno-19-31"></a>            <span class="p">],</span>
<a id="__codelineno-19-32" name="__codelineno-19-32" href="#__codelineno-19-32"></a>
<a id="__codelineno-19-33" name="__codelineno-19-33" href="#__codelineno-19-33"></a>            <span class="s1">&#39;key_exchange&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-19-34" name="__codelineno-19-34" href="#__codelineno-19-34"></a>                <span class="s1">&#39;dh_param_size&#39;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">,</span>  <span class="c1"># Minimum</span>
<a id="__codelineno-19-35" name="__codelineno-19-35" href="#__codelineno-19-35"></a>                <span class="s1">&#39;ecdh_curves&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X25519&#39;</span><span class="p">,</span> <span class="s1">&#39;secp384r1&#39;</span><span class="p">,</span> <span class="s1">&#39;secp256r1&#39;</span><span class="p">]</span>
<a id="__codelineno-19-36" name="__codelineno-19-36" href="#__codelineno-19-36"></a>            <span class="p">},</span>
<a id="__codelineno-19-37" name="__codelineno-19-37" href="#__codelineno-19-37"></a>
<a id="__codelineno-19-38" name="__codelineno-19-38" href="#__codelineno-19-38"></a>            <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-19-39" name="__codelineno-19-39" href="#__codelineno-19-39"></a>                <span class="s1">&#39;compression&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># CRIME/BREACH mitigation</span>
<a id="__codelineno-19-40" name="__codelineno-19-40" href="#__codelineno-19-40"></a>                <span class="s1">&#39;renegotiation&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># DoS mitigation</span>
<a id="__codelineno-19-41" name="__codelineno-19-41" href="#__codelineno-19-41"></a>                <span class="s1">&#39;session_tickets&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Performance (with rotation)</span>
<a id="__codelineno-19-42" name="__codelineno-19-42" href="#__codelineno-19-42"></a>                <span class="s1">&#39;ocsp_stapling&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># Performance and privacy</span>
<a id="__codelineno-19-43" name="__codelineno-19-43" href="#__codelineno-19-43"></a>                <span class="s1">&#39;sni&#39;</span><span class="p">:</span> <span class="kc">True</span>  <span class="c1"># Virtual hosting</span>
<a id="__codelineno-19-44" name="__codelineno-19-44" href="#__codelineno-19-44"></a>            <span class="p">},</span>
<a id="__codelineno-19-45" name="__codelineno-19-45" href="#__codelineno-19-45"></a>
<a id="__codelineno-19-46" name="__codelineno-19-46" href="#__codelineno-19-46"></a>            <span class="s1">&#39;headers&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-19-47" name="__codelineno-19-47" href="#__codelineno-19-47"></a>                <span class="s1">&#39;strict_transport_security&#39;</span><span class="p">:</span> <span class="s1">&#39;max-age=31536000; includeSubDomains; preload&#39;</span><span class="p">,</span>
<a id="__codelineno-19-48" name="__codelineno-19-48" href="#__codelineno-19-48"></a>                <span class="s1">&#39;expect_ct&#39;</span><span class="p">:</span> <span class="s1">&#39;enforce, max-age=86400&#39;</span>
<a id="__codelineno-19-49" name="__codelineno-19-49" href="#__codelineno-19-49"></a>            <span class="p">}</span>
<a id="__codelineno-19-50" name="__codelineno-19-50" href="#__codelineno-19-50"></a>        <span class="p">}</span>
</code></pre></div>
<h3 id="certificate-validation-attacks">Certificate Validation Attacks</h3>
<p><strong>Chain validation bypass</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ChainValidationAttacks</span><span class="p">:</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="sd">    Attacks on certificate chain validation</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">incomplete_chain_attack</span><span class="p">():</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="sd">        Server fails to send intermediate certificates</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;Missing Intermediate Certificate&#39;</span><span class="p">,</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>                <span class="s1">&#39;Server sends only leaf certificate&#39;</span><span class="p">,</span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>                <span class="s1">&#39;Client cannot build chain to trusted root&#39;</span><span class="p">,</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>                <span class="s1">&#39;Some clients cache intermediates and succeed&#39;</span><span class="p">,</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>                <span class="s1">&#39;Others fail with validation error&#39;</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>            <span class="p">],</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Inconsistent validation across clients&#39;</span><span class="p">,</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>            <span class="s1">&#39;exploitation&#39;</span><span class="p">:</span> <span class="s1">&#39;Cause DoS by making service unavailable to some&#39;</span><span class="p">,</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>                <span class="s1">&#39;Always send complete chain&#39;</span><span class="p">,</span>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>                <span class="s1">&#39;Automated chain validation in CI/CD&#39;</span><span class="p">,</span>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a>                <span class="s1">&#39;Monitor for chain validation errors&#39;</span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a>            <span class="p">]</span>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>        <span class="p">}</span>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">untrusted_root_attack</span><span class="p">():</span>
<a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a><span class="sd">        Certificate chain to untrusted root</span>
<a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;Untrusted Root Certificate&#39;</span><span class="p">,</span>
<a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a>                <span class="s1">&#39;Attacker creates their own CA&#39;</span><span class="p">,</span>
<a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a>                <span class="s1">&#39;Issues certificate signed by their CA&#39;</span><span class="p">,</span>
<a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a>                <span class="s1">&#39;Presents certificate to client&#39;</span><span class="p">,</span>
<a id="__codelineno-20-39" name="__codelineno-20-39" href="#__codelineno-20-39"></a>                <span class="s1">&#39;Client should reject (root not trusted)&#39;</span>
<a id="__codelineno-20-40" name="__codelineno-20-40" href="#__codelineno-20-40"></a>            <span class="p">],</span>
<a id="__codelineno-20-41" name="__codelineno-20-41" href="#__codelineno-20-41"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Should be blocked by proper validation&#39;</span><span class="p">,</span>
<a id="__codelineno-20-42" name="__codelineno-20-42" href="#__codelineno-20-42"></a>            <span class="s1">&#39;exploitation&#39;</span><span class="p">:</span> <span class="s1">&#39;Only works if client has misconfigured trust&#39;</span><span class="p">,</span>
<a id="__codelineno-20-43" name="__codelineno-20-43" href="#__codelineno-20-43"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-20-44" name="__codelineno-20-44" href="#__codelineno-20-44"></a>                <span class="s1">&#39;Maintain proper trust store&#39;</span><span class="p">,</span>
<a id="__codelineno-20-45" name="__codelineno-20-45" href="#__codelineno-20-45"></a>                <span class="s1">&#39;Validate chain to known roots&#39;</span><span class="p">,</span>
<a id="__codelineno-20-46" name="__codelineno-20-46" href="#__codelineno-20-46"></a>                <span class="s1">&#39;Remove untrusted roots&#39;</span><span class="p">,</span>
<a id="__codelineno-20-47" name="__codelineno-20-47" href="#__codelineno-20-47"></a>                <span class="s1">&#39;Monitor trust store changes&#39;</span>
<a id="__codelineno-20-48" name="__codelineno-20-48" href="#__codelineno-20-48"></a>            <span class="p">]</span>
<a id="__codelineno-20-49" name="__codelineno-20-49" href="#__codelineno-20-49"></a>        <span class="p">}</span>
<a id="__codelineno-20-50" name="__codelineno-20-50" href="#__codelineno-20-50"></a>
<a id="__codelineno-20-51" name="__codelineno-20-51" href="#__codelineno-20-51"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-20-52" name="__codelineno-20-52" href="#__codelineno-20-52"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">signature_verification_bypass</span><span class="p">():</span>
<a id="__codelineno-20-53" name="__codelineno-20-53" href="#__codelineno-20-53"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-20-54" name="__codelineno-20-54" href="#__codelineno-20-54"></a><span class="sd">        Skip or weaken signature verification</span>
<a id="__codelineno-20-55" name="__codelineno-20-55" href="#__codelineno-20-55"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-20-56" name="__codelineno-20-56" href="#__codelineno-20-56"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-20-57" name="__codelineno-20-57" href="#__codelineno-20-57"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;Signature Verification Bypass&#39;</span><span class="p">,</span>
<a id="__codelineno-20-58" name="__codelineno-20-58" href="#__codelineno-20-58"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-20-59" name="__codelineno-20-59" href="#__codelineno-20-59"></a>                <span class="s1">&#39;Vulnerable TLS library skips signature check&#39;</span><span class="p">,</span>
<a id="__codelineno-20-60" name="__codelineno-20-60" href="#__codelineno-20-60"></a>                <span class="s1">&#39;Or accepts weak signature algorithms&#39;</span><span class="p">,</span>
<a id="__codelineno-20-61" name="__codelineno-20-61" href="#__codelineno-20-61"></a>                <span class="s1">&#39;Attacker presents certificate with invalid signature&#39;</span><span class="p">,</span>
<a id="__codelineno-20-62" name="__codelineno-20-62" href="#__codelineno-20-62"></a>                <span class="s1">&#39;Client incorrectly accepts it&#39;</span>
<a id="__codelineno-20-63" name="__codelineno-20-63" href="#__codelineno-20-63"></a>            <span class="p">],</span>
<a id="__codelineno-20-64" name="__codelineno-20-64" href="#__codelineno-20-64"></a>            <span class="s1">&#39;real_world&#39;</span><span class="p">:</span> <span class="s1">&#39;Apple goto fail (2014)&#39;</span><span class="p">,</span>
<a id="__codelineno-20-65" name="__codelineno-20-65" href="#__codelineno-20-65"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-20-66" name="__codelineno-20-66" href="#__codelineno-20-66"></a>                <span class="s1">&#39;Use well-tested crypto libraries&#39;</span><span class="p">,</span>
<a id="__codelineno-20-67" name="__codelineno-20-67" href="#__codelineno-20-67"></a>                <span class="s1">&#39;Enable all validation checks&#39;</span><span class="p">,</span>
<a id="__codelineno-20-68" name="__codelineno-20-68" href="#__codelineno-20-68"></a>                <span class="s1">&#39;Regular security updates&#39;</span><span class="p">,</span>
<a id="__codelineno-20-69" name="__codelineno-20-69" href="#__codelineno-20-69"></a>                <span class="s1">&#39;Automated testing of validation&#39;</span>
<a id="__codelineno-20-70" name="__codelineno-20-70" href="#__codelineno-20-70"></a>            <span class="p">]</span>
<a id="__codelineno-20-71" name="__codelineno-20-71" href="#__codelineno-20-71"></a>        <span class="p">}</span>
</code></pre></div>
<p><strong>Hostname validation bypass</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">HostnameValidationAttacks</span><span class="p">:</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="sd">    Attacks exploiting weak hostname validation</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">null_byte_attack</span><span class="p">():</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="sd">        Null byte injection in certificate CN/SAN</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;Null Byte Injection&#39;</span><span class="p">,</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>                <span class="s1">&#39;Certificate CN: &quot;attacker.com</span><span class="se">\\</span><span class="s1">x00bank.com&quot;&#39;</span><span class="p">,</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>                <span class="s1">&#39;Vulnerable validator stops at null byte&#39;</span><span class="p">,</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>                <span class="s1">&#39;Sees only &quot;attacker.com&quot;&#39;</span><span class="p">,</span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>                <span class="s1">&#39;But certificate also valid for intended victim&#39;</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>            <span class="p">],</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>            <span class="s1">&#39;real_world&#39;</span><span class="p">:</span> <span class="s1">&#39;Found in multiple TLS libraries (2009-2015)&#39;</span><span class="p">,</span>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>                <span class="s1">&#39;Properly parse X.509 names&#39;</span><span class="p">,</span>
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a>                <span class="s1">&#39;Reject certificates with null bytes&#39;</span><span class="p">,</span>
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a>                <span class="s1">&#39;Use SAN instead of CN&#39;</span><span class="p">,</span>
<a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a>                <span class="s1">&#39;Modern libraries have fixed this&#39;</span>
<a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a>            <span class="p">]</span>
<a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a>        <span class="p">}</span>
<a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a>
<a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">wildcard_abuse</span><span class="p">():</span>
<a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a><span class="sd">        Overly broad wildcard matching</span>
<a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;Wildcard Abuse&#39;</span><span class="p">,</span>
<a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a>                <span class="s1">&#39;Certificate for *.example.com&#39;</span><span class="p">,</span>
<a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a>                <span class="s1">&#39;Should match sub.example.com&#39;</span><span class="p">,</span>
<a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a>                <span class="s1">&#39;Should NOT match sub.domain.example.com&#39;</span><span class="p">,</span>
<a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a>                <span class="s1">&#39;Vulnerable validators allow multi-level&#39;</span>
<a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a>            <span class="p">],</span>
<a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a>                <span class="s1">&#39;Wildcards only match single label&#39;</span><span class="p">,</span>
<a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a>                <span class="s1">&#39;Use multiple specific SANs instead&#39;</span><span class="p">,</span>
<a id="__codelineno-21-44" name="__codelineno-21-44" href="#__codelineno-21-44"></a>                <span class="s1">&#39;Avoid wildcards for sensitive domains&#39;</span>
<a id="__codelineno-21-45" name="__codelineno-21-45" href="#__codelineno-21-45"></a>            <span class="p">]</span>
<a id="__codelineno-21-46" name="__codelineno-21-46" href="#__codelineno-21-46"></a>        <span class="p">}</span>
<a id="__codelineno-21-47" name="__codelineno-21-47" href="#__codelineno-21-47"></a>
<a id="__codelineno-21-48" name="__codelineno-21-48" href="#__codelineno-21-48"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-21-49" name="__codelineno-21-49" href="#__codelineno-21-49"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">homograph_attack</span><span class="p">():</span>
<a id="__codelineno-21-50" name="__codelineno-21-50" href="#__codelineno-21-50"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-21-51" name="__codelineno-21-51" href="#__codelineno-21-51"></a><span class="sd">        Unicode homograph domains</span>
<a id="__codelineno-21-52" name="__codelineno-21-52" href="#__codelineno-21-52"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-21-53" name="__codelineno-21-53" href="#__codelineno-21-53"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-21-54" name="__codelineno-21-54" href="#__codelineno-21-54"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;IDN Homograph&#39;</span><span class="p">,</span>
<a id="__codelineno-21-55" name="__codelineno-21-55" href="#__codelineno-21-55"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-21-56" name="__codelineno-21-56" href="#__codelineno-21-56"></a>                <span class="s1">&#39;Register domain with lookalike characters&#39;</span><span class="p">,</span>
<a id="__codelineno-21-57" name="__codelineno-21-57" href="#__codelineno-21-57"></a>                <span class="s1">&#39;xample.com (Cyrillic ) vs example.com (Latin e)&#39;</span><span class="p">,</span>
<a id="__codelineno-21-58" name="__codelineno-21-58" href="#__codelineno-21-58"></a>                <span class="s1">&#39;Obtain legitimate certificate&#39;</span><span class="p">,</span>
<a id="__codelineno-21-59" name="__codelineno-21-59" href="#__codelineno-21-59"></a>                <span class="s1">&#39;Users cannot distinguish domains&#39;</span>
<a id="__codelineno-21-60" name="__codelineno-21-60" href="#__codelineno-21-60"></a>            <span class="p">],</span>
<a id="__codelineno-21-61" name="__codelineno-21-61" href="#__codelineno-21-61"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-21-62" name="__codelineno-21-62" href="#__codelineno-21-62"></a>                <span class="s1">&#39;Browser IDN display policies&#39;</span><span class="p">,</span>
<a id="__codelineno-21-63" name="__codelineno-21-63" href="#__codelineno-21-63"></a>                <span class="s1">&#39;Restrict mixed-script domains&#39;</span><span class="p">,</span>
<a id="__codelineno-21-64" name="__codelineno-21-64" href="#__codelineno-21-64"></a>                <span class="s1">&#39;Certificate Transparency monitoring&#39;</span><span class="p">,</span>
<a id="__codelineno-21-65" name="__codelineno-21-65" href="#__codelineno-21-65"></a>                <span class="s1">&#39;User education&#39;</span>
<a id="__codelineno-21-66" name="__codelineno-21-66" href="#__codelineno-21-66"></a>            <span class="p">]</span>
<a id="__codelineno-21-67" name="__codelineno-21-67" href="#__codelineno-21-67"></a>        <span class="p">}</span>
</code></pre></div>
<h2 id="operational-security-failures">Operational Security Failures</h2>
<h3 id="configuration-errors">Configuration Errors</h3>
<p><strong>Common misconfigurations</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CommonPKIMisconfigurations</span><span class="p">:</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="sd">    Dangerous but common PKI misconfigurations</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>    <span class="n">MISCONFIGURATIONS</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>        <span class="s1">&#39;weak_private_key_permissions&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>            <span class="s1">&#39;issue&#39;</span><span class="p">:</span> <span class="s1">&#39;Private key file readable by all users&#39;</span><span class="p">,</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>            <span class="s1">&#39;command&#39;</span><span class="p">:</span> <span class="s1">&#39;ls -l /etc/ssl/private/server.key&#39;</span><span class="p">,</span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>            <span class="s1">&#39;bad&#39;</span><span class="p">:</span> <span class="s1">&#39;-rw-r--r-- 1 root root 1675 server.key&#39;</span><span class="p">,</span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>            <span class="s1">&#39;good&#39;</span><span class="p">:</span> <span class="s1">&#39;-rw------- 1 root root 1675 server.key&#39;</span><span class="p">,</span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>            <span class="s1">&#39;risk&#39;</span><span class="p">:</span> <span class="s1">&#39;Any user can steal private key&#39;</span><span class="p">,</span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>            <span class="s1">&#39;fix&#39;</span><span class="p">:</span> <span class="s1">&#39;chmod 600 /etc/ssl/private/server.key&#39;</span>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>        <span class="p">},</span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a>        <span class="s1">&#39;private_key_in_public_location&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>            <span class="s1">&#39;issue&#39;</span><span class="p">:</span> <span class="s1">&#39;Private key in web-accessible directory&#39;</span><span class="p">,</span>
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a>            <span class="s1">&#39;bad&#39;</span><span class="p">:</span> <span class="s1">&#39;/var/www/html/certs/private.key&#39;</span><span class="p">,</span>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a>            <span class="s1">&#39;risk&#39;</span><span class="p">:</span> <span class="s1">&#39;Private key downloadable via HTTP&#39;</span><span class="p">,</span>
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a>            <span class="s1">&#39;fix&#39;</span><span class="p">:</span> <span class="s1">&#39;Move to /etc/ssl/private/, block web access&#39;</span>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a>        <span class="p">},</span>
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a>
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a>        <span class="s1">&#39;certificate_key_mismatch&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a>            <span class="s1">&#39;issue&#39;</span><span class="p">:</span> <span class="s1">&#39;Certificate does not match private key&#39;</span><span class="p">,</span>
<a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;TLS handshake fails with &quot;wrong signature&quot; error&#39;</span><span class="p">,</span>
<a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a>            <span class="s1">&#39;risk&#39;</span><span class="p">:</span> <span class="s1">&#39;Service outage&#39;</span><span class="p">,</span>
<a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a>            <span class="s1">&#39;fix&#39;</span><span class="p">:</span> <span class="s1">&#39;Verify cert/key match before deployment&#39;</span>
<a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a>        <span class="p">},</span>
<a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a>
<a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a>        <span class="s1">&#39;missing_intermediate_certificates&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a>            <span class="s1">&#39;issue&#39;</span><span class="p">:</span> <span class="s1">&#39;Server sends only leaf certificate&#39;</span><span class="p">,</span>
<a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Some clients fail to validate chain&#39;</span><span class="p">,</span>
<a id="__codelineno-22-33" name="__codelineno-22-33" href="#__codelineno-22-33"></a>            <span class="s1">&#39;risk&#39;</span><span class="p">:</span> <span class="s1">&#39;Intermittent connection failures&#39;</span><span class="p">,</span>
<a id="__codelineno-22-34" name="__codelineno-22-34" href="#__codelineno-22-34"></a>            <span class="s1">&#39;fix&#39;</span><span class="p">:</span> <span class="s1">&#39;Include all intermediate certificates in chain&#39;</span>
<a id="__codelineno-22-35" name="__codelineno-22-35" href="#__codelineno-22-35"></a>        <span class="p">},</span>
<a id="__codelineno-22-36" name="__codelineno-22-36" href="#__codelineno-22-36"></a>
<a id="__codelineno-22-37" name="__codelineno-22-37" href="#__codelineno-22-37"></a>        <span class="s1">&#39;expired_certificate&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-22-38" name="__codelineno-22-38" href="#__codelineno-22-38"></a>            <span class="s1">&#39;issue&#39;</span><span class="p">:</span> <span class="s1">&#39;Certificate past validity period&#39;</span><span class="p">,</span>
<a id="__codelineno-22-39" name="__codelineno-22-39" href="#__codelineno-22-39"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;All clients reject connection&#39;</span><span class="p">,</span>
<a id="__codelineno-22-40" name="__codelineno-22-40" href="#__codelineno-22-40"></a>            <span class="s1">&#39;risk&#39;</span><span class="p">:</span> <span class="s1">&#39;Complete service outage&#39;</span><span class="p">,</span>
<a id="__codelineno-22-41" name="__codelineno-22-41" href="#__codelineno-22-41"></a>            <span class="s1">&#39;fix&#39;</span><span class="p">:</span> <span class="s1">&#39;Renew certificate before expiry&#39;</span>
<a id="__codelineno-22-42" name="__codelineno-22-42" href="#__codelineno-22-42"></a>        <span class="p">},</span>
<a id="__codelineno-22-43" name="__codelineno-22-43" href="#__codelineno-22-43"></a>
<a id="__codelineno-22-44" name="__codelineno-22-44" href="#__codelineno-22-44"></a>        <span class="s1">&#39;wrong_hostname&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-22-45" name="__codelineno-22-45" href="#__codelineno-22-45"></a>            <span class="s1">&#39;issue&#39;</span><span class="p">:</span> <span class="s1">&#39;Certificate does not include server hostname&#39;</span><span class="p">,</span>
<a id="__codelineno-22-46" name="__codelineno-22-46" href="#__codelineno-22-46"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Hostname validation errors&#39;</span><span class="p">,</span>
<a id="__codelineno-22-47" name="__codelineno-22-47" href="#__codelineno-22-47"></a>            <span class="s1">&#39;risk&#39;</span><span class="p">:</span> <span class="s1">&#39;Clients cannot connect&#39;</span><span class="p">,</span>
<a id="__codelineno-22-48" name="__codelineno-22-48" href="#__codelineno-22-48"></a>            <span class="s1">&#39;fix&#39;</span><span class="p">:</span> <span class="s1">&#39;Include all hostnames in certificate SANs&#39;</span>
<a id="__codelineno-22-49" name="__codelineno-22-49" href="#__codelineno-22-49"></a>        <span class="p">},</span>
<a id="__codelineno-22-50" name="__codelineno-22-50" href="#__codelineno-22-50"></a>
<a id="__codelineno-22-51" name="__codelineno-22-51" href="#__codelineno-22-51"></a>        <span class="s1">&#39;weak_cipher_suites&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-22-52" name="__codelineno-22-52" href="#__codelineno-22-52"></a>            <span class="s1">&#39;issue&#39;</span><span class="p">:</span> <span class="s1">&#39;Weak or export cipher suites enabled&#39;</span><span class="p">,</span>
<a id="__codelineno-22-53" name="__codelineno-22-53" href="#__codelineno-22-53"></a>            <span class="s1">&#39;bad&#39;</span><span class="p">:</span> <span class="s1">&#39;SSLCipherSuite ALL:!EXPORT:!DES:!MD5&#39;</span><span class="p">,</span>
<a id="__codelineno-22-54" name="__codelineno-22-54" href="#__codelineno-22-54"></a>            <span class="s1">&#39;risk&#39;</span><span class="p">:</span> <span class="s1">&#39;Vulnerable to downgrade attacks&#39;</span><span class="p">,</span>
<a id="__codelineno-22-55" name="__codelineno-22-55" href="#__codelineno-22-55"></a>            <span class="s1">&#39;fix&#39;</span><span class="p">:</span> <span class="s1">&#39;Use only modern, strong cipher suites&#39;</span>
<a id="__codelineno-22-56" name="__codelineno-22-56" href="#__codelineno-22-56"></a>        <span class="p">},</span>
<a id="__codelineno-22-57" name="__codelineno-22-57" href="#__codelineno-22-57"></a>
<a id="__codelineno-22-58" name="__codelineno-22-58" href="#__codelineno-22-58"></a>        <span class="s1">&#39;ssl_version_2_or_3_enabled&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-22-59" name="__codelineno-22-59" href="#__codelineno-22-59"></a>            <span class="s1">&#39;issue&#39;</span><span class="p">:</span> <span class="s1">&#39;SSLv2 or SSLv3 still enabled&#39;</span><span class="p">,</span>
<a id="__codelineno-22-60" name="__codelineno-22-60" href="#__codelineno-22-60"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;SSLyze, testssl.sh&#39;</span><span class="p">,</span>
<a id="__codelineno-22-61" name="__codelineno-22-61" href="#__codelineno-22-61"></a>            <span class="s1">&#39;risk&#39;</span><span class="p">:</span> <span class="s1">&#39;Vulnerable to DROWN, POODLE&#39;</span><span class="p">,</span>
<a id="__codelineno-22-62" name="__codelineno-22-62" href="#__codelineno-22-62"></a>            <span class="s1">&#39;fix&#39;</span><span class="p">:</span> <span class="s1">&#39;Disable all SSL versions, use TLS 1.2+&#39;</span>
<a id="__codelineno-22-63" name="__codelineno-22-63" href="#__codelineno-22-63"></a>        <span class="p">}</span>
<a id="__codelineno-22-64" name="__codelineno-22-64" href="#__codelineno-22-64"></a>    <span class="p">}</span>
</code></pre></div>
<h3 id="supply-chain-attacks">Supply Chain Attacks</h3>
<p><strong>Compromised cryptographic libraries</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">SupplyChainThreats</span><span class="p">:</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="sd">    Supply chain attack vectors in PKI</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">compromised_crypto_library</span><span class="p">():</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="sd">        Backdoored cryptographic implementation</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;Compromised Crypto Library&#39;</span><span class="p">,</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>                <span class="s1">&#39;Attacker compromises crypto library source/binary&#39;</span><span class="p">,</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>                <span class="s1">&#39;Backdoor weakens key generation&#39;</span><span class="p">,</span>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a>                <span class="s1">&#39;Or leaks key material&#39;</span><span class="p">,</span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>                <span class="s1">&#39;Or bypasses validation&#39;</span>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>            <span class="p">],</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>            <span class="s1">&#39;real_world&#39;</span><span class="p">:</span> <span class="s1">&#39;Juniper ScreenOS backdoor (2015)&#39;</span><span class="p">,</span>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Widespread compromise of systems using library&#39;</span><span class="p">,</span>
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a>                <span class="s1">&#39;Code review of critical libraries&#39;</span><span class="p">,</span>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a>                <span class="s1">&#39;Binary integrity verification&#39;</span><span class="p">,</span>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>                <span class="s1">&#39;Behavioral monitoring&#39;</span><span class="p">,</span>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a>                <span class="s1">&#39;Key quality testing&#39;</span>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>            <span class="p">],</span>
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a>                <span class="s1">&#39;Use well-audited libraries&#39;</span><span class="p">,</span>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a>                <span class="s1">&#39;Verify signatures on dependencies&#39;</span><span class="p">,</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a>                <span class="s1">&#39;Pin specific versions&#39;</span><span class="p">,</span>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a>                <span class="s1">&#39;Test key randomness&#39;</span><span class="p">,</span>
<a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a>                <span class="s1">&#39;Defense in depth&#39;</span>
<a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a>            <span class="p">]</span>
<a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a>        <span class="p">}</span>
<a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a>
<a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">malicious_hsm_firmware</span><span class="p">():</span>
<a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a><span class="sd">        Compromised HSM firmware</span>
<a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-23-42" name="__codelineno-23-42" href="#__codelineno-23-42"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;HSM Firmware Backdoor&#39;</span><span class="p">,</span>
<a id="__codelineno-23-43" name="__codelineno-23-43" href="#__codelineno-23-43"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-23-44" name="__codelineno-23-44" href="#__codelineno-23-44"></a>                <span class="s1">&#39;Attacker compromises HSM vendor&#39;</span><span class="p">,</span>
<a id="__codelineno-23-45" name="__codelineno-23-45" href="#__codelineno-23-45"></a>                <span class="s1">&#39;Malicious firmware update distributed&#39;</span><span class="p">,</span>
<a id="__codelineno-23-46" name="__codelineno-23-46" href="#__codelineno-23-46"></a>                <span class="s1">&#39;Firmware extracts key material&#39;</span><span class="p">,</span>
<a id="__codelineno-23-47" name="__codelineno-23-47" href="#__codelineno-23-47"></a>                <span class="s1">&#39;Or weakens key generation&#39;</span>
<a id="__codelineno-23-48" name="__codelineno-23-48" href="#__codelineno-23-48"></a>            <span class="p">],</span>
<a id="__codelineno-23-49" name="__codelineno-23-49" href="#__codelineno-23-49"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Complete compromise of key protection&#39;</span><span class="p">,</span>
<a id="__codelineno-23-50" name="__codelineno-23-50" href="#__codelineno-23-50"></a>            <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="s1">&#39;Very difficult - requires firmware analysis&#39;</span><span class="p">,</span>
<a id="__codelineno-23-51" name="__codelineno-23-51" href="#__codelineno-23-51"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-23-52" name="__codelineno-23-52" href="#__codelineno-23-52"></a>                <span class="s1">&#39;HSM from trusted vendors with FIPS validation&#39;</span><span class="p">,</span>
<a id="__codelineno-23-53" name="__codelineno-23-53" href="#__codelineno-23-53"></a>                <span class="s1">&#39;Firmware signature verification&#39;</span><span class="p">,</span>
<a id="__codelineno-23-54" name="__codelineno-23-54" href="#__codelineno-23-54"></a>                <span class="s1">&#39;Multiple vendors in critical infrastructure&#39;</span><span class="p">,</span>
<a id="__codelineno-23-55" name="__codelineno-23-55" href="#__codelineno-23-55"></a>                <span class="s1">&#39;Air-gapped key generation&#39;</span>
<a id="__codelineno-23-56" name="__codelineno-23-56" href="#__codelineno-23-56"></a>            <span class="p">]</span>
<a id="__codelineno-23-57" name="__codelineno-23-57" href="#__codelineno-23-57"></a>        <span class="p">}</span>
<a id="__codelineno-23-58" name="__codelineno-23-58" href="#__codelineno-23-58"></a>
<a id="__codelineno-23-59" name="__codelineno-23-59" href="#__codelineno-23-59"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-23-60" name="__codelineno-23-60" href="#__codelineno-23-60"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">compromised_ca_software</span><span class="p">():</span>
<a id="__codelineno-23-61" name="__codelineno-23-61" href="#__codelineno-23-61"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-62" name="__codelineno-23-62" href="#__codelineno-23-62"></a><span class="sd">        Backdoor in CA management software</span>
<a id="__codelineno-23-63" name="__codelineno-23-63" href="#__codelineno-23-63"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-23-64" name="__codelineno-23-64" href="#__codelineno-23-64"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-23-65" name="__codelineno-23-65" href="#__codelineno-23-65"></a>            <span class="s1">&#39;attack&#39;</span><span class="p">:</span> <span class="s1">&#39;CA Software Compromise&#39;</span><span class="p">,</span>
<a id="__codelineno-23-66" name="__codelineno-23-66" href="#__codelineno-23-66"></a>            <span class="s1">&#39;scenario&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-23-67" name="__codelineno-23-67" href="#__codelineno-23-67"></a>                <span class="s1">&#39;CA management software compromised&#39;</span><span class="p">,</span>
<a id="__codelineno-23-68" name="__codelineno-23-68" href="#__codelineno-23-68"></a>                <span class="s1">&#39;Backdoor enables unauthorized issuance&#39;</span><span class="p">,</span>
<a id="__codelineno-23-69" name="__codelineno-23-69" href="#__codelineno-23-69"></a>                <span class="s1">&#39;Or logs key material&#39;</span><span class="p">,</span>
<a id="__codelineno-23-70" name="__codelineno-23-70" href="#__codelineno-23-70"></a>                <span class="s1">&#39;Or bypasses approval workflows&#39;</span>
<a id="__codelineno-23-71" name="__codelineno-23-71" href="#__codelineno-23-71"></a>            <span class="p">],</span>
<a id="__codelineno-23-72" name="__codelineno-23-72" href="#__codelineno-23-72"></a>            <span class="s1">&#39;impact&#39;</span><span class="p">:</span> <span class="s1">&#39;Unauthorized certificate issuance&#39;</span><span class="p">,</span>
<a id="__codelineno-23-73" name="__codelineno-23-73" href="#__codelineno-23-73"></a>            <span class="s1">&#39;mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-23-74" name="__codelineno-23-74" href="#__codelineno-23-74"></a>                <span class="s1">&#39;Vendor security assessment&#39;</span><span class="p">,</span>
<a id="__codelineno-23-75" name="__codelineno-23-75" href="#__codelineno-23-75"></a>                <span class="s1">&#39;Code audits for critical software&#39;</span><span class="p">,</span>
<a id="__codelineno-23-76" name="__codelineno-23-76" href="#__codelineno-23-76"></a>                <span class="s1">&#39;Anomaly detection on issuance&#39;</span><span class="p">,</span>
<a id="__codelineno-23-77" name="__codelineno-23-77" href="#__codelineno-23-77"></a>                <span class="s1">&#39;Multi-party approval processes&#39;</span>
<a id="__codelineno-23-78" name="__codelineno-23-78" href="#__codelineno-23-78"></a>            <span class="p">]</span>
<a id="__codelineno-23-79" name="__codelineno-23-79" href="#__codelineno-23-79"></a>        <span class="p">}</span>
</code></pre></div>
<h2 id="defense-in-depth">Defense in Depth</h2>
<h3 id="layered-security-controls">Layered Security Controls</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">PKISecurityLayers</span><span class="p">:</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="sd">    Defense in depth for PKI infrastructure</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>            <span class="s1">&#39;physical&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>                <span class="s1">&#39;controls&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>                    <span class="s1">&#39;Secure data center for CA infrastructure&#39;</span><span class="p">,</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>                    <span class="s1">&#39;HSM in tamper-resistant enclosure&#39;</span><span class="p">,</span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>                    <span class="s1">&#39;Access control to server rooms&#39;</span><span class="p">,</span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>                    <span class="s1">&#39;Environmental monitoring&#39;</span><span class="p">,</span>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>                    <span class="s1">&#39;Offline root CA in vault&#39;</span>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>                <span class="p">],</span>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>                <span class="s1">&#39;threat_mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>                    <span class="s1">&#39;Physical theft&#39;</span><span class="p">,</span>
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>                    <span class="s1">&#39;Unauthorized access&#39;</span><span class="p">,</span>
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>                    <span class="s1">&#39;Environmental attacks&#39;</span>
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>                <span class="p">]</span>
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>            <span class="p">},</span>
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a>
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>            <span class="s1">&#39;network&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>                <span class="s1">&#39;controls&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>                    <span class="s1">&#39;Network segmentation (CA in isolated VLAN)&#39;</span><span class="p">,</span>
<a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a>                    <span class="s1">&#39;Firewall rules restricting CA access&#39;</span><span class="p">,</span>
<a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a>                    <span class="s1">&#39;IDS/IPS monitoring&#39;</span><span class="p">,</span>
<a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a>                    <span class="s1">&#39;TLS for all communications&#39;</span><span class="p">,</span>
<a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a>                    <span class="s1">&#39;VPN for remote access&#39;</span>
<a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a>                <span class="p">],</span>
<a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a>                <span class="s1">&#39;threat_mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a>                    <span class="s1">&#39;Network-based attacks&#39;</span><span class="p">,</span>
<a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a>                    <span class="s1">&#39;MITM attacks&#39;</span><span class="p">,</span>
<a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a>                    <span class="s1">&#39;Unauthorized access&#39;</span><span class="p">,</span>
<a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a>                    <span class="s1">&#39;Lateral movement&#39;</span>
<a id="__codelineno-24-36" name="__codelineno-24-36" href="#__codelineno-24-36"></a>                <span class="p">]</span>
<a id="__codelineno-24-37" name="__codelineno-24-37" href="#__codelineno-24-37"></a>            <span class="p">},</span>
<a id="__codelineno-24-38" name="__codelineno-24-38" href="#__codelineno-24-38"></a>
<a id="__codelineno-24-39" name="__codelineno-24-39" href="#__codelineno-24-39"></a>            <span class="s1">&#39;system&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-24-40" name="__codelineno-24-40" href="#__codelineno-24-40"></a>                <span class="s1">&#39;controls&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-41" name="__codelineno-24-41" href="#__codelineno-24-41"></a>                    <span class="s1">&#39;Hardened OS configuration&#39;</span><span class="p">,</span>
<a id="__codelineno-24-42" name="__codelineno-24-42" href="#__codelineno-24-42"></a>                    <span class="s1">&#39;Minimal installed software&#39;</span><span class="p">,</span>
<a id="__codelineno-24-43" name="__codelineno-24-43" href="#__codelineno-24-43"></a>                    <span class="s1">&#39;Regular patching&#39;</span><span class="p">,</span>
<a id="__codelineno-24-44" name="__codelineno-24-44" href="#__codelineno-24-44"></a>                    <span class="s1">&#39;Host-based firewall&#39;</span><span class="p">,</span>
<a id="__codelineno-24-45" name="__codelineno-24-45" href="#__codelineno-24-45"></a>                    <span class="s1">&#39;Antivirus/EDR&#39;</span><span class="p">,</span>
<a id="__codelineno-24-46" name="__codelineno-24-46" href="#__codelineno-24-46"></a>                    <span class="s1">&#39;File integrity monitoring&#39;</span>
<a id="__codelineno-24-47" name="__codelineno-24-47" href="#__codelineno-24-47"></a>                <span class="p">],</span>
<a id="__codelineno-24-48" name="__codelineno-24-48" href="#__codelineno-24-48"></a>                <span class="s1">&#39;threat_mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-49" name="__codelineno-24-49" href="#__codelineno-24-49"></a>                    <span class="s1">&#39;OS vulnerabilities&#39;</span><span class="p">,</span>
<a id="__codelineno-24-50" name="__codelineno-24-50" href="#__codelineno-24-50"></a>                    <span class="s1">&#39;Malware&#39;</span><span class="p">,</span>
<a id="__codelineno-24-51" name="__codelineno-24-51" href="#__codelineno-24-51"></a>                    <span class="s1">&#39;Unauthorized changes&#39;</span>
<a id="__codelineno-24-52" name="__codelineno-24-52" href="#__codelineno-24-52"></a>                <span class="p">]</span>
<a id="__codelineno-24-53" name="__codelineno-24-53" href="#__codelineno-24-53"></a>            <span class="p">},</span>
<a id="__codelineno-24-54" name="__codelineno-24-54" href="#__codelineno-24-54"></a>
<a id="__codelineno-24-55" name="__codelineno-24-55" href="#__codelineno-24-55"></a>            <span class="s1">&#39;application&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-24-56" name="__codelineno-24-56" href="#__codelineno-24-56"></a>                <span class="s1">&#39;controls&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-57" name="__codelineno-24-57" href="#__codelineno-24-57"></a>                    <span class="s1">&#39;Secure CA software configuration&#39;</span><span class="p">,</span>
<a id="__codelineno-24-58" name="__codelineno-24-58" href="#__codelineno-24-58"></a>                    <span class="s1">&#39;Input validation&#39;</span><span class="p">,</span>
<a id="__codelineno-24-59" name="__codelineno-24-59" href="#__codelineno-24-59"></a>                    <span class="s1">&#39;Output encoding&#39;</span><span class="p">,</span>
<a id="__codelineno-24-60" name="__codelineno-24-60" href="#__codelineno-24-60"></a>                    <span class="s1">&#39;Error handling&#39;</span><span class="p">,</span>
<a id="__codelineno-24-61" name="__codelineno-24-61" href="#__codelineno-24-61"></a>                    <span class="s1">&#39;Secure session management&#39;</span><span class="p">,</span>
<a id="__codelineno-24-62" name="__codelineno-24-62" href="#__codelineno-24-62"></a>                    <span class="s1">&#39;API authentication&#39;</span>
<a id="__codelineno-24-63" name="__codelineno-24-63" href="#__codelineno-24-63"></a>                <span class="p">],</span>
<a id="__codelineno-24-64" name="__codelineno-24-64" href="#__codelineno-24-64"></a>                <span class="s1">&#39;threat_mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-65" name="__codelineno-24-65" href="#__codelineno-24-65"></a>                    <span class="s1">&#39;Application vulnerabilities&#39;</span><span class="p">,</span>
<a id="__codelineno-24-66" name="__codelineno-24-66" href="#__codelineno-24-66"></a>                    <span class="s1">&#39;Injection attacks&#39;</span><span class="p">,</span>
<a id="__codelineno-24-67" name="__codelineno-24-67" href="#__codelineno-24-67"></a>                    <span class="s1">&#39;Authentication bypass&#39;</span>
<a id="__codelineno-24-68" name="__codelineno-24-68" href="#__codelineno-24-68"></a>                <span class="p">]</span>
<a id="__codelineno-24-69" name="__codelineno-24-69" href="#__codelineno-24-69"></a>            <span class="p">},</span>
<a id="__codelineno-24-70" name="__codelineno-24-70" href="#__codelineno-24-70"></a>
<a id="__codelineno-24-71" name="__codelineno-24-71" href="#__codelineno-24-71"></a>            <span class="s1">&#39;cryptographic&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-24-72" name="__codelineno-24-72" href="#__codelineno-24-72"></a>                <span class="s1">&#39;controls&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-73" name="__codelineno-24-73" href="#__codelineno-24-73"></a>                    <span class="s1">&#39;Keys stored in FIPS 140-2 Level 3+ HSM&#39;</span><span class="p">,</span>
<a id="__codelineno-24-74" name="__codelineno-24-74" href="#__codelineno-24-74"></a>                    <span class="s1">&#39;Strong key generation&#39;</span><span class="p">,</span>
<a id="__codelineno-24-75" name="__codelineno-24-75" href="#__codelineno-24-75"></a>                    <span class="s1">&#39;Approved algorithms only&#39;</span><span class="p">,</span>
<a id="__codelineno-24-76" name="__codelineno-24-76" href="#__codelineno-24-76"></a>                    <span class="s1">&#39;Regular key rotation&#39;</span><span class="p">,</span>
<a id="__codelineno-24-77" name="__codelineno-24-77" href="#__codelineno-24-77"></a>                    <span class="s1">&#39;Encrypted key backups&#39;</span>
<a id="__codelineno-24-78" name="__codelineno-24-78" href="#__codelineno-24-78"></a>                <span class="p">],</span>
<a id="__codelineno-24-79" name="__codelineno-24-79" href="#__codelineno-24-79"></a>                <span class="s1">&#39;threat_mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-80" name="__codelineno-24-80" href="#__codelineno-24-80"></a>                    <span class="s1">&#39;Key theft&#39;</span><span class="p">,</span>
<a id="__codelineno-24-81" name="__codelineno-24-81" href="#__codelineno-24-81"></a>                    <span class="s1">&#39;Weak cryptography&#39;</span><span class="p">,</span>
<a id="__codelineno-24-82" name="__codelineno-24-82" href="#__codelineno-24-82"></a>                    <span class="s1">&#39;Algorithm breaks&#39;</span>
<a id="__codelineno-24-83" name="__codelineno-24-83" href="#__codelineno-24-83"></a>                <span class="p">]</span>
<a id="__codelineno-24-84" name="__codelineno-24-84" href="#__codelineno-24-84"></a>            <span class="p">},</span>
<a id="__codelineno-24-85" name="__codelineno-24-85" href="#__codelineno-24-85"></a>
<a id="__codelineno-24-86" name="__codelineno-24-86" href="#__codelineno-24-86"></a>            <span class="s1">&#39;operational&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-24-87" name="__codelineno-24-87" href="#__codelineno-24-87"></a>                <span class="s1">&#39;controls&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-88" name="__codelineno-24-88" href="#__codelineno-24-88"></a>                    <span class="s1">&#39;Separation of duties&#39;</span><span class="p">,</span>
<a id="__codelineno-24-89" name="__codelineno-24-89" href="#__codelineno-24-89"></a>                    <span class="s1">&#39;Multi-party approval for sensitive operations&#39;</span><span class="p">,</span>
<a id="__codelineno-24-90" name="__codelineno-24-90" href="#__codelineno-24-90"></a>                    <span class="s1">&#39;Comprehensive audit logging&#39;</span><span class="p">,</span>
<a id="__codelineno-24-91" name="__codelineno-24-91" href="#__codelineno-24-91"></a>                    <span class="s1">&#39;Regular security assessments&#39;</span><span class="p">,</span>
<a id="__codelineno-24-92" name="__codelineno-24-92" href="#__codelineno-24-92"></a>                    <span class="s1">&#39;Incident response procedures&#39;</span><span class="p">,</span>
<a id="__codelineno-24-93" name="__codelineno-24-93" href="#__codelineno-24-93"></a>                    <span class="s1">&#39;Background checks for operators&#39;</span>
<a id="__codelineno-24-94" name="__codelineno-24-94" href="#__codelineno-24-94"></a>                <span class="p">],</span>
<a id="__codelineno-24-95" name="__codelineno-24-95" href="#__codelineno-24-95"></a>                <span class="s1">&#39;threat_mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-96" name="__codelineno-24-96" href="#__codelineno-24-96"></a>                    <span class="s1">&#39;Insider threats&#39;</span><span class="p">,</span>
<a id="__codelineno-24-97" name="__codelineno-24-97" href="#__codelineno-24-97"></a>                    <span class="s1">&#39;Operational errors&#39;</span><span class="p">,</span>
<a id="__codelineno-24-98" name="__codelineno-24-98" href="#__codelineno-24-98"></a>                    <span class="s1">&#39;Unauthorized activities&#39;</span>
<a id="__codelineno-24-99" name="__codelineno-24-99" href="#__codelineno-24-99"></a>                <span class="p">]</span>
<a id="__codelineno-24-100" name="__codelineno-24-100" href="#__codelineno-24-100"></a>            <span class="p">},</span>
<a id="__codelineno-24-101" name="__codelineno-24-101" href="#__codelineno-24-101"></a>
<a id="__codelineno-24-102" name="__codelineno-24-102" href="#__codelineno-24-102"></a>            <span class="s1">&#39;monitoring&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-24-103" name="__codelineno-24-103" href="#__codelineno-24-103"></a>                <span class="s1">&#39;controls&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-104" name="__codelineno-24-104" href="#__codelineno-24-104"></a>                    <span class="s1">&#39;Certificate Transparency monitoring&#39;</span><span class="p">,</span>
<a id="__codelineno-24-105" name="__codelineno-24-105" href="#__codelineno-24-105"></a>                    <span class="s1">&#39;CA audit log monitoring&#39;</span><span class="p">,</span>
<a id="__codelineno-24-106" name="__codelineno-24-106" href="#__codelineno-24-106"></a>                    <span class="s1">&#39;Anomaly detection&#39;</span><span class="p">,</span>
<a id="__codelineno-24-107" name="__codelineno-24-107" href="#__codelineno-24-107"></a>                    <span class="s1">&#39;Security information and event management (SIEM)&#39;</span><span class="p">,</span>
<a id="__codelineno-24-108" name="__codelineno-24-108" href="#__codelineno-24-108"></a>                    <span class="s1">&#39;Regular security audits&#39;</span>
<a id="__codelineno-24-109" name="__codelineno-24-109" href="#__codelineno-24-109"></a>                <span class="p">],</span>
<a id="__codelineno-24-110" name="__codelineno-24-110" href="#__codelineno-24-110"></a>                <span class="s1">&#39;threat_mitigation&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-24-111" name="__codelineno-24-111" href="#__codelineno-24-111"></a>                    <span class="s1">&#39;Undetected compromises&#39;</span><span class="p">,</span>
<a id="__codelineno-24-112" name="__codelineno-24-112" href="#__codelineno-24-112"></a>                    <span class="s1">&#39;Fraudulent issuance&#39;</span><span class="p">,</span>
<a id="__codelineno-24-113" name="__codelineno-24-113" href="#__codelineno-24-113"></a>                    <span class="s1">&#39;Anomalous behavior&#39;</span>
<a id="__codelineno-24-114" name="__codelineno-24-114" href="#__codelineno-24-114"></a>                <span class="p">]</span>
<a id="__codelineno-24-115" name="__codelineno-24-115" href="#__codelineno-24-115"></a>            <span class="p">}</span>
<a id="__codelineno-24-116" name="__codelineno-24-116" href="#__codelineno-24-116"></a>        <span class="p">}</span>
</code></pre></div>
<h2 id="conclusion">Conclusion</h2>
<p>PKI security requires a comprehensive threat model that spans cryptographic attacks, infrastructure compromise, protocol vulnerabilities, and operational failures. No single control provides complete security; instead, defense in depth creates overlapping layers that make attacks impractical or at least detectable.</p>
<p>The most critical principles:</p>
<ol>
<li><strong>Assume breach</strong>: Design systems to limit impact when (not if) compromise occurs</li>
<li><strong>Defense in depth</strong>: Multiple independent security layers</li>
<li><strong>Monitoring and detection</strong>: You can't respond to what you don't detect</li>
<li><strong>Cryptographic agility</strong>: Ability to migrate away from broken algorithms</li>
<li><strong>Operational security</strong>: Technical controls are worthless with weak processes</li>
</ol>
<p>Understanding these threat models enables building PKI infrastructure that is resilient against real-world attacks, responds effectively when compromised, and evolves as the threat landscape changes.</p>
<h2 id="references">References</h2>
<h3 id="historical-attacks-and-incidents">Historical Attacks and Incidents</h3>
<p><strong>DigiNotar Certificate Authority Breach (2011)</strong>
- Fox-IT. "DigiNotar Certificate Authority breach - Operation Black Tulip." September 2011.
  - <a href="https://www.rijksoverheid.nl/documenten/rapporten/2011/09/05/diginotar-public-report-version-1">Rijksoverheid - Rapporten</a>
- Nation-state compromise of Dutch CA
- 531 fraudulent certificates issued
- Company bankruptcy and trust store removal</p>
<p><strong>Comodo Registration Authority Compromise (2011)</strong>
- Comodo. "Comodo Fraud Incident Report." March 2011.
- RA credentials compromised
- Nine high-value fraudulent certificates
- Demonstrated RA security importance</p>
<p><strong>Heartbleed (CVE-2014-0160)</strong>
- Durumeric, Z., et al. "The Matter of Heartbleed." ACM IMC 2014.
  - <a href="https://dl.acm.org/doi/10.1145/2663716.2663755">Acm - 10.1145</a>
- OpenSSL buffer over-read vulnerability
- Private key exposure possible
- Internet-scale impact analysis</p>
<p><strong>ROCA Vulnerability (CVE-2017-15361)</strong>
- Nemec, M., et al. "The Return of Coppersmith's Attack: Practical Factorization of Widely Used RSA Moduli." ACM CCS 2017.
  - <a href="https://dl.acm.org/doi/10.1145/3133956.3133969">Acm - 10.1145</a>
- Weakness in Infineon TPM key generation
- Millions of devices affected
- Practical RSA key factorization</p>
<h3 id="cryptographic-attack-research">Cryptographic Attack Research</h3>
<p><strong>Collision Attacks on Hash Functions</strong>
- Wang, X., et al. "Finding Collisions in the Full SHA-1." CRYPTO 2005.
- Stevens, M., et al. "The First Collision for Full SHA-1." CRYPTO 2017.
  - <a href="https://shattered.io/">Shattered</a>
- Practical SHA-1 collision demonstration
- Impact on certificate signatures</p>
<p><strong>Bleichenbacher Attack on RSA PKCS#1 v1.5</strong>
- Bleichenbacher, D. "Chosen Ciphertext Attacks Against Protocols Based on the RSA Encryption Standard PKCS #1." CRYPTO 1998.
- Bck, H., et al. "Return Of Bleichenbacher's Oracle Threat (ROBOT)." USENIX Security 2018.
- Padding oracle attacks on RSA
- 27 years after original, still finding vulnerable implementations</p>
<p><strong>Side-Channel Attacks</strong>
- Kocher, P., Jaffe, J., Jun, B. "Differential Power Analysis." CRYPTO 1999.
  - Foundational side-channel attack paper
- Genkin, D., et al. "Get Your Hands Off My Laptop: Physical Side-Channel Key-Extraction Attacks on PCs." CHES 2014.
  - Acoustic cryptanalysis
- Yarom, Y., Falkner, K. "FLUSH+RELOAD: A High Resolution, Low Noise, L3 Cache Side-Channel Attack." USENIX Security 2014.
  - Cache timing attacks</p>
<p><strong>Quantum Computing Threats</strong>
- Shor, P.W. "Polynomial-Time Algorithms for Prime Factorization and Discrete Logarithms on a Quantum Computer." SIAM Journal on Computing, 1997.
  - <a href="https://dl.acm.org/doi/10.1137/S0097539795293172">Acm - 10.1137</a>
- Theoretical foundation for quantum threat to RSA/ECC
- NIST Post-Quantum Cryptography Standardization Project
  - <a href="https://csrc.nist.gov/projects/post-quantum-cryptography">Nist - Post Quantum Cryptography</a></p>
<h3 id="protocol-vulnerabilities">Protocol Vulnerabilities</h3>
<p><strong>SSL/TLS Attack Research</strong>
- Sheffer, Y., Holz, R., Saint-Andre, P. "Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)." RFC 7457, February 2015.
  - <a href="https://tools.ietf.org/html/rfc7457">Ietf - Rfc7457</a>
- Comprehensive survey of TLS attacks
- BEAST, CRIME, BREACH, Heartbleed, POODLE, etc.</p>
<p><strong>Certificate Validation Failures</strong>
- Brubaker, C., et al. "Using Frankencerts for Automated Adversarial Testing of Certificate Validation in SSL/TLS Implementations." IEEE S&amp;P 2014.
  - <a href="https://www.ieee-security.org/TC/SP2014/papers/UsingFrancencertsforAutomatedAdversarialTestingofCertificateValidationinSSL_TLSImplementations.pdf">Ieee-security - Papers</a>
- Systematic testing of implementations
- Widespread validation failures discovered</p>
<p><strong>BEAST Attack (CVE-2011-3389)</strong>
- Duong, T., Rizzo, J. "Here Come The  Ninjas." 2011.
- CBC mode vulnerability in TLS 1.0
- Practical plaintext recovery</p>
<p><strong>CRIME and BREACH Attacks</strong>
- Rizzo, J., Duong, T. "The CRIME Attack." 2012.
- Prado, A., Harris, N., Gluck, Y. "The BREACH Attack." 2013.
- Compression-based attacks on TLS
- HTTPS secrets extraction</p>
<h3 id="certificate-transparency">Certificate Transparency</h3>
<p><strong>Certificate Transparency Specification</strong>
- Laurie, B., Langley, A., Kasper, E. "Certificate Transparency." RFC 6962, June 2013.
  - <a href="https://tools.ietf.org/html/rfc6962">Ietf - Rfc6962</a>
- Public auditability of certificate issuance
- Detection of fraudulent certificates</p>
<p><strong>CT Log Monitoring Research</strong>
- Chung, T., et al. "Measuring and Applying Invalid SSL Certificates: The Silent Majority." ACM IMC 2016.
- Analysis of CT log data at scale
- Invalid certificate patterns</p>
<h3 id="network-level-attacks">Network-Level Attacks</h3>
<p><strong>BGP Hijacking and PKI</strong>
- Gavrichenkov, A. "Breaking HTTPS with BGP Hijacking." Black Hat USA 2015.
- Birge-Lee, H., et al. "Bamboozling Certificate Authorities with BGP." USENIX Security 2018.
  - <a href="https://www.usenix.org/conference/usenixsecurity18/presentation/birge-lee">Usenix - Usenixsecurity18</a>
- BGP attacks enable domain validation bypass
- Man-in-the-middle certificate issuance</p>
<p><strong>DNS Attacks on Certificate Validation</strong>
- Kaminsky, D. "It's The End Of The Cache As We Know It." Black Hat USA 2008.
- DNS cache poisoning for domain validation bypass
- DNSSEC as mitigation</p>
<h3 id="implementation-vulnerabilities">Implementation Vulnerabilities</h3>
<p><strong>Memory Safety Issues</strong>
- The Underhanded C Contest. <a href="http://www.underhanded-c.org/">Underhanded-c</a>
- Subtle vulnerabilities in C cryptographic code
- Buffer overflows, use-after-free, etc.</p>
<p><strong>Timing Attacks on Cryptographic Implementations</strong>
- Brumley, D., Boneh, D. "Remote Timing Attacks are Practical." USENIX Security 2003.
- Practical remote timing attacks on OpenSSL RSA</p>
<p><strong>OpenSSL Vulnerabilities Beyond Heartbleed</strong>
- CVE Database. "OpenSSL Vulnerabilities."
  - <a href="https://www.cvedetails.com/product/383/Openssl-Openssl.html">Cvedetails - Openssl Openssl.Html</a>
- Comprehensive list of OpenSSL CVEs
- Importance of staying current with patches</p>
<h3 id="threat-modeling-frameworks">Threat Modeling Frameworks</h3>
<p><strong>STRIDE Threat Model</strong>
- Shostack, A. "Threat Modeling: Designing for Security." Wiley, 2014.
- Systematic threat identification
- Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege</p>
<p><strong>MITRE ATT&amp;CK Framework</strong>
- MITRE Corporation. "ATT&amp;CK for Enterprise."
  - <a href="https://attack.mitre.org/">Mitre</a>
- Adversary tactics and techniques
- T1649: Steal or Forge Authentication Certificates
- T1552: Unsecured Credentials</p>
<p><strong>Common Weakness Enumeration (CWE)</strong>
- MITRE. "CWE VIEW: Weaknesses in Software Written in C."
  - <a href="https://cwe.mitre.org/">Mitre</a>
- CWE-310: Cryptographic Issues
- CWE-320: Key Management Errors
- CWE-327: Use of Broken or Risky Cryptographic Algorithm</p>
<h3 id="operational-security">Operational Security</h3>
<p><strong>Insider Threat Research</strong>
- Verizon. "2023 Data Breach Investigations Report." Annual.
  - <a href="https://www.verizon.com/business/resources/reports/dbir/">Verizon - Resources</a>
- 20-30% of breaches involve internal actors
- Privilege misuse patterns</p>
<p><strong>Social Engineering</strong>
- Hadnagy, C. "Social Engineering: The Art of Human Hacking." Wiley, 2010.
- Human vulnerabilities in security systems
- Phishing, pretexting, and manipulation</p>
<p><strong>Supply Chain Security</strong>
- NIST SP 800-161. "Cybersecurity Supply Chain Risk Management Practices for Systems and Organizations." May 2022.
  - <a href="https://csrc.nist.gov/publications/detail/sp/800-161/rev-1/final">Nist - Detail</a>
- Supply chain threat models
- Third-party risk management</p>
<h3 id="defense-strategies">Defense Strategies</h3>
<p><strong>Certificate Pinning</strong>
- Evans, C., Palmer, C., Sleevi, R. "Public Key Pinning Extension for HTTP." RFC 7469, April 2015.
  - <a href="https://tools.ietf.org/html/rfc7469">Ietf - Rfc7469</a>
- Trust-on-first-use pinning
- Protection against rogue CAs</p>
<p><strong>DNSSEC</strong>
- Arends, R., et al. "DNS Security Introduction and Requirements." RFC 4033, March 2005.
  - <a href="https://tools.ietf.org/html/rfc4033">Ietf - Rfc4033</a>
- DNS authentication and integrity
- Protection against DNS-based attacks</p>
<p><strong>CAA Records</strong>
- Hallam-Baker, P., Stradling, R. "DNS Certification Authority Authorization (CAA) Resource Record." RFC 8659, November 2019.
  - <a href="https://tools.ietf.org/html/rfc8659">Ietf - Rfc8659</a>
- DNS-based CA authorization
- Reduces fraudulent issuance risk</p>
<h3 id="standards-and-best-practices">Standards and Best Practices</h3>
<p><strong>CA/Browser Forum Baseline Requirements</strong>
- CA/Browser Forum. "Baseline Requirements for the Issuance and Management of Publicly-Trusted Certificates."
  - <a href="https://cabforum.org/baseline-requirements-documents/">Cabforum - Baseline Requirements Documents</a>
- Industry standards for public CAs
- Validation requirements and security controls</p>
<p><strong>OWASP Top 10</strong>
- OWASP. "OWASP Top 10:2021."
  - <a href="https://owasp.org/www-project-top-ten/">Owasp - Www Project Top Ten</a>
- A02:2021  Cryptographic Failures
- A07:2021  Identification and Authentication Failures</p>
<p><strong>NIST Cybersecurity Framework</strong>
- NIST. "Framework for Improving Critical Infrastructure Cybersecurity." Version 1.1, 2018.
  - <a href="https://www.nist.gov/cyberframework">Nist - Cyberframework</a>
- Identify, Protect, Detect, Respond, Recover
- Risk management framework</p>
<h3 id="academic-surveys-and-books">Academic Surveys and Books</h3>
<p><strong>Applied Cryptography</strong>
- Schneier, B. "Applied Cryptography: Protocols, Algorithms, and Source Code in C." 2nd Edition, Wiley, 1996.
- Foundational cryptography reference
- Practical implementation guidance</p>
<p><strong>Engineering Security</strong>
- Anderson, R. "Security Engineering: A Guide to Building Dependable Distributed Systems." 3rd Edition, Wiley, 2020.
- Comprehensive security engineering principles
- Real-world case studies</p>
<p><strong>PKI-Specific Research Surveys</strong>
- Housley, R., Polk, T. "Planning for PKI: Best Practices Guide for Deploying Public Key Infrastructure." Wiley, 2001.
- Comprehensive PKI deployment guide
- Threat models and mitigation strategies</p>









  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/axonsecurity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
  
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var sidebar = document.querySelector('.md-sidebar--secondary .md-sidebar__scrollwrap');
      if (sidebar) {
        var disclaimer = document.createElement('div');
        disclaimer.className = 'md-sidebar-disclaimer';
        disclaimer.innerHTML = `
          <div class="md-typeset">
            <div class="admonition tip">
              <p class="admonition-title">Our Books</p>
              <p><a href="https://axonshield.com/book"><strong>The Invisible Certificate Management Tax and How Automation Eliminates 94% of It</strong></a></p>
            </div>
            <div class="admonition warning">
              <p class="admonition-title">Disclaimer</p>
              <p><small>This documentation is based on "best practices". We've observed these ignore 
                unique organizational needs and often prove ineffective for long-term, sustainable 
                operations and ignore strategic advanteges of building infrastructure intelligence.</small></p>
            </div>
          </div>
        `;
        sidebar.insertBefore(disclaimer, sidebar.firstChild);
      }
    });
  </script>
  

  </body>
</html>